{"config":{"lang":["en","es"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"DBL - Database Layering","text":"<p>Git-like version control for databases</p>"},{"location":"#what-is-dbl","title":"What is DBL?","text":"<p>DBL (Database Layering) is a version control system for databases, similar to Git but designed specifically for database schema evolution.</p>"},{"location":"#key-capabilities","title":"Key Capabilities","text":"<ul> <li>\ud83c\udf3f Branch your schema - Work on multiple features in parallel</li> <li>\ud83d\udd12 Sandbox testing - Experiment safely without affecting your database</li> <li>\ud83d\udce6 Layer your changes - Version control for all SQL migrations</li> <li>\u2705 Validated migrations - Built-in checks for safe changes</li> <li>\ud83d\udd04 Reproducible rebuilds - Deterministic database reconstruction</li> </ul>"},{"location":"#quick-start","title":"Quick Start","text":"<pre><code># 1. Initialize project\ndbl init\n\n# 2. Create development sandbox\ndbl sandbox start\n\n# 3. Make your changes\n# Use your favorite database client to modify schema\n\n# 4. Save your changes\ndbl commit -m \"Add user_preferences table\"\n\n# 5. Apply to main database\ndbl sandbox apply\n</code></pre>"},{"location":"#core-features","title":"Core Features","text":""},{"location":"#safe-experimentation-with-sandboxes","title":"Safe Experimentation with Sandboxes","text":"<p>Work in an isolated sandbox - a temporary copy of your database where you can test changes without any risk to production or development databases.</p>"},{"location":"#complete-layer-history","title":"Complete Layer History","text":"<p>Every change is saved as a numbered layer (like Git commits), creating a complete, auditable history of your database evolution. View the history anytime with <code>dbl log</code>.</p>"},{"location":"#git-like-branching","title":"Git-like Branching","text":"<p>Create branches for different features:</p> <pre><code>dbl branch create feature/authentication\ndbl checkout feature/authentication\n# ... make your changes ...\ndbl checkout main\ndbl merge feature/authentication\n</code></pre>"},{"location":"#supported-databases","title":"Supported Databases","text":"<ul> <li>\u2705 PostgreSQL 11+</li> <li>\u2705 MySQL 5.7+</li> <li>\ud83d\udd04 SQLite (planned)</li> <li>\ud83d\udea7 MariaDB (planned)</li> </ul>"},{"location":"#installation","title":"Installation","text":""},{"location":"#prerequisites","title":"Prerequisites","text":""},{"location":"#installation_1","title":"Installation","text":"<p>Install DBL with pip:</p> <pre><code>pip install dbl\n</code></pre> <p>Or clone from GitHub for development:</p> <pre><code>git clone https://github.com/alann-estrada-KSH/dbl-sandbox.git\ncd dbl-sandbox\npip install -e .\n</code></pre>"},{"location":"#learn-more","title":"Learn More","text":""},{"location":"#getting-started","title":"Getting Started","text":"<p>New to DBL? Start here:</p> <ul> <li>Installation Guide - Detailed setup instructions</li> <li>Quick Start Tutorial - Your first changes in 5 minutes</li> <li>First Migration - Complete step-by-step example</li> </ul>"},{"location":"#reference","title":"Reference","text":"<p>Need help with a specific command?</p> <ul> <li>All Commands - Complete command reference</li> <li>Sandbox Management - Work with sandboxes</li> <li>Branching Guide - Branch management</li> </ul>"},{"location":"#deep-dives","title":"Deep Dives","text":"<p>Learn architecture and patterns:</p> <ul> <li>Architecture Overview - How DBL works</li> <li>Supported Databases - PostgreSQL, MySQL, more</li> <li>Best Practices - Tips for teams and projects</li> <li>Configuration - Advanced setup options</li> </ul>"},{"location":"#help-resources","title":"Help &amp; Resources","text":"<ul> <li>FAQ - 40+ common questions answered</li> <li>Troubleshooting - Fix common issues</li> <li>Changelog - Version history and changes</li> </ul>"},{"location":"#common-workflows","title":"Common Workflows","text":""},{"location":"#adding-a-new-feature","title":"Adding a New Feature","text":"<pre><code># Create feature branch\ndbl branch create feature/payments\n\n# Switch to feature branch\ndbl checkout feature/payments\n\n# Create sandbox\ndbl sandbox start\n\n# Make schema changes using your DB client\n# ... CREATE TABLE payments ...\n# ... CREATE INDEX idx_payments ...\n\n# Review changes\ndbl diff\n\n# Save changes\ndbl commit -m \"Add payments table with indexes\"\n\n# Apply to feature branch database\ndbl sandbox apply\n\n# Switch back to main\ndbl checkout main\n\n# Merge changes\ndbl merge feature/payments\n</code></pre>"},{"location":"#testing-migrations","title":"Testing Migrations","text":"<pre><code># Test in a clean environment\ndbl sandbox start\n\n# Rebuild database from all layers\ndbl reset\n\n# Run your application tests\n./run-tests.sh\n\n# Verify schema matches expected\ndbl validate\n\n# Deploy when ready\ndbl sandbox apply\n</code></pre>"},{"location":"#why-dbl","title":"Why DBL?","text":""},{"location":"#unlike-raw-sql-scripts","title":"Unlike Raw SQL Scripts","text":"<ul> <li>\u2705 Version controlled with Git</li> <li>\u2705 No manual migration ordering</li> <li>\u2705 Safe sandbox testing</li> <li>\u2705 Complete audit trail</li> </ul>"},{"location":"#unlike-orm-migrations-alembic-django","title":"Unlike ORM Migrations (Alembic, Django)","text":"<ul> <li>\u2705 Database-agnostic (PostgreSQL, MySQL, SQLite)</li> <li>\u2705 Pure SQL - no framework dependency</li> <li>\u2705 Portable between projects</li> <li>\u2705 Works with any programming language</li> </ul>"},{"location":"#unlike-migration-tools-flyway-liquibase","title":"Unlike Migration Tools (Flyway, Liquibase)","text":"<ul> <li>\u2705 Git-like branching for parallel work</li> <li>\u2705 Sandbox for safe testing</li> <li>\u2705 Simple YAML configuration</li> <li>\u2705 Easy to learn and use</li> </ul>"},{"location":"#contributing","title":"Contributing","text":"<p>We welcome contributions! Here are some ways to help:</p> <ul> <li>\ud83d\udc1b Report bugs</li> <li>\ud83d\udca1 Suggest features</li> <li>\ud83d\udcda Improve documentation</li> <li>\ud83d\udcbb Submit code</li> </ul>"},{"location":"#license","title":"License","text":"<p>DBL is licensed under Apache 2.0. See LICENSE for details.</p>"},{"location":"#support","title":"Support","text":"<ul> <li>\ud83d\udc19 GitHub: alann-estrada-KSH/dbl-sandbox</li> <li>\ud83d\udcdd Issues: Report a bug</li> <li>\ud83d\udcac Discussions: Ask a question</li> </ul> <p>Made with \u2764\ufe0f by Alan Estrada</p>"},{"location":"changelog/","title":"Changelog","text":"<p>All notable changes to DBL will be documented in this file.</p> <p>The format is based on Keep a Changelog, and this project adheres to Semantic Versioning.</p>"},{"location":"changelog/#unreleased","title":"[Unreleased]","text":""},{"location":"changelog/#added","title":"Added","text":"<ul> <li>Auto-update command: <code>dbl update</code> to check and install latest version from GitHub</li> <li>Interactive mode with release notes preview</li> <li>Auto-confirm option with <code>-y</code> flag</li> <li>Automatic installation via pip</li> <li>Version comparison (ignores alpha/beta suffixes for compatibility)</li> <li>Automatic dependency checking and installation</li> <li>Package distribution support:</li> <li><code>setup.py</code> for pip installation</li> <li><code>pyproject.toml</code> for modern Python packaging</li> <li><code>requirements.txt</code> for dependency management</li> <li><code>MANIFEST.in</code> for distribution file inclusion</li> <li>Entry point for <code>dbl</code> command after pip install</li> <li>Support for <code>python -m dbl</code> execution</li> <li>Dependency management:</li> <li>Automatic detection of missing dependencies (PyYAML)</li> <li>Auto-install option for missing dependencies</li> <li>Clear error messages with installation instructions</li> </ul>"},{"location":"changelog/#changed","title":"Changed","text":"<ul> <li>Installation process: Now supports <code>pip install git+https://...</code> for easy installation</li> <li>Documentation: Expanded installation guide with multiple installation methods</li> <li>Troubleshooting: Added comprehensive troubleshooting section in README</li> </ul>"},{"location":"changelog/#planned","title":"Planned","text":"<ul> <li>SQLite engine support</li> <li>Migration squashing command</li> <li>Visual diff tool</li> <li>Config file validation</li> </ul>"},{"location":"changelog/#001-alpha-2025-12-30","title":"[0.0.1-alpha] - 2025-12-30","text":""},{"location":"changelog/#initial-release","title":"\ud83c\udf89 Initial Release","text":""},{"location":"changelog/#added_1","title":"Added","text":"<ul> <li>Core Functionality</li> <li>Basic CLI with argparse</li> <li>Git-like command structure (init, commit, branch, checkout, etc.)</li> <li>PostgreSQL engine implementation</li> <li> <p>MySQL engine implementation</p> </li> <li> <p>Sandbox Mode</p> </li> <li>Safe experimentation with shadow databases</li> <li><code>sandbox start</code> - Create isolated environment</li> <li><code>sandbox apply</code> - Confirm changes</li> <li><code>sandbox rollback</code> - Discard changes</li> <li> <p><code>sandbox status</code> - Check current state</p> </li> <li> <p>Layer Management</p> </li> <li>Commit schema changes as layers</li> <li>Layer history tracking</li> <li>Migration SQL generation with phases (expand/backfill/contract)</li> <li> <p>Editor integration for manual SQL review</p> </li> <li> <p>Branching System</p> </li> <li>Create branches for parallel development</li> <li>Switch between branches with <code>checkout</code></li> <li>Merge branches</li> <li>Pull changes from other branches</li> <li> <p>Branch metadata tracking (parent, creation date)</p> </li> <li> <p>Database Operations</p> </li> <li>Schema inspection (AST generation)</li> <li>Table structure analysis</li> <li>Data hash tracking for change detection</li> <li> <p>Smart cloning (template-based or pg_dump fallback)</p> </li> <li> <p>Validation</p> </li> <li>Phase validation (expand/backfill/contract)</li> <li>Detection of risky operations:<ul> <li>Uncommented DROP statements</li> <li>Type changes</li> <li>Missing backfill operations</li> <li>Mixed data/schema changes</li> </ul> </li> <li>Configurable validation rules</li> <li> <p>Non-blocking warnings</p> </li> <li> <p>Advanced Commands</p> </li> <li><code>diff</code> - Detect database changes</li> <li><code>log</code> - View layer history</li> <li><code>rebase</code> - Rebase branches (git-style)</li> <li><code>rev-parse</code> - Resolve references</li> <li><code>reset</code> - Rebuild database from layers</li> <li> <p><code>validate</code> - Check migration patterns</p> </li> <li> <p>Configuration</p> </li> <li>YAML-based configuration (<code>dbl.yaml</code>)</li> <li>Engine selection (postgres/mysql)</li> <li>Docker container support</li> <li>Table tracking configuration</li> <li>Policy settings (drop protection)</li> </ul>"},{"location":"changelog/#architecture","title":"Architecture","text":"<ul> <li>Modular Structure (26 files)</li> <li>Separated engines into pluggable architecture</li> <li>Command modules for each CLI operation</li> <li>Core services (config, state, planner, manifest)</li> <li> <p>Utility functions and error handling</p> </li> <li> <p>Database Abstraction</p> </li> <li><code>DBEngine</code> abstract base class</li> <li>Dialect-specific SQL generation</li> <li>Inspector pattern for schema introspection</li> <li>Pluggable engine system</li> </ul>"},{"location":"changelog/#documentation","title":"Documentation","text":"<ul> <li>README with quick start guide</li> <li>Architecture documentation (ARCHITECTURE.md)</li> <li>Visual structure diagrams (STRUCTURE.md)</li> <li>Inline code documentation</li> </ul>"},{"location":"changelog/#known-issues","title":"Known Issues","text":"<ul> <li>\u26a0\ufe0f Alpha quality - not production ready</li> <li>\u26a0\ufe0f Limited error recovery</li> <li>\u26a0\ufe0f No remote sync capability</li> <li>\u26a0\ufe0f Basic conflict resolution</li> <li>\u26a0\ufe0f Windows path handling may need adjustment</li> </ul>"},{"location":"changelog/#breaking-changes","title":"Breaking Changes","text":"<ul> <li>N/A (initial release)</li> </ul>"},{"location":"changelog/#version-naming-convention","title":"Version Naming Convention","text":"<p>DBL follows Semantic Versioning:</p> <ul> <li>MAJOR version (X.0.0) - Incompatible API changes</li> <li>MINOR version (0.X.0) - New functionality (backwards compatible)</li> <li>PATCH version (0.0.X) - Bug fixes (backwards compatible)</li> </ul>"},{"location":"changelog/#pre-release-tags","title":"Pre-release Tags","text":"<ul> <li>alpha - Early testing, unstable, expect breaking changes</li> <li>beta - Feature complete, stabilizing, minor breaking changes possible</li> <li>rc (release candidate) - Final testing before stable release</li> </ul>"},{"location":"changelog/#examples","title":"Examples","text":"<ul> <li><code>0.0.1-alpha</code> - Initial alpha release</li> <li><code>0.1.0-beta.1</code> - First beta of v0.1</li> <li><code>0.1.0-rc.1</code> - Release candidate</li> <li><code>0.1.0</code> - Stable release</li> <li><code>1.0.0</code> - Production-ready</li> </ul>"},{"location":"changelog/#contributing","title":"Contributing","text":"<p>See changes you'd like to make? Check out our Contributing Guide!</p>"},{"location":"changelog/#links","title":"Links","text":"<ul> <li>Homepage</li> <li>GitHub Repository</li> <li>Issue Tracker</li> </ul>"},{"location":"commands/","title":"Command Reference","text":"<p>Complete reference for all DBL commands.</p>"},{"location":"commands/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Setup Commands</li> <li>Sandbox Commands</li> <li>Layer Commands</li> <li>Branch Commands</li> <li>Inspection Commands</li> <li>Utility Commands</li> </ul>"},{"location":"commands/#setup-commands","title":"Setup Commands","text":""},{"location":"commands/#dbl-init","title":"<code>dbl init</code>","text":"<p>Initialize a new DBL project in the current directory.</p> <p>Usage: <pre><code>dbl init\n</code></pre></p> <p>What it does: - Creates <code>dbl.yaml</code> configuration file - Creates <code>.dbl/</code> directory structure - Initializes <code>master</code> branch - Creates manifest file</p> <p>Example: <pre><code>cd my-project\ndbl init\n# Edit dbl.yaml with your database credentials\n</code></pre></p> <p>Configuration (dbl.yaml): <pre><code>engine: postgres\nhost: localhost\nport: 5432\ndb_name: myapp\nuser: postgres\npassword: password\nignore_tables:\n  - migrations\n  - sessions\npolicies:\n  allow_drop_table: false\n  allow_drop_column: false\n</code></pre></p>"},{"location":"commands/#dbl-import-file","title":"<code>dbl import &lt;file&gt;</code>","text":"<p>Import an existing SQL snapshot as the baseline.</p> <p>Usage: <pre><code>dbl import snapshot.sql\n</code></pre></p> <p>What it does: - Drops and recreates the database - Imports the SQL file - Resets branch history - Sets as master baseline</p> <p>Example: <pre><code># Export your current database\npg_dump myapp &gt; snapshot.sql\n\n# Import into DBL\ndbl import snapshot.sql\n</code></pre></p> <p>\u26a0\ufe0f Warning: This will drop the existing database!</p>"},{"location":"commands/#sandbox-commands","title":"Sandbox Commands","text":""},{"location":"commands/#dbl-sandbox-start","title":"<code>dbl sandbox start</code>","text":"<p>Create a safe sandbox environment for testing changes.</p> <p>Usage: <pre><code>dbl sandbox start\n</code></pre></p> <p>What it does: - Creates a shadow backup of your database - Enables sandbox mode - Allows you to make changes safely</p> <p>Example: <pre><code>dbl sandbox start\n# Now make schema changes in your database\n# Changes won't affect the original until you apply\n</code></pre></p>"},{"location":"commands/#dbl-sandbox-status","title":"<code>dbl sandbox status</code>","text":"<p>Check current sandbox status.</p> <p>Usage: <pre><code>dbl sandbox status\n</code></pre></p> <p>Output: - Shows if sandbox is active - Displays shadow database name - Shows current branch</p>"},{"location":"commands/#dbl-sandbox-apply","title":"<code>dbl sandbox apply</code>","text":"<p>Confirm and apply sandbox changes.</p> <p>Usage: <pre><code>dbl sandbox apply\n</code></pre></p> <p>What it does: - Confirms your changes - Removes the shadow backup - Exits sandbox mode</p> <p>Example: <pre><code>dbl sandbox start\n# ... make changes ...\ndbl commit -m \"Add new columns\"\ndbl sandbox apply\n</code></pre></p>"},{"location":"commands/#dbl-sandbox-rollback","title":"<code>dbl sandbox rollback</code>","text":"<p>Discard sandbox changes and restore original state.</p> <p>Usage: <pre><code>dbl sandbox rollback\n</code></pre></p> <p>What it does: - Restores database from shadow backup - Discards all uncommitted changes - Exits sandbox mode</p> <p>Example: <pre><code>dbl sandbox start\n# ... make changes ...\n# Oh no, something went wrong!\ndbl sandbox rollback\n</code></pre></p> <p>\u26a0\ufe0f Warning: All changes in the sandbox will be lost!</p>"},{"location":"commands/#layer-commands","title":"Layer Commands","text":""},{"location":"commands/#dbl-commit-m-message","title":"<code>dbl commit -m &lt;message&gt;</code>","text":"<p>Commit current database changes as a new layer.</p> <p>Usage: <pre><code>dbl commit -m \"Your commit message\"\ndbl commit -m \"Add auth tables\" --with-data\n</code></pre></p> <p>Options: - <code>-m, --message</code> - Commit message (required) - <code>--with-data</code> - Include data changes (opt-in)</p> <p>What it does: - Compares current DB with sandbox baseline - Generates migration SQL - Opens editor for review - Saves as a layer file</p> <p>Example: <pre><code>dbl sandbox start\n# Add a column in your database\ndbl commit -m \"Add user_email column\"\n</code></pre></p> <p>Generated SQL Structure: <pre><code>-- DBL Migration Layer: 2025-12-30\n-- From: myapp_shadow To: myapp\n\n-- [EXPAND PHASE] --\nALTER TABLE users ADD COLUMN email VARCHAR(255);\n\n-- [CONTRACT PHASE - HARDENING] --\n-- ALTER TABLE users ALTER COLUMN email SET NOT NULL;\n</code></pre></p>"},{"location":"commands/#dbl-diff","title":"<code>dbl diff</code>","text":"<p>Detect changes in the current database.</p> <p>Usage: <pre><code>dbl diff\n</code></pre></p> <p>What it does: - Compares current schema with baseline - Checks data hashes for tracked tables - Shows detected changes</p> <p>Exit codes: - <code>0</code> - No changes detected - <code>1</code> - Changes detected</p> <p>Example: <pre><code>dbl diff\n# Output:\n# \ud83d\udd34 SCHEMA CHANGE detected\n# \ud83d\udd34 DATA CHANGE: users\n</code></pre></p>"},{"location":"commands/#dbl-reset","title":"<code>dbl reset</code>","text":"<p>Rebuild database from scratch using all layers.</p> <p>Usage: <pre><code>dbl reset\n</code></pre></p> <p>What it does: - Drops current database - Creates fresh database - Applies snapshot (if exists) - Replays all layers in order</p> <p>Example: <pre><code>dbl reset\n# Rebuilding myapp on branch master...\n# State restored.\n</code></pre></p> <p>\u26a0\ufe0f Warning: This will drop and recreate your database!</p>"},{"location":"commands/#branch-commands","title":"Branch Commands","text":""},{"location":"commands/#dbl-branch-name","title":"<code>dbl branch [name]</code>","text":"<p>List, create, or delete branches.</p> <p>Usage: <pre><code>dbl branch                    # List branches\ndbl branch feature/new-auth   # Create branch\ndbl branch -d old-feature     # Delete branch\n</code></pre></p> <p>Options: - <code>name</code> - New branch name - <code>-d, --delete</code> - Delete specified branch</p> <p>Example: <pre><code># List all branches\ndbl branch\n# * master\n#   feature/auth &lt;- master\n\n# Create new branch\ndbl branch feature/new-table\n\n# Delete old branch\ndbl branch -d old-feature\n</code></pre></p>"},{"location":"commands/#dbl-checkout-branch","title":"<code>dbl checkout &lt;branch&gt;</code>","text":"<p>Switch to a different branch.</p> <p>Usage: <pre><code>dbl checkout &lt;branch&gt;\n</code></pre></p> <p>What it does: - Updates current branch pointer - Rebuilds database with branch history - Applies all layers from that branch</p> <p>Example: <pre><code>dbl checkout feature/auth\n# Switching to branch 'feature/auth'...\n# Rebuilding database...\n</code></pre></p> <p>\u26a0\ufe0f Requires: No active sandbox. Commit or rollback first.</p>"},{"location":"commands/#dbl-merge-branch","title":"<code>dbl merge &lt;branch&gt;</code>","text":"<p>Merge changes from another branch.</p> <p>Usage: <pre><code>dbl merge &lt;branch&gt;\n</code></pre></p> <p>What it does: - Applies new layers from target branch - Updates current branch - Preserves both branches</p> <p>Example: <pre><code>dbl checkout master\ndbl merge feature/auth\n# Applying 3 layers from feature/auth...\n# Merge completed.\n</code></pre></p>"},{"location":"commands/#dbl-pull-branch","title":"<code>dbl pull &lt;branch&gt;</code>","text":"<p>Pull changes from another branch (like merge, but emphasizes fetching).</p> <p>Usage: <pre><code>dbl pull &lt;branch&gt;\n</code></pre></p> <p>What it does: - Same as merge - Git-like terminology for familiarity</p> <p>Example: <pre><code>dbl pull origin/master\n</code></pre></p>"},{"location":"commands/#dbl-rebase-onto","title":"<code>dbl rebase &lt;onto&gt;</code>","text":"<p>Rebase current branch onto another.</p> <p>Usage: <pre><code>dbl rebase &lt;onto&gt;\ndbl rebase &lt;onto&gt; --dry-run\ndbl rebase &lt;onto&gt; --no-backup\n</code></pre></p> <p>Options: - <code>--dry-run</code> - Show what would happen - <code>--no-backup</code> - Skip backup branch creation</p> <p>What it does: - Replays current branch commits on top of target - Creates backup branch (unless --no-backup) - Updates branch history</p> <p>Example: <pre><code>dbl checkout feature/auth\ndbl rebase master\n# Rebase completed: 'feature/auth' onto 'master'\n# Backup created: feature/auth_backup_20251230\n</code></pre></p>"},{"location":"commands/#inspection-commands","title":"Inspection Commands","text":""},{"location":"commands/#dbl-log-branch","title":"<code>dbl log [branch]</code>","text":"<p>Show layer history for a branch.</p> <p>Usage: <pre><code>dbl log                    # Current branch\ndbl log master            # Specific branch\ndbl log --oneline         # Compact format\ndbl log -n 5              # Last 5 layers\n</code></pre></p> <p>Options: - <code>branch</code> - Branch to inspect (default: current) - <code>--oneline</code> - Short format - <code>-n &lt;number&gt;</code> - Limit number of layers</p> <p>Example: <pre><code>dbl log --oneline\n# a1b2c3d Add user authentication\n# e4f5g6h Create posts table\n# h7i8j9k Initial schema\n</code></pre></p>"},{"location":"commands/#dbl-rev-parse-ref","title":"<code>dbl rev-parse &lt;ref&gt;</code>","text":"<p>Resolve references (HEAD, branches, etc).</p> <p>Usage: <pre><code>dbl rev-parse HEAD\ndbl rev-parse master\n</code></pre></p> <p>Example: <pre><code>dbl rev-parse HEAD\n# master\n</code></pre></p>"},{"location":"commands/#dbl-validate-branch","title":"<code>dbl validate [branch]</code>","text":"<p>Validate migration patterns and detect anomalies.</p> <p>Usage: <pre><code>dbl validate              # Current branch\ndbl validate master       # Specific branch\ndbl validate --fix        # (Future) Auto-fix issues\n</code></pre></p> <p>What it checks: - Contract without prior backfill - Uncommented DROP statements - SET NOT NULL without data population - Mixed data/schema in same layer - Type changes without migration - Orphaned backfill operations</p> <p>Example: <pre><code>dbl validate\n# \u2705 Branch 'master' valid (no anomalies detected)\n\n# Or with issues:\n# \u26a0\ufe0f  Validation for branch 'feature/auth': 2 warning(s)\n#    \u26a0\ufe0f  Layer master_123.sql: Contract without prior backfill\n#    \u26a0\ufe0f  Layer master_124.sql: Column type change detected\n</code></pre></p> <p>Configuration (dbl.yaml): <pre><code>validate:\n  strict: false                # Treat warnings as errors\n  allow_orphaned: false        # Allow backfill without expand\n  require_comments: false      # Require comments for contract\n  detect_type_changes: true    # Warn about type changes\n</code></pre></p>"},{"location":"commands/#utility-commands","title":"Utility Commands","text":""},{"location":"commands/#dbl-version","title":"<code>dbl version</code>","text":"<p>Show version information.</p> <p>Usage: <pre><code>dbl version\n</code></pre></p> <p>Output: <pre><code>\ud83d\ude80 DBL (Database Layering) v0.0.1-alpha\n\u2139\ufe0f  Repository: https://github.com/alann-estrada-KSH/dbl-sandbox\n</code></pre></p>"},{"location":"commands/#dbl-help","title":"<code>dbl help</code>","text":"<p>Show help information.</p> <p>Usage: <pre><code>dbl help\n</code></pre></p> <p>Output: - Lists all available commands - Shows migration phases explanation - Displays validation configuration options</p>"},{"location":"commands/#exit-codes","title":"Exit Codes","text":"<p>DBL uses standard exit codes:</p> <ul> <li><code>0</code> - Success</li> <li><code>1</code> - Error or changes detected (for <code>diff</code>)</li> </ul>"},{"location":"commands/#environment-variables","title":"Environment Variables","text":"<ul> <li><code>EDITOR</code> - Text editor for commit messages (default: <code>nano</code>)</li> <li><code>PGPASSWORD</code> - PostgreSQL password (if not using docker)</li> </ul>"},{"location":"commands/#tips","title":"Tips","text":""},{"location":"commands/#1-always-use-sandbox-mode","title":"1. Always use sandbox mode","text":"<pre><code>dbl sandbox start\n# ... make changes ...\ndbl commit -m \"message\"\ndbl sandbox apply\n</code></pre>"},{"location":"commands/#2-review-generated-sql","title":"2. Review generated SQL","text":"<p>The commit command opens your editor. Always review before saving!</p>"},{"location":"commands/#3-use-descriptive-messages","title":"3. Use descriptive messages","text":"<pre><code># Good \u2705\ndbl commit -m \"Add email column to users table with index\"\n\n# Bad \u274c\ndbl commit -m \"changes\"\n</code></pre>"},{"location":"commands/#4-validate-regularly","title":"4. Validate regularly","text":"<pre><code>dbl validate\n</code></pre>"},{"location":"commands/#5-create-feature-branches","title":"5. Create feature branches","text":"<pre><code>dbl branch feature/my-feature\ndbl checkout feature/my-feature\n# ... work on feature ...\ndbl checkout master\ndbl merge feature/my-feature\n</code></pre>"},{"location":"commands/#see-also","title":"See Also","text":"<ul> <li>Getting Started Guide</li> <li>Best Practices</li> <li>Migration Patterns</li> <li>Architecture</li> </ul>"},{"location":"getting-started/","title":"Getting Started with DBL","text":"<p>This guide will help you get started with DBL in under 10 minutes.</p>"},{"location":"getting-started/#installation","title":"Installation","text":""},{"location":"getting-started/#prerequisites","title":"Prerequisites","text":"<p>Before installing DBL, ensure you have:</p> <ol> <li> <p>Python 3.8+ (3.10+ recommended)    <pre><code>python --version\n</code></pre></p> </li> <li> <p>Database CLI tools (one of):</p> </li> <li>PostgreSQL: <code>psql</code> and <code>pg_dump</code></li> <li> <p>MySQL: <code>mysql</code> and <code>mysqldump</code></p> </li> <li> <p>Optional: Docker (if using containerized databases)</p> </li> </ol>"},{"location":"getting-started/#install-dbl","title":"Install DBL","text":"<pre><code># Clone the repository\ngit clone https://github.com/alann-estrada-KSH/dbl-sandbox.git\ncd dbl-sandbox\n\n# Install Python dependencies\npip install pyyaml\n\n# Make executable (Unix/Linux/Mac)\nchmod +x dbl.py\n\n# Test installation\npython dbl.py version\n# Output: \ud83d\ude80 DBL (Database Layering) v0.0.1-alpha\n</code></pre>"},{"location":"getting-started/#optional-add-to-path","title":"Optional: Add to PATH","text":"<p>For convenience, add DBL to your PATH:</p> <p>Unix/Linux/Mac: <pre><code># Add to ~/.bashrc or ~/.zshrc\nexport PATH=\"$PATH:/path/to/dbl-sandbox\"\nalias dbl='python /path/to/dbl-sandbox/dbl.py'\n\n# Reload shell\nsource ~/.bashrc\n</code></pre></p> <p>Windows: <pre><code># Add to PowerShell profile\nnotepad $PROFILE\n\n# Add this line:\nfunction dbl { python C:\\path\\to\\dbl-sandbox\\dbl.py $args }\n</code></pre></p>"},{"location":"getting-started/#quick-start-tutorial","title":"Quick Start Tutorial","text":""},{"location":"getting-started/#step-1-initialize-project","title":"Step 1: Initialize Project","text":"<pre><code>cd your-project-directory\ndbl init\n</code></pre> <p>This creates: - <code>dbl.yaml</code> - Configuration file - <code>.dbl/</code> - DBL data directory</p>"},{"location":"getting-started/#step-2-configure-database","title":"Step 2: Configure Database","text":"<p>Edit <code>dbl.yaml</code>:</p> <pre><code>engine: postgres\nhost: localhost\nport: 5432\ndb_name: myapp\nuser: postgres\npassword: yourpassword\n\n# Optional: Docker container\ncontainer_name: \"\"\n\n# Tables to ignore\nignore_tables:\n  - migrations\n  - sessions\n\n# Safety policies\npolicies:\n  allow_drop_table: false\n  allow_drop_column: false\n</code></pre>"},{"location":"getting-started/#step-3-import-existing-database-optional","title":"Step 3: Import Existing Database (Optional)","text":"<p>If you have an existing database:</p> <pre><code># Export current database\npg_dump myapp &gt; snapshot.sql\n\n# Import into DBL\ndbl import snapshot.sql\n</code></pre> <p>Or start with an empty database:</p> <pre><code># DBL will work with whatever is in your configured database\ndbl sandbox start\n</code></pre>"},{"location":"getting-started/#step-4-make-your-first-change","title":"Step 4: Make Your First Change","text":"<pre><code># 1. Start sandbox\ndbl sandbox start\n\n# 2. Make changes in your database\n# Use psql, pgAdmin, DBeaver, or any SQL client:\npsql myapp\n# &gt; ALTER TABLE users ADD COLUMN email VARCHAR(255);\n# &gt; \\q\n\n# 3. Check what changed\ndbl diff\n\n# 4. Commit the change\ndbl commit -m \"Add email column to users\"\n\n# 5. Apply changes\ndbl sandbox apply\n</code></pre>"},{"location":"getting-started/#step-5-view-history","title":"Step 5: View History","text":"<pre><code># View layer history\ndbl log\n\n# View in compact format\ndbl log --oneline\n</code></pre>"},{"location":"getting-started/#common-workflows","title":"Common Workflows","text":""},{"location":"getting-started/#workflow-1-feature-development","title":"Workflow 1: Feature Development","text":"<pre><code># Create feature branch\ndbl branch feature/add-notifications\n\n# Start sandbox\ndbl sandbox start\n\n# Make database changes\n# ... use your SQL client ...\n\n# Commit changes\ndbl commit -m \"Add notifications table\"\n\n# Apply\ndbl sandbox apply\n\n# Merge back to master\ndbl checkout master\ndbl merge feature/add-notifications\n</code></pre>"},{"location":"getting-started/#workflow-2-experimentation","title":"Workflow 2: Experimentation","text":"<pre><code># Start sandbox\ndbl sandbox start\n\n# Try different approaches\n# ... experiment freely ...\n\n# Don't like the result?\ndbl sandbox rollback\n\n# Or commit if satisfied\ndbl commit -m \"Experimental feature\"\ndbl sandbox apply\n</code></pre>"},{"location":"getting-started/#workflow-3-rebuilding-database","title":"Workflow 3: Rebuilding Database","text":"<pre><code># Rebuild from scratch\ndbl reset\n\n# This replays all layers in order\n# Useful for:\n# - Switching branches\n# - Verifying reproducibility\n# - Fresh start\n</code></pre>"},{"location":"getting-started/#next-steps","title":"Next Steps","text":"<p>Now that you have DBL running:</p> <ol> <li>Read the Commands Reference - Learn all available commands</li> <li>Study Migration Patterns - Best practices for migrations</li> <li>Review Best Practices - Avoid common pitfalls</li> <li>Understand Architecture - How DBL works internally</li> </ol>"},{"location":"getting-started/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting-started/#cant-connect-to-database","title":"Can't connect to database","text":"<pre><code># Test connection manually first\npsql -h localhost -p 5432 -U postgres -d myapp\n\n# Check dbl.yaml configuration\n# Verify credentials and host/port\n</code></pre>"},{"location":"getting-started/#permission-denied-errors","title":"Permission denied errors","text":"<pre><code># Make sure dbl.py is executable\nchmod +x dbl.py\n\n# Or run with python explicitly\npython dbl.py version\n</code></pre>"},{"location":"getting-started/#sandbox-already-active-error","title":"\"Sandbox already active\" error","text":"<pre><code># Check status\ndbl sandbox status\n\n# Apply or rollback existing sandbox\ndbl sandbox apply\n# or\ndbl sandbox rollback\n</code></pre>"},{"location":"getting-started/#layer-files-not-found","title":"Layer files not found","text":"<pre><code># Verify .dbl directory exists\nls -la .dbl/\n\n# Check manifest\ncat .dbl/layers/manifest.json\n</code></pre>"},{"location":"getting-started/#getting-help","title":"Getting Help","text":"<ul> <li>\ud83d\udcd6 Full Documentation</li> <li>\ud83d\udc1b Report Issues</li> <li>\ud83d\udcac Discussions</li> </ul>"},{"location":"getting-started/#whats-next","title":"What's Next?","text":"<p>Ready to dive deeper? Check out:</p> <ul> <li>Command Reference - Complete command documentation</li> <li>Migration Patterns - Learn expand/backfill/contract</li> <li>Best Practices - Professional tips and tricks</li> </ul>"},{"location":"architecture/engines/","title":"Database Engines","text":"<p>Guide to using DBL with different database engines.</p>"},{"location":"architecture/engines/#supported-engines","title":"Supported Engines","text":"<p>DBL currently supports:</p> Engine Status Version Features PostgreSQL \u2705 Stable 9.6+ Full support MySQL \u2705 Stable 5.7+ Full support SQLite \ud83d\udd04 Planned - Coming soon MariaDB \ud83d\udd04 Planned - Coming soon SQL Server \ud83d\udd04 Planned - Under consideration"},{"location":"architecture/engines/#postgresql","title":"PostgreSQL","text":""},{"location":"architecture/engines/#configuration","title":"Configuration","text":"<pre><code># dbl.yaml\ndatabase:\n  name: myapp\n  engine: postgres\n  host: localhost\n  port: 5432\n  user: dbuser\n  password: ${DB_PASSWORD}\n</code></pre>"},{"location":"architecture/engines/#features","title":"Features","text":"<p>Fully supported: - \u2705 Tables, views, materialized views - \u2705 Indexes (B-tree, Hash, GiST, GIN, BRIN) - \u2705 Constraints (PRIMARY KEY, FOREIGN KEY, UNIQUE, CHECK) - \u2705 Triggers and functions - \u2705 Sequences - \u2705 Extensions - \u2705 Schemas - \u2705 Enums, domains, composite types - \u2705 Partitioning</p>"},{"location":"architecture/engines/#example-workflow","title":"Example Workflow","text":"<pre><code># Initialize with PostgreSQL\ndbl init\n\n# Verify connection\npsql -d myapp -c \"SELECT version();\"\n\n# Create sandbox\ndbl sandbox start\n\n# Make changes\npsql -d myapp_sandbox &lt;&lt; EOF\nCREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    email TEXT UNIQUE NOT NULL,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE INDEX idx_users_email ON users(email);\nEOF\n\n# Commit\ndbl commit -m \"Add users table\"\ndbl sandbox apply\n</code></pre>"},{"location":"architecture/engines/#postgresql-specific-features","title":"PostgreSQL-specific Features","text":""},{"location":"architecture/engines/#extensions","title":"Extensions","text":"<pre><code>-- Layer: L003_enable_extensions.sql\nCREATE EXTENSION IF NOT EXISTS \"uuid-ossp\";\nCREATE EXTENSION IF NOT EXISTS \"pg_trgm\";\n</code></pre>"},{"location":"architecture/engines/#full-text-search","title":"Full-text Search","text":"<pre><code>-- Layer: L008_add_search.sql\nALTER TABLE posts \nADD COLUMN search_vector tsvector;\n\nCREATE INDEX idx_posts_search \nON posts USING GIN(search_vector);\n\nCREATE TRIGGER posts_search_update\nBEFORE INSERT OR UPDATE ON posts\nFOR EACH ROW EXECUTE FUNCTION\n  tsvector_update_trigger(search_vector, 'pg_catalog.english', title, content);\n</code></pre>"},{"location":"architecture/engines/#partitioning","title":"Partitioning","text":"<pre><code>-- Layer: L010_partition_logs.sql\nCREATE TABLE logs (\n    id BIGSERIAL,\n    created_at TIMESTAMP NOT NULL,\n    message TEXT\n) PARTITION BY RANGE (created_at);\n\nCREATE TABLE logs_2024_12 PARTITION OF logs\nFOR VALUES FROM ('2024-12-01') TO ('2025-01-01');\n</code></pre>"},{"location":"architecture/engines/#connection-options","title":"Connection Options","text":"<pre><code># Advanced PostgreSQL config\ndatabase:\n  name: myapp\n  engine: postgres\n  host: localhost\n  port: 5432\n  user: dbuser\n  password: ${DB_PASSWORD}\n  options:\n    sslmode: require\n    connect_timeout: 10\n    application_name: dbl\n</code></pre>"},{"location":"architecture/engines/#postgresql-best-practices","title":"PostgreSQL Best Practices","text":"<ol> <li> <p>Use transactions:    <pre><code>BEGIN;\n-- Multiple operations\nCOMMIT;\n</code></pre></p> </li> <li> <p>Create indexes concurrently:    <pre><code>CREATE INDEX CONCURRENTLY idx_users_email \nON users(email);\n</code></pre></p> </li> <li> <p>Use constraints:    <pre><code>ALTER TABLE users\nADD CONSTRAINT check_email \nCHECK (email ~* '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}$');\n</code></pre></p> </li> </ol>"},{"location":"architecture/engines/#mysql","title":"MySQL","text":""},{"location":"architecture/engines/#configuration_1","title":"Configuration","text":"<pre><code># dbl.yaml\ndatabase:\n  name: myapp\n  engine: mysql\n  host: localhost\n  port: 3306\n  user: dbuser\n  password: ${DB_PASSWORD}\n</code></pre>"},{"location":"architecture/engines/#features_1","title":"Features","text":"<p>Fully supported: - \u2705 Tables and views - \u2705 Indexes (B-tree, Full-text, Spatial) - \u2705 Constraints (PRIMARY KEY, FOREIGN KEY, UNIQUE) - \u2705 Triggers and stored procedures - \u2705 Auto-increment - \u2705 Character sets and collations - \u26a0\ufe0f Limited: CHECK constraints (MySQL 8.0.16+)</p> <p>Limitations: - \u274c No native schemas (use databases) - \u274c No materialized views - \u274c Limited functional indexes</p>"},{"location":"architecture/engines/#example-workflow_1","title":"Example Workflow","text":"<pre><code># Initialize with MySQL\ndbl init\n\n# Verify connection\nmysql -u dbuser -p myapp -e \"SELECT VERSION();\"\n\n# Create sandbox\ndbl sandbox start\n\n# Make changes\nmysql -u dbuser -p myapp_sandbox &lt;&lt; EOF\nCREATE TABLE users (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    email VARCHAR(255) UNIQUE NOT NULL,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n\nCREATE INDEX idx_users_email ON users(email);\nEOF\n\n# Commit\ndbl commit -m \"Add users table\"\ndbl sandbox apply\n</code></pre>"},{"location":"architecture/engines/#mysql-specific-features","title":"MySQL-specific Features","text":""},{"location":"architecture/engines/#storage-engines","title":"Storage Engines","text":"<pre><code>-- Layer: L002_setup_tables.sql\nCREATE TABLE users (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    username VARCHAR(50)\n) ENGINE=InnoDB;\n\nCREATE TABLE cache (\n    key VARCHAR(255) PRIMARY KEY,\n    value TEXT\n) ENGINE=MEMORY;\n</code></pre>"},{"location":"architecture/engines/#full-text-search_1","title":"Full-text Search","text":"<pre><code>-- Layer: L006_add_search.sql\nALTER TABLE posts \nADD FULLTEXT INDEX ft_posts_content (title, content);\n\n-- Usage:\n-- SELECT * FROM posts \n-- WHERE MATCH(title, content) AGAINST('search term');\n</code></pre>"},{"location":"architecture/engines/#character-sets","title":"Character Sets","text":"<pre><code>-- Layer: L001_setup_charset.sql\nALTER DATABASE myapp \nCHARACTER SET utf8mb4 \nCOLLATE utf8mb4_unicode_ci;\n\nCREATE TABLE messages (\n    id INT PRIMARY KEY,\n    text TEXT CHARACTER SET utf8mb4 \n             COLLATE utf8mb4_unicode_ci\n);\n</code></pre>"},{"location":"architecture/engines/#connection-options_1","title":"Connection Options","text":"<pre><code># Advanced MySQL config\ndatabase:\n  name: myapp\n  engine: mysql\n  host: localhost\n  port: 3306\n  user: dbuser\n  password: ${DB_PASSWORD}\n  options:\n    charset: utf8mb4\n    ssl_ca: /path/to/ca.pem\n    connect_timeout: 10\n</code></pre>"},{"location":"architecture/engines/#mysql-best-practices","title":"MySQL Best Practices","text":"<ol> <li> <p>Always specify engine:    <pre><code>CREATE TABLE users (...) ENGINE=InnoDB;\n</code></pre></p> </li> <li> <p>Use proper character set:    <pre><code>CREATE TABLE messages (\n    content TEXT\n) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;\n</code></pre></p> </li> <li> <p>Disable foreign key checks for migrations (when needed):    <pre><code>SET FOREIGN_KEY_CHECKS=0;\n-- Migrations\nSET FOREIGN_KEY_CHECKS=1;\n</code></pre></p> </li> </ol>"},{"location":"architecture/engines/#engine-comparison","title":"Engine Comparison","text":"Feature PostgreSQL MySQL Schemas \u2705 Native \u274c Use databases Materialized Views \u2705 Yes \u274c No Full-text Search \u2705 Native (tsvector) \u2705 FULLTEXT indexes JSON \u2705 JSONB (binary) \u2705 JSON Arrays \u2705 Native \u274c Use JSON Window Functions \u2705 Yes \u2705 Yes (8.0+) CTEs (WITH) \u2705 Yes \u2705 Yes (8.0+) Partial Indexes \u2705 Yes \u274c No Concurrent Indexes \u2705 Yes \u274c No"},{"location":"architecture/engines/#switching-engines","title":"Switching Engines","text":""},{"location":"architecture/engines/#postgresql-mysql","title":"PostgreSQL \u2192 MySQL","text":"<p>Considerations: - Remove schema references - Change <code>SERIAL</code> \u2192 <code>AUTO_INCREMENT</code> - Change <code>TEXT</code> \u2192 <code>TEXT</code> or <code>VARCHAR(n)</code> - Remove PostgreSQL-specific types (arrays, JSONB)</p> <pre><code>-- PostgreSQL\nCREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    tags TEXT[]\n);\n\n-- MySQL equivalent\nCREATE TABLE users (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    tags JSON\n) ENGINE=InnoDB;\n</code></pre>"},{"location":"architecture/engines/#mysql-postgresql","title":"MySQL \u2192 PostgreSQL","text":"<p>Considerations: - Can use schemas - Change <code>AUTO_INCREMENT</code> \u2192 <code>SERIAL</code> - Can use advanced types - Remove <code>ENGINE=InnoDB</code> clauses</p> <pre><code>-- MySQL\nCREATE TABLE users (\n    id INT AUTO_INCREMENT PRIMARY KEY\n) ENGINE=InnoDB;\n\n-- PostgreSQL equivalent\nCREATE TABLE users (\n    id SERIAL PRIMARY KEY\n);\n</code></pre>"},{"location":"architecture/engines/#engine-detection","title":"Engine Detection","text":"<p>DBL auto-detects engine from connection:</p> <pre><code># Auto-detect from connection\ndatabase:\n  name: myapp\n  host: localhost\n  # engine: auto-detected\n</code></pre> <p>Or specify explicitly:</p> <pre><code>database:\n  engine: postgres  # or mysql\n</code></pre>"},{"location":"architecture/engines/#testing-across-engines","title":"Testing Across Engines","text":"<p>Test your layers on both engines:</p> <pre><code># Test PostgreSQL\ndbl --config dbl-postgres.yaml reset\n\n# Test MySQL\ndbl --config dbl-mysql.yaml reset\n</code></pre>"},{"location":"architecture/engines/#engine-specific-commands","title":"Engine-specific Commands","text":""},{"location":"architecture/engines/#postgresql-tools","title":"PostgreSQL Tools","text":"<pre><code># Dump schema only\npg_dump -s myapp &gt; schema.sql\n\n# Restore\npsql myapp &lt; schema.sql\n\n# Analyze database\npsql myapp -c \"ANALYZE VERBOSE;\"\n</code></pre>"},{"location":"architecture/engines/#mysql-tools","title":"MySQL Tools","text":"<pre><code># Dump schema only\nmysqldump --no-data myapp &gt; schema.sql\n\n# Restore\nmysql myapp &lt; schema.sql\n\n# Analyze database\nmysql myapp -e \"ANALYZE TABLE users;\"\n</code></pre>"},{"location":"architecture/engines/#future-support","title":"Future Support","text":""},{"location":"architecture/engines/#sqlite","title":"SQLite","text":"<p>Planned features: - File-based databases - Embedded use cases - Local development</p>"},{"location":"architecture/engines/#mariadb","title":"MariaDB","text":"<p>Planned features: - Full compatibility with MySQL - MariaDB-specific features (virtual columns, etc.)</p>"},{"location":"architecture/engines/#sql-server","title":"SQL Server","text":"<p>Under consideration: - Windows authentication - SSMS integration - Azure SQL Database</p>"},{"location":"architecture/engines/#see-also","title":"See Also","text":"<ul> <li>Configuration Guide</li> <li>Getting Started</li> <li>Best Practices</li> <li>Troubleshooting</li> </ul>"},{"location":"architecture/overview/","title":"Architecture Overview","text":"<p>Understanding how DBL works internally.</p>"},{"location":"architecture/overview/#core-concepts","title":"Core Concepts","text":""},{"location":"architecture/overview/#1-layers","title":"1. Layers","text":"<p>Layers are the fundamental unit of change in DBL.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Layer (L005)                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 ID: L005                            \u2502\n\u2502 Message: \"Add comments feature\"     \u2502\n\u2502 Timestamp: 2024-12-30 14:32:11      \u2502\n\u2502 SQL: CREATE TABLE comments (...)    \u2502\n\u2502 Branch: main                        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Properties: - Sequential: Numbered L001, L002, L003... - Immutable: Once created, shouldn't be changed - Reproducible: Can be replayed anytime - Portable: Plain SQL files</p>"},{"location":"architecture/overview/#2-state","title":"2. State","text":"<p>DBL tracks database state in <code>.dbl/state.json</code>:</p> <pre><code>{\n  \"database\": \"myapp\",\n  \"engine\": \"postgres\",\n  \"branch\": \"main\",\n  \"last_layer\": \"L015\",\n  \"active_sandbox\": null,\n  \"created_at\": \"2024-12-28T10:00:00Z\"\n}\n</code></pre> <p>Tracks: - Current database - Active branch - Last applied layer - Sandbox status</p>"},{"location":"architecture/overview/#3-sandboxes","title":"3. Sandboxes","text":"<p>Sandboxes are temporary database copies:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Main DB     \u2502         \u2502  Sandbox DB      \u2502\n\u2502  myapp       \u2502 copy    \u2502  myapp_sandbox   \u2502\n\u2502              \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt;\u2502                  \u2502\n\u2502  (stable)    \u2502         \u2502  (experimental)  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>Features: - Isolated from main database - Can be applied or discarded - Automatically managed</p>"},{"location":"architecture/overview/#4-branches","title":"4. Branches","text":"<p>Branches enable parallel development:</p> <pre><code>main:       L001 \u2500 L002 \u2500 L003 \u2500 L004\n                      \u2502\n                      \u2514\u2500 L005 \u2500 L006  (feature-auth)\n</code></pre> <p>Allows: - Independent feature development - Team collaboration - Experimental changes</p>"},{"location":"architecture/overview/#system-architecture","title":"System Architecture","text":""},{"location":"architecture/overview/#directory-structure","title":"Directory Structure","text":"<pre><code>project/\n\u251c\u2500\u2500 dbl.yaml                    # Configuration\n\u251c\u2500\u2500 .dbl/                       # DBL metadata\n\u2502   \u251c\u2500\u2500 state.json             # Current state\n\u2502   \u251c\u2500\u2500 sandbox.json           # Active sandbox info\n\u2502   \u251c\u2500\u2500 layers/                # Committed changes\n\u2502   \u2502   \u251c\u2500\u2500 L001_initial.sql\n\u2502   \u2502   \u251c\u2500\u2500 L002_add_users.sql\n\u2502   \u2502   \u2514\u2500\u2500 L003_add_posts.sql\n\u2502   \u2514\u2500\u2500 branches/              # Branch metadata\n\u2502       \u251c\u2500\u2500 main.json\n\u2502       \u2514\u2500\u2500 feature-auth.json\n\u2514\u2500\u2500 migrations/                # Your app migrations (optional)\n</code></pre>"},{"location":"architecture/overview/#component-diagram","title":"Component Diagram","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    DBL Core                         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                     \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u2502\n\u2502  \u2502  Config  \u2502  \u2502  State   \u2502  \u2502 Planner  \u2502         \u2502\n\u2502  \u2502 Manager  \u2502  \u2502 Manager  \u2502  \u2502          \u2502         \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518         \u2502\n\u2502       \u2502             \u2502             \u2502                \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2510         \u2502\n\u2502  \u2502         Layer Manager                 \u2502         \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2502\n\u2502                   \u2502                                \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u2502\n\u2502  \u2502        Database Engine                \u2502         \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u2502         \u2502\n\u2502  \u2502  \u2502PostgreSQL\u2502      \u2502  MySQL   \u2502       \u2502         \u2502\n\u2502  \u2502  \u2502 Engine   \u2502      \u2502 Engine   \u2502       \u2502         \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2502         \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2502\n\u2502                                                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          \u2502\n                          \u25bc\n                  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                  \u2502   Database    \u2502\n                  \u2502   (Postgres/  \u2502\n                  \u2502    MySQL)     \u2502\n                  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/overview/#workflow-diagrams","title":"Workflow Diagrams","text":""},{"location":"architecture/overview/#sandbox-workflow","title":"Sandbox Workflow","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                 Sandbox Lifecycle                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n   [Start]\n      \u2502\n      \u25bc\n   dbl sandbox start\n      \u2502\n      \u251c\u2500 Create sandbox DB (copy main)\n      \u251c\u2500 Track in sandbox.json\n      \u2514\u2500 Mark as active\n      \u2502\n      \u25bc\n   [Make Changes]\n      \u2502\n      \u251c\u2500 Direct SQL\n      \u251c\u2500 Application ORM\n      \u2514\u2500 Manual edits\n      \u2502\n      \u25bc\n   dbl diff\n      \u2502\n      \u2514\u2500 Compare sandbox vs main\n      \u2502\n      \u25bc\n   dbl commit\n      \u2502\n      \u251c\u2500 Generate SQL layer\n      \u251c\u2500 Save to .dbl/layers/\n      \u2514\u2500 Update state\n      \u2502\n      \u25bc\n   Decision: Apply or Rollback?\n      \u2502\n      \u251c\u2500 Apply \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n      \u2502   \u2502              \u2502\n      \u2502   \u25bc              \u2502\n      \u2502 dbl sandbox apply\u2502\n      \u2502   \u2502              \u2502\n      \u2502   \u251c\u2500 Apply to    \u2502\n      \u2502   \u2502   main DB    \u2502\n      \u2502   \u251c\u2500 Drop sandbox\u2502\n      \u2502   \u2514\u2500 Clean state \u2502\n      \u2502                  \u2502\n      \u2514\u2500 Rollback \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n          \u2502              \u2502\n          \u25bc              \u2502\n      dbl sandbox rollback\n          \u2502              \u2502\n          \u2514\u2500 Drop sandbox\u2502\n                         \u2502\n                         \u25bc\n                      [End]\n</code></pre>"},{"location":"architecture/overview/#reset-workflow","title":"Reset Workflow","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                 Reset Process                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n   [Start]\n      \u2502\n      \u25bc\n   dbl reset\n      \u2502\n      \u251c\u2500 Confirm action\n      \u2514\u2500 Backup recommended\n      \u2502\n      \u25bc\n   Drop Database\n      \u2502\n      \u2514\u2500 DROP DATABASE myapp\n      \u2502\n      \u25bc\n   Create Database\n      \u2502\n      \u2514\u2500 CREATE DATABASE myapp\n      \u2502\n      \u25bc\n   Replay Layers (in order)\n      \u2502\n      \u251c\u2500 L001 \u2500&gt; Execute \u2500&gt; \u2713\n      \u251c\u2500 L002 \u2500&gt; Execute \u2500&gt; \u2713\n      \u251c\u2500 L003 \u2500&gt; Execute \u2500&gt; \u2713\n      \u2514\u2500 ...\n      \u2502\n      \u25bc\n   Update State\n      \u2502\n      \u2514\u2500 Mark layers as applied\n      \u2502\n      \u25bc\n   [Complete]\n</code></pre>"},{"location":"architecture/overview/#branch-workflow","title":"Branch Workflow","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                 Branch Lifecycle                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n   main: L001 \u2500 L002 \u2500 L003\n                   \u2502\n                   \u2502 dbl branch feature-auth\n                   \u2502 dbl checkout feature-auth\n                   \u2502\n                   \u251c\u2500 feature-auth: L003 (base)\n                   \u2502                  \u2502\n                   \u2502                  \u2502 dbl commit\n                   \u2502                  \u2502\n                   \u2502                  \u251c\u2500 L004 (new)\n                   \u2502                  \u2502\n                   \u2502                  \u2502 dbl commit\n                   \u2502                  \u2502\n                   \u2502                  \u2514\u2500 L005 (new)\n                   \u2502\n                   \u2502 main continues:\n                   \u2502\n                   \u2514\u2500 L006 (different change)\n\n   Result:\n   main:         L001 \u2500 L002 \u2500 L003 \u2500 L006\n   feature-auth: L001 \u2500 L002 \u2500 L003 \u2500 L004 \u2500 L005\n</code></pre>"},{"location":"architecture/overview/#data-flow","title":"Data Flow","text":""},{"location":"architecture/overview/#diff-operation","title":"Diff Operation","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Sandbox  \u2502\n\u2502 Database \u2502\n\u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518\n     \u2502\n     \u2502 Read schema\n     \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Schema    \u2502\n\u2502  Introspection\u2502\n\u2502   (Sandbox)  \u2502\n\u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n     \u2502\n     \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n     \u2502                 \u2502\n     \u25bc                 \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Main   \u2502       \u2502 Sandbox \u2502\n\u2502 Schema  \u2502       \u2502 Schema  \u2502\n\u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518       \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518\n     \u2502                 \u2502\n     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n              \u2502\n              \u25bc\n         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502  Diff   \u2502\n         \u2502 Engine  \u2502\n         \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518\n              \u2502\n              \u25bc\n         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502  SQL    \u2502\n         \u2502 Output  \u2502\n         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/overview/#commit-operation","title":"Commit Operation","text":"<pre><code>   [Changes in Sandbox]\n         \u2502\n         \u25bc\n   Run Diff \u2500\u2500\u2500\u2500&gt; Generate SQL\n         \u2502\n         \u25bc\n   Create Layer File\n         \u2502\n         \u251c\u2500 Filename: L{N}_{message}.sql\n         \u251c\u2500 Content: SQL statements\n         \u2514\u2500 Metadata: timestamp, branch\n         \u2502\n         \u25bc\n   Update State\n         \u2502\n         \u2514\u2500 Increment layer counter\n</code></pre>"},{"location":"architecture/overview/#engine-abstraction","title":"Engine Abstraction","text":""},{"location":"architecture/overview/#engine-interface","title":"Engine Interface","text":"<pre><code>class DatabaseEngine:\n    \"\"\"Base class for database engines\"\"\"\n\n    def connect(self):\n        \"\"\"Establish database connection\"\"\"\n        pass\n\n    def get_schema(self, database):\n        \"\"\"Get current schema\"\"\"\n        pass\n\n    def diff_schemas(self, source, target):\n        \"\"\"Compare two schemas\"\"\"\n        pass\n\n    def apply_sql(self, sql):\n        \"\"\"Execute SQL\"\"\"\n        pass\n\n    def create_database(self, name):\n        \"\"\"Create new database\"\"\"\n        pass\n\n    def drop_database(self, name):\n        \"\"\"Drop database\"\"\"\n        pass\n</code></pre>"},{"location":"architecture/overview/#engine-implementations","title":"Engine Implementations","text":"<pre><code>PostgresEngine(DatabaseEngine):\n    \"\"\"PostgreSQL-specific implementation\"\"\"\n\n    def get_schema(self, database):\n        # Query pg_catalog\n        # Extract tables, columns, indexes...\n        return schema\n\nMySQLEngine(DatabaseEngine):\n    \"\"\"MySQL-specific implementation\"\"\"\n\n    def get_schema(self, database):\n        # Query information_schema\n        # Extract tables, columns, indexes...\n        return schema\n</code></pre>"},{"location":"architecture/overview/#state-management","title":"State Management","text":""},{"location":"architecture/overview/#state-transitions","title":"State Transitions","text":"<pre><code>[Initialized] \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500&gt; [Clean]\n                              \u2502\n                              \u2502 sandbox start\n                              \u25bc\n                          [Sandbox Active]\n                              \u2502\n                              \u251c\u2500 apply \u2500\u2500&gt; [Clean]\n                              \u2514\u2500 rollback \u2500&gt; [Clean]\n</code></pre>"},{"location":"architecture/overview/#state-file-schema","title":"State File Schema","text":"<pre><code>{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"type\": \"object\",\n  \"properties\": {\n    \"database\": {\"type\": \"string\"},\n    \"engine\": {\"enum\": [\"postgres\", \"mysql\"]},\n    \"branch\": {\"type\": \"string\"},\n    \"last_layer\": {\"type\": \"string\", \"pattern\": \"^L[0-9]{3}$\"},\n    \"active_sandbox\": {\"type\": [\"string\", \"null\"]},\n    \"created_at\": {\"type\": \"string\", \"format\": \"date-time\"}\n  },\n  \"required\": [\"database\", \"engine\", \"branch\"]\n}\n</code></pre>"},{"location":"architecture/overview/#performance-considerations","title":"Performance Considerations","text":""},{"location":"architecture/overview/#schema-introspection","title":"Schema Introspection","text":"<ul> <li>Cached: Schema queries are cached per command</li> <li>Indexed: Uses database catalog indexes</li> <li>Selective: Only queries needed metadata</li> </ul>"},{"location":"architecture/overview/#layer-application","title":"Layer Application","text":"<ul> <li>Transactional: Each layer in a transaction</li> <li>Sequential: Applied in order</li> <li>Idempotent: Can be replayed safely</li> </ul>"},{"location":"architecture/overview/#diff-generation","title":"Diff Generation","text":"<ul> <li>Optimized: Only compares changed objects</li> <li>Parallel: Can diff multiple tables simultaneously</li> <li>Minimal: Generates minimal SQL</li> </ul>"},{"location":"architecture/overview/#security-model","title":"Security Model","text":""},{"location":"architecture/overview/#permissions-required","title":"Permissions Required","text":"<pre><code>-- PostgreSQL\nGRANT CONNECT ON DATABASE myapp TO dbuser;\nGRANT CREATE ON DATABASE myapp TO dbuser;\nGRANT ALL ON ALL TABLES IN SCHEMA public TO dbuser;\n\n-- MySQL\nGRANT ALL PRIVILEGES ON myapp.* TO 'dbuser'@'localhost';\nGRANT CREATE ON *.* TO 'dbuser'@'localhost';\n</code></pre>"},{"location":"architecture/overview/#credential-management","title":"Credential Management","text":"<ul> <li>Never stores passwords in files</li> <li>Uses environment variables</li> <li>Supports external secret managers</li> </ul>"},{"location":"architecture/overview/#extensibility","title":"Extensibility","text":""},{"location":"architecture/overview/#plugin-system-future","title":"Plugin System (Future)","text":"<pre><code># Custom hook example\n@dbl.hook('before_commit')\ndef validate_naming(layer):\n    \"\"\"Ensure tables follow naming convention\"\"\"\n    for table in layer.tables:\n        if not table.name.islower():\n            raise ValueError(f\"Table {table.name} must be lowercase\")\n\n@dbl.hook('after_apply')\ndef notify_team(layer):\n    \"\"\"Send Slack notification\"\"\"\n    slack.send(f\"Layer {layer.id} applied to production\")\n</code></pre>"},{"location":"architecture/overview/#see-also","title":"See Also","text":"<ul> <li>Database Engines - Engine-specific details</li> <li>Best Practices - Usage patterns</li> <li>Configuration - Config options</li> </ul>"},{"location":"commands/","title":"Commands Overview","text":"<p>DBL provides a comprehensive set of commands organized by functionality. This guide will help you understand what each command does and when to use it.</p>"},{"location":"commands/#command-categories","title":"Command Categories","text":""},{"location":"commands/#setup-commands","title":"\ud83d\udd27 Setup Commands","text":"<p>Commands for initializing and maintaining your DBL installation.</p> Command Description <code>dbl init</code> Initialize DBL in your project <code>dbl version</code> Show DBL version information <code>dbl update</code> Check and install DBL updates"},{"location":"commands/#sandbox-commands","title":"\ud83c\udfd6\ufe0f Sandbox Commands","text":"<p>Safe testing environment for database changes.</p> Command Description <code>dbl sandbox start</code> Create an isolated sandbox database <code>dbl sandbox apply</code> Apply sandbox changes to main database <code>dbl sandbox rollback</code> Discard all sandbox changes <code>dbl sandbox status</code> Check sandbox state"},{"location":"commands/#change-management","title":"\ud83d\udcdd Change Management","text":"<p>Commands for tracking and committing database changes.</p> Command Description <code>dbl diff</code> Show changes in sandbox vs baseline <code>dbl commit</code> Save changes as a versioned layer <code>dbl reset</code> Rebuild database from layers"},{"location":"commands/#branching","title":"\ud83c\udf3f Branching","text":"<p>Git-like branching for parallel development.</p> Command Description <code>dbl branch</code> List, create, or delete branches <code>dbl checkout</code> Switch to a different branch <code>dbl merge</code> Merge changes from another branch <code>dbl pull</code> Pull changes from another branch <code>dbl rebase</code> Rebase current branch onto another"},{"location":"commands/#history-inspection","title":"\ud83d\udcdc History &amp; Inspection","text":"<p>View and validate your database history.</p> Command Description <code>dbl log</code> View layer history <code>dbl rev-parse</code> Resolve references (HEAD, branches) <code>dbl validate</code> Validate migration patterns"},{"location":"commands/#quick-reference","title":"Quick Reference","text":""},{"location":"commands/#common-workflows","title":"Common Workflows","text":"<p>Basic workflow: <pre><code>dbl sandbox start      # Create sandbox\n# Make changes in database...\ndbl diff              # Review changes\ndbl commit -m \"msg\"   # Save changes\ndbl sandbox apply     # Apply to main DB\n</code></pre></p> <p>Branch workflow: <pre><code>dbl branch feature-x  # Create branch\ndbl checkout feature-x # Switch to branch\n# Work on feature...\ndbl checkout master   # Back to master\ndbl merge feature-x   # Merge changes\n</code></pre></p> <p>Review history: <pre><code>dbl log               # Full history\ndbl log --oneline     # Compact view\ndbl log -n 5          # Last 5 layers\n</code></pre></p>"},{"location":"commands/#command-syntax-patterns","title":"Command Syntax Patterns","text":"<p>DBL follows consistent patterns across commands:</p> <ul> <li>Flags: Options starting with <code>-</code> or <code>--</code></li> <li>Arguments: Required or optional parameters</li> <li>Subcommands: Commands with actions (e.g., <code>sandbox start</code>)</li> </ul>"},{"location":"commands/#examples","title":"Examples:","text":"<pre><code>dbl command [options] [arguments]\ndbl command subcommand [options]\ndbl command --flag value argument\n</code></pre>"},{"location":"commands/#getting-help","title":"Getting Help","text":"<p>For detailed help on any command: <pre><code>dbl help\ndbl &lt;command&gt; --help\n</code></pre></p>"},{"location":"commands/#next-steps","title":"Next Steps","text":"<ul> <li>Quick Start Tutorial</li> <li>Best Practices</li> <li>Configuration Guide</li> </ul>"},{"location":"commands/branching/","title":"Branching","text":"<p>Learn how to use branches in DBL to manage parallel development.</p>"},{"location":"commands/branching/#overview","title":"Overview","text":"<p>DBL branches work like Git branches but for database schemas. They allow multiple developers to work on different features simultaneously without conflicts.</p>"},{"location":"commands/branching/#quick-reference","title":"Quick Reference","text":"<pre><code># Create branch\ndbl branch feature-auth\n\n# Switch branches\ndbl checkout feature-auth\n\n# List branches\ndbl branch\n\n# Merge branches (future)\ndbl merge feature-auth\n</code></pre>"},{"location":"commands/branching/#branch-concepts","title":"Branch Concepts","text":""},{"location":"commands/branching/#what-is-a-branch","title":"What is a Branch?","text":"<p>A branch is an independent line of development:</p> <pre><code>main:     L001 \u2192 L002 \u2192 L003 \u2192 L004\n                    \u2193\nfeature:           L003 \u2192 L005 \u2192 L006\n</code></pre> <ul> <li>Each branch has its own layer sequence</li> <li>Branches share common history</li> <li>Changes in one branch don't affect others</li> </ul>"},{"location":"commands/branching/#when-to-branch","title":"When to Branch","text":"<p>\u2705 Use branches for: - New features - Experimental changes - Hotfixes - Multiple parallel developments</p> <p>\u274c Don't branch for: - Quick fixes (use sandbox instead) - Single-person projects (maybe) - Linear development</p>"},{"location":"commands/branching/#branch-workflow","title":"Branch Workflow","text":""},{"location":"commands/branching/#basic-workflow","title":"Basic Workflow","text":"<pre><code># 1. Create feature branch\n$ dbl branch feature-comments\n$ dbl checkout feature-comments\n\n# 2. Make changes\n$ dbl sandbox start\n# ... make changes ...\n$ dbl commit -m \"Add comments table\"\n\n# 3. Continue working\n$ dbl commit -m \"Add comment indexes\"\n\n# 4. Switch back to main\n$ dbl checkout main\n\n# 5. Merge (manual for now)\n# Copy layers from feature branch\n</code></pre>"},{"location":"commands/branching/#team-workflow","title":"Team Workflow","text":"<pre><code># Developer 1: Works on auth\n$ dbl branch feature-auth\n$ dbl checkout feature-auth\n# ... work on authentication ...\n\n# Developer 2: Works on payments (parallel)\n$ dbl branch feature-payments\n$ dbl checkout feature-payments\n# ... work on payments ...\n\n# Both can work independently!\n</code></pre>"},{"location":"commands/branching/#branch-operations","title":"Branch Operations","text":""},{"location":"commands/branching/#create-branch","title":"Create Branch","text":"<pre><code># Create from current point\n$ dbl branch feature-name\n\n# Create and switch\n$ dbl branch feature-name\n$ dbl checkout feature-name\n</code></pre>"},{"location":"commands/branching/#switch-branches","title":"Switch Branches","text":"<pre><code># Switch to existing branch\n$ dbl checkout feature-auth\n\n# Your database and layers change to that branch's state\n</code></pre>"},{"location":"commands/branching/#list-branches","title":"List Branches","text":"<pre><code>$ dbl branch\n\n  main\n* feature-auth\n  feature-payments\n\n(* = current branch)\n</code></pre>"},{"location":"commands/branching/#delete-branch","title":"Delete Branch","text":"<pre><code># Delete merged branch\n$ dbl branch -d feature-auth\n\n# Force delete\n$ dbl branch -D feature-auth\n</code></pre>"},{"location":"commands/branching/#examples","title":"Examples","text":""},{"location":"commands/branching/#feature-development","title":"Feature Development","text":"<pre><code># Start feature\n$ dbl branch feature-notifications\n$ dbl checkout feature-notifications\n\n# Build feature\n$ dbl sandbox start\n$ psql -d myapp_sandbox &lt;&lt; EOF\nCREATE TABLE notifications (\n    id SERIAL PRIMARY KEY,\n    user_id INTEGER REFERENCES users(id),\n    message TEXT,\n    read BOOLEAN DEFAULT false,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\nEOF\n\n$ dbl commit -m \"Add notifications table\"\n\n# Add more\n$ psql -d myapp_sandbox &lt;&lt; EOF\nCREATE INDEX idx_notifications_user \nON notifications(user_id);\nEOF\n\n$ dbl commit -m \"Add notifications indexes\"\n\n# Feature complete\n$ dbl log\n* L006 - Add notifications indexes\n* L005 - Add notifications table\n* L004 - Add comments (from main)\n</code></pre>"},{"location":"commands/branching/#parallel-features","title":"Parallel Features","text":"<pre><code># Feature 1: Authentication\n$ dbl branch feature-auth\n$ dbl checkout feature-auth\n$ dbl sandbox start\n# ... add auth tables ...\n$ dbl commit -m \"Add authentication\"\n\n# Switch to Feature 2: Profiles\n$ dbl checkout main\n$ dbl branch feature-profiles\n$ dbl checkout feature-profiles\n$ dbl sandbox start\n# ... add profile tables ...\n$ dbl commit -m \"Add user profiles\"\n\n# Both features developed independently!\n</code></pre>"},{"location":"commands/branching/#hotfix-workflow","title":"Hotfix Workflow","text":"<pre><code># Critical bug in production\n$ dbl checkout main\n\n# Create hotfix branch\n$ dbl branch hotfix-user-constraint\n$ dbl checkout hotfix-user-constraint\n\n# Fix issue\n$ dbl sandbox start\n$ psql -d myapp_sandbox -c \"\nALTER TABLE users \nADD CONSTRAINT unique_email UNIQUE(email);\n\"\n$ dbl commit -m \"hotfix: Add unique email constraint\"\n$ dbl sandbox apply\n\n# Deploy immediately\n$ dbl checkout main\n# Merge hotfix (manual for now)\n</code></pre>"},{"location":"commands/branching/#branch-strategy","title":"Branch Strategy","text":""},{"location":"commands/branching/#gitflow-style","title":"Gitflow-style","text":"<pre><code>main (production)\n  \u251c\u2500\u2500 develop (staging)\n  \u2502   \u251c\u2500\u2500 feature-auth\n  \u2502   \u251c\u2500\u2500 feature-payments\n  \u2502   \u2514\u2500\u2500 feature-notifications\n  \u2514\u2500\u2500 hotfix-critical-bug\n</code></pre>"},{"location":"commands/branching/#trunk-based","title":"Trunk-based","text":"<pre><code>main (always deployable)\n  \u251c\u2500\u2500 feature-short-lived-1\n  \u2514\u2500\u2500 feature-short-lived-2\n</code></pre>"},{"location":"commands/branching/#feature-branches","title":"Feature Branches","text":"<pre><code>main\n  \u251c\u2500\u2500 feature/user-management\n  \u251c\u2500\u2500 feature/reporting\n  \u2514\u2500\u2500 feature/api-v2\n</code></pre>"},{"location":"commands/branching/#merging-branches","title":"Merging Branches","text":""},{"location":"commands/branching/#manual-merge-current","title":"Manual Merge (Current)","text":"<pre><code># From feature branch\n$ dbl checkout feature-auth\n$ dbl log --oneline\nL008 Add OAuth\nL007 Add 2FA\nL006 Add sessions\n\n# Copy layers to main\n$ cp .dbl/layers/L007_* ../main-layers/\n$ cp .dbl/layers/L008_* ../main-layers/\n\n# Switch to main\n$ dbl checkout main\n$ mv ../main-layers/* .dbl/layers/\n$ dbl reset  # Replay with new layers\n</code></pre>"},{"location":"commands/branching/#auto-merge-future","title":"Auto-merge (Future)","text":"<pre><code># Planned feature\n$ dbl checkout main\n$ dbl merge feature-auth\n\nMerging feature-auth into main...\n  \u2192 L007 Add 2FA\n  \u2192 L008 Add OAuth\n\u2713 Merged successfully\n</code></pre>"},{"location":"commands/branching/#conflicts","title":"Conflicts","text":""},{"location":"commands/branching/#detecting-conflicts","title":"Detecting Conflicts","text":"<pre><code># When branches modify same tables\n$ dbl merge feature-auth\n\u26a0 Conflict detected:\n  Both branches modified table 'users'\n\n  main: Added column 'last_login'\n  feature-auth: Added column 'auth_token'\n\nResolve manually and commit.\n</code></pre>"},{"location":"commands/branching/#resolving-conflicts","title":"Resolving Conflicts","text":"<pre><code># 1. Review both changes\n$ dbl diff main\n$ dbl diff feature-auth\n\n# 2. Manually create unified layer\n$ nano .dbl/layers/L009_merge_auth.sql\n-- Add both columns\nALTER TABLE users ADD COLUMN last_login TIMESTAMP;\nALTER TABLE users ADD COLUMN auth_token TEXT;\n\n# 3. Commit merge\n$ dbl commit -m \"Merge: Add login tracking and auth\"\n</code></pre>"},{"location":"commands/branching/#best-practices","title":"Best Practices","text":""},{"location":"commands/branching/#naming-branches","title":"Naming Branches","text":"<pre><code># Good names\nfeature-user-authentication\nhotfix-email-validation\nexperiment-new-indexes\n\n# Bad names\nbranch1\ntest\ntemp\n</code></pre>"},{"location":"commands/branching/#branch-lifetime","title":"Branch Lifetime","text":"<ul> <li>Feature branches: Days to weeks</li> <li>Hotfix branches: Hours to days</li> <li>Experiment branches: Delete after evaluation</li> <li>Long-lived branches: Avoid (causes conflicts)</li> </ul>"},{"location":"commands/branching/#keep-branches-updated","title":"Keep Branches Updated","text":"<pre><code># Regularly sync with main\n$ dbl checkout feature-auth\n$ dbl merge main  # (future)\n\n# Or manual rebase\n$ dbl reset --from main\n</code></pre>"},{"location":"commands/branching/#advanced-usage","title":"Advanced Usage","text":""},{"location":"commands/branching/#branch-per-developer","title":"Branch Per Developer","text":"<pre><code># Alice\n$ dbl branch alice/feature-auth\n$ dbl checkout alice/feature-auth\n\n# Bob\n$ dbl branch bob/feature-payments\n$ dbl checkout bob/feature-payments\n</code></pre>"},{"location":"commands/branching/#release-branches","title":"Release Branches","text":"<pre><code># Create release branch\n$ dbl branch release-v1.5\n$ dbl checkout release-v1.5\n\n# Only critical fixes go here\n$ dbl commit -m \"Release: Version 1.5.0\"\n</code></pre>"},{"location":"commands/branching/#experiment-branches","title":"Experiment Branches","text":"<pre><code># Try something risky\n$ dbl branch experiment-new-schema\n$ dbl checkout experiment-new-schema\n\n# If it works, merge\n# If not, delete\n$ dbl branch -D experiment-new-schema\n</code></pre>"},{"location":"commands/branching/#state-management","title":"State Management","text":""},{"location":"commands/branching/#branch-state","title":"Branch State","text":"<p>Each branch tracks: - Layer sequence - Last applied layer - Sandbox state - Branch metadata</p> <pre><code># View branch info\n$ cat .dbl/branches/feature-auth.json\n{\n  \"name\": \"feature-auth\",\n  \"base\": \"main\",\n  \"created\": \"2024-12-30T10:00:00Z\",\n  \"layers\": [\"L001\", \"L002\", \"L007\", \"L008\"]\n}\n</code></pre>"},{"location":"commands/branching/#switching-impact","title":"Switching Impact","text":"<p>When switching branches: 1. Database state may change 2. Active sandboxes are preserved 3. Uncommitted changes carry over (\u26a0\ufe0f be careful)</p>"},{"location":"commands/branching/#see-also","title":"See Also","text":"<ul> <li>dbl branch - Create and list branches</li> <li>dbl checkout - Switch branches</li> <li>Best Practices - Branching strategies</li> </ul>"},{"location":"commands/changes/commit/","title":"dbl commit","text":"<p>Save database changes as a versioned layer.</p>"},{"location":"commands/changes/commit/#synopsis","title":"Synopsis","text":"<pre><code>dbl commit -m \"message\"\ndbl commit -m \"message\" --schema-only\n</code></pre>"},{"location":"commands/changes/commit/#description","title":"Description","text":"<p>Captures the current sandbox changes and saves them as a versioned layer (migration). This creates a SQL file that can be replayed to reproduce the changes.</p> <p>By default, both schema and data changes are included in commits. Use <code>--schema-only</code> to exclude data changes.</p>"},{"location":"commands/changes/commit/#options","title":"Options","text":"Option Description <code>-m, --message</code> Commit message (required) <code>--schema-only</code> Commit only schema changes (DDL), exclude data changes (DML)"},{"location":"commands/changes/commit/#what-it-does","title":"What It Does","text":"<ol> <li>Captures changes: Runs <code>diff</code> to detect all modifications</li> <li>Generates SQL: Creates migration SQL file with proper phases</li> <li>Creates layer: Assigns a layer ID (L001, L002, etc.)</li> <li>Updates manifest: Records layer metadata in branch history</li> <li>Saves to disk: Writes to <code>.dbl/layers/L###_description.sql</code></li> </ol>"},{"location":"commands/changes/commit/#usage-examples","title":"Usage Examples","text":""},{"location":"commands/changes/commit/#basic-commit-schema-data","title":"Basic Commit (Schema + Data)","text":"<pre><code># Make changes in sandbox\npsql -d myapp_sandbox -c \"\nCREATE TABLE notifications (\n    id SERIAL PRIMARY KEY,\n    user_id INTEGER NOT NULL,\n    message TEXT\n);\nINSERT INTO notifications (user_id, message) VALUES (1, 'Welcome!');\n\"\n\n# Commit changes (includes both schema and data by default)\ndbl commit -m \"Add notifications table with sample data\"\n</code></pre> <p>Output: <pre><code>\u2713 Changes detected via diff\n\u2713 Generated migration SQL (schema+data)\n\u2713 Created layer L001\n\u2713 Updated manifest\n\u2713 Saved: .dbl/layers/L001_add_notifications_table.sql\n\nLayer Details:\n  ID: L001\n  Message: Add notifications table with sample data\n  Type: schema+data\n  Branch: master\n  Timestamp: 2025-12-30 12:34:56\n  Phase: expand (safe additions)\n</code></pre></p>"},{"location":"commands/changes/commit/#schema-only-commit","title":"Schema-Only Commit","text":"<pre><code># Insert test data in sandbox\npsql -d myapp_sandbox -c \"\nALTER TABLE users ADD COLUMN phone VARCHAR(20);\nINSERT INTO users (username, email, phone) VALUES \n    ('testuser', 'test@example.com', '555-0100');\n\"\n\n# Commit only schema changes, ignore test data\ndbl commit -m \"Add phone column\" --schema-only\n</code></pre> <p>Generated SQL includes only: <pre><code>-- Add phone column\nALTER TABLE users ADD COLUMN phone VARCHAR(20);\n-- Data changes excluded (--schema-only flag)\n-- Phase: backfill (data changes)\nINSERT INTO users (username, email) VALUES \n    ('alice', 'alice@example.com'),\n    ('bob', 'bob@example.com');\n</code></pre></p>"},{"location":"commands/changes/commit/#generated-layer-file","title":"Generated Layer File","text":"<p>Example: <code>.dbl/layers/L001_add_notifications_table.sql</code></p> <pre><code>-- Layer: L001\n-- Message: Add notifications table\n-- Author: DBL\n-- Branch: master\n-- Date: 2025-12-30 12:34:56\n-- Parent: (none)\n\n-- =============================================================================\n-- Phase: expand (safe additions)\n-- =============================================================================\n\n-- New table: notifications\nCREATE TABLE IF NOT EXISTS notifications (\n    id SERIAL PRIMARY KEY,\n    user_id INTEGER NOT NULL,\n    message TEXT\n);\n\n-- Index for performance\nCREATE INDEX IF NOT EXISTS idx_notifications_user \nON notifications(user_id);\n\n-- =============================================================================\n-- Migration complete\n-- =============================================================================\n</code></pre>"},{"location":"commands/changes/commit/#migration-phases","title":"Migration Phases","text":"<p>DBL automatically categorizes changes into phases:</p>"},{"location":"commands/changes/commit/#expand-phase-safe","title":"Expand Phase (Safe)","text":"<pre><code>-- Phase: expand (safe additions)\nCREATE TABLE ...\nALTER TABLE ... ADD COLUMN ...\nCREATE INDEX ...\n</code></pre>"},{"location":"commands/changes/commit/#backfill-phase-data","title":"Backfill Phase (Data)","text":"<pre><code>-- Phase: backfill (data changes)\nINSERT INTO ...\nUPDATE ...\n</code></pre>"},{"location":"commands/changes/commit/#contract-phase-risky","title":"Contract Phase (Risky)","text":"<pre><code>-- Phase: contract (review required)\nALTER TABLE ... DROP COLUMN ...\nDROP TABLE ...\nALTER TABLE ... ALTER COLUMN ... SET NOT NULL\n</code></pre> <p>Contract Phase</p> <p>Contract changes are potentially destructive. Always review carefully!</p>"},{"location":"commands/changes/commit/#layer-naming","title":"Layer Naming","text":"<p>Layers are named automatically:</p> <pre><code>L{number}_{message_slug}.sql\n</code></pre> <p>Examples: - <code>L001_add_notifications_table.sql</code> - <code>L002_add_user_email_column.sql</code> - <code>L003_create_indexes_for_performance.sql</code></p>"},{"location":"commands/changes/commit/#complete-workflow-example","title":"Complete Workflow Example","text":"<pre><code># 1. Start sandbox\n$ dbl sandbox start\n\u2713 Sandbox created\n\n# 2. Make changes\n$ psql -d myapp_sandbox\nCREATE TABLE posts (\n    id SERIAL PRIMARY KEY,\n    title VARCHAR(255),\n    content TEXT,\n    author_id INTEGER REFERENCES users(id)\n);\n\nCREATE INDEX idx_posts_author ON posts(author_id);\n\n# 3. Review changes\n$ dbl diff\n+ CREATE TABLE posts (...)\n+ CREATE INDEX idx_posts_author ...\n\n# 4. Commit\n$ dbl commit -m \"Add posts table with author relationship\"\n\u2713 Layer L005 created\n\n# 5. Apply to main DB\n$ dbl sandbox apply\n\u2713 Applied to main database\n</code></pre>"},{"location":"commands/changes/commit/#commit-message-best-practices","title":"Commit Message Best Practices","text":""},{"location":"commands/changes/commit/#good-messages","title":"\u2705 Good Messages","text":"<pre><code>dbl commit -m \"Add user_preferences table\"\ndbl commit -m \"Add email_verified column to users\"\ndbl commit -m \"Create indexes for posts query performance\"\ndbl commit -m \"Migrate status column from string to enum\"\n</code></pre>"},{"location":"commands/changes/commit/#poor-messages","title":"\u274c Poor Messages","text":"<pre><code>dbl commit -m \"changes\"\ndbl commit -m \"update\"\ndbl commit -m \"fix\"\ndbl commit -m \"wip\"\n</code></pre>"},{"location":"commands/changes/commit/#message-convention","title":"Message Convention","text":"<p>Use imperative mood: <pre><code># Good\n\"Add notifications table\"\n\"Update user schema\"\n\"Remove deprecated columns\"\n\n# Not\n\"Added notifications table\"\n\"Updates user schema\"\n\"Removed deprecated columns\"\n</code></pre></p>"},{"location":"commands/changes/commit/#data-commits","title":"Data Commits","text":""},{"location":"commands/changes/commit/#when-to-use-with-data","title":"When to Use <code>--with-data</code>","text":"<p>\u2705 Use for: - Reference/seed data - Lookup tables - Configuration data - Test fixtures</p> <p>\u274c Don't use for: - User data - Production data - Large datasets - Sensitive information</p>"},{"location":"commands/changes/commit/#example-seed-data","title":"Example: Seed Data","text":"<pre><code># Add seed data\npsql -d myapp_sandbox -c \"\nINSERT INTO roles (name, permissions) VALUES \n    ('admin', '{\"all\": true}'),\n    ('user', '{\"read\": true}'),\n    ('guest', '{\"read_public\": true}');\n\"\n\n# Commit with data\ndbl commit -m \"Add default roles\" --with-data\n</code></pre>"},{"location":"commands/changes/commit/#configuration","title":"Configuration","text":"<p>Control commit behavior in <code>dbl.yaml</code>:</p> <pre><code># Require sandbox for commits\npolicies:\n  require_sandbox: true    # Default: true\n  allow_data_loss: false   # Prevent DROP operations\n\n# Validation rules\nvalidate:\n  strict: false              # Treat warnings as errors\n  require_comments: true     # Require comments for contract phase\n  detect_type_changes: true  # Warn about type changes\n</code></pre>"},{"location":"commands/changes/commit/#metadata","title":"Metadata","text":"<p>Each layer stores metadata:</p> <pre><code>{\n  \"layer_id\": \"L001\",\n  \"message\": \"Add notifications table\",\n  \"timestamp\": \"2025-12-30T12:34:56Z\",\n  \"branch\": \"master\",\n  \"parent\": null,\n  \"phase\": \"expand\",\n  \"author\": \"DBL\",\n  \"sha256\": \"abc123...\"\n}\n</code></pre>"},{"location":"commands/changes/commit/#important-notes","title":"Important Notes","text":"<p>Requires Active Sandbox</p> <p>You must have an active sandbox to commit. This is a safety feature.</p> <p>Review Before Commit</p> <p>Always run <code>dbl diff</code> first to review what you're committing.</p> <p>Cannot Uncommit</p> <p>Once committed, layers are permanent. You can reset or create new layers, but you cannot delete or modify existing ones.</p>"},{"location":"commands/changes/commit/#common-issues","title":"Common Issues","text":""},{"location":"commands/changes/commit/#no-active-sandbox","title":"No Active Sandbox","text":"<p>Error: <pre><code>Error: No active sandbox found\nRun 'dbl sandbox start' first\n</code></pre></p> <p>Solution: <pre><code>dbl sandbox start\n</code></pre></p>"},{"location":"commands/changes/commit/#no-changes-to-commit","title":"No Changes to Commit","text":"<p>Error: <pre><code>No changes detected\nNothing to commit\n</code></pre></p> <p>Solution: - Ensure you made changes in the sandbox database - Run <code>dbl diff</code> to see if changes are detected - Check that you're connected to the correct database</p>"},{"location":"commands/changes/commit/#message-required","title":"Message Required","text":"<p>Error: <pre><code>Error: Commit message required\nUsage: dbl commit -m \"message\"\n</code></pre></p> <p>Solution: <pre><code>dbl commit -m \"Your commit message here\"\n</code></pre></p>"},{"location":"commands/changes/commit/#data-changes-without-flag","title":"Data Changes Without Flag","text":"<p>If you have data changes but didn't use <code>--with-data</code>:</p> <pre><code>\u26a0\ufe0f  Data changes detected but not included\nUse --with-data flag to include INSERT/UPDATE statements\n</code></pre> <p>Solution: <pre><code>dbl commit -m \"message\" --with-data\n</code></pre></p>"},{"location":"commands/changes/commit/#after-committing","title":"After Committing","text":"<p>Once you commit, you typically:</p> <ol> <li> <p>Review the generated SQL:    <pre><code>cat .dbl/layers/L001_*.sql\n</code></pre></p> </li> <li> <p>Test in sandbox (if needed):</p> </li> <li>Sandbox still exists after commit</li> <li> <p>You can make more changes and commit again</p> </li> <li> <p>Apply to main database:    <pre><code>dbl sandbox apply\n</code></pre></p> </li> <li> <p>Or discard and try again:    <pre><code>dbl sandbox rollback\n</code></pre></p> </li> </ol>"},{"location":"commands/changes/commit/#branching","title":"Branching","text":"<p>Commits are associated with your current branch:</p> <pre><code># Create feature branch\ndbl branch feature-comments\ndbl checkout feature-comments\n\n# Work on feature\ndbl sandbox start\n# ... make changes ...\ndbl commit -m \"Add comments feature\"\n\n# Commits appear in branch history\ndbl log\n</code></pre>"},{"location":"commands/changes/commit/#version-control","title":"Version Control","text":"<p>Should you commit layer files to git?</p> <p>It depends:</p> <p>\u2705 Commit to git if: - Team collaboration needed - Want migration history in repo - Using DBL as migration tool</p> <p>\u274c Don't commit if: - Using other migration tools - DBL is just for local development - Sensitive data in migrations</p>"},{"location":"commands/changes/commit/#next-steps","title":"Next Steps","text":"<p>After committing:</p> <ul> <li>Apply changes to main database</li> <li>View history of commits</li> <li>Validate patterns</li> <li>Reset database from layers</li> </ul>"},{"location":"commands/changes/commit/#see-also","title":"See Also","text":"<ul> <li><code>dbl diff</code> - Review changes before commit</li> <li><code>dbl sandbox apply</code> - Apply committed changes</li> <li><code>dbl log</code> - View commit history</li> <li><code>dbl validate</code> - Validate migrations</li> </ul>"},{"location":"commands/changes/diff/","title":"dbl diff","text":"<p>Detect and display database changes in your sandbox.</p>"},{"location":"commands/changes/diff/#synopsis","title":"Synopsis","text":"<pre><code>dbl diff [--tables TABLE1 TABLE2 ...]\n</code></pre>"},{"location":"commands/changes/diff/#description","title":"Description","text":"<p>Compares the current sandbox database against the baseline state to detect all schema and data changes. This command is essential for reviewing what will be committed before you save changes as a layer.</p>"},{"location":"commands/changes/diff/#options","title":"Options","text":"Option Description <code>--tables TABLE1 TABLE2 ...</code> Check only specific tables instead of all tracked tables"},{"location":"commands/changes/diff/#exit-codes","title":"Exit Codes","text":"Code Meaning Use Case <code>0</code> No changes detected CI/CD validation <code>1</code> Changes detected Normal workflow <p>CI/CD Integration</p> <p>Use exit codes in scripts to detect uncommitted changes: <pre><code>dbl diff\nif [ $? -eq 1 ]; then\n  echo \"Uncommitted changes detected!\"\nfi\n</code></pre></p>"},{"location":"commands/changes/diff/#what-it-detects","title":"What It Detects","text":""},{"location":"commands/changes/diff/#schema-changes","title":"Schema Changes","text":"<ul> <li>\u2705 New tables</li> <li>\u2705 Dropped tables</li> <li>\u2705 New columns</li> <li>\u2705 Dropped columns</li> <li>\u2705 Column type changes</li> <li>\u2705 Constraint changes (PRIMARY KEY, FOREIGN KEY, UNIQUE, CHECK)</li> <li>\u2705 Index changes</li> <li>\u2705 Default value changes</li> </ul>"},{"location":"commands/changes/diff/#data-changes-when-tracking-tables","title":"Data Changes (When Tracking Tables)","text":"<ul> <li>\u2705 Inserted rows</li> <li>\u2705 Updated rows</li> <li>\u2705 Deleted rows</li> </ul> <p>Data Tracking</p> <p>Data changes are only shown for tables listed in <code>track_tables</code> configuration.</p>"},{"location":"commands/changes/diff/#usage-example","title":"Usage Example","text":"<pre><code># Make some changes in your sandbox\npsql -d myapp_sandbox -c \"\nCREATE TABLE notifications (\n    id SERIAL PRIMARY KEY,\n    user_id INTEGER NOT NULL,\n    message TEXT,\n    read BOOLEAN DEFAULT false\n);\n\nALTER TABLE users ADD COLUMN email_verified BOOLEAN DEFAULT false;\n\"\n\n# Review changes\ndbl diff\n</code></pre> <p>Output: <pre><code>-- Schema changes detected:\n\n+ CREATE TABLE notifications (\n+     id SERIAL PRIMARY KEY,\n+     user_id INTEGER NOT NULL,\n+     message TEXT,\n+     read BOOLEAN DEFAULT false\n+ );\n\n+ ALTER TABLE users \n+   ADD COLUMN email_verified BOOLEAN DEFAULT false;\n\nSummary:\n  Tables added: 1 (notifications)\n  Columns added: 1 (users.email_verified)\n\nChanges detected: 2 schema modifications\nExit code: 1\n</code></pre></p>"},{"location":"commands/changes/diff/#check-specific-tables-only","title":"Check Specific Tables Only","text":"<pre><code># Only check the 'users' table for changes\ndbl diff --tables users\n\n# Check multiple specific tables\ndbl diff --tables users posts comments\n\n# Useful for large databases with many tables\ndbl diff --tables orders order_items payments\n</code></pre> <p>Output with <code>--tables</code>: <pre><code>\ud83d\udd0d Filtering 1 specific tables: users\n\u2139\ufe0f  Analyzing state of: myapp_sandbox...\n\u2139\ufe0f     Schema: 325 tables | Tracking: 1 tables\n\u23f3 [\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588] 100% (1/1) tables - users\n   \u2713 Tracked: 1 tables successfully\n\n\ud83d\udd34 DATA CHANGE: users\n   Current:  abc123ef...\n   Baseline: def456gh...\n</code></pre></p>"},{"location":"commands/changes/diff/#detailed-output","title":"Detailed Output","text":"<p>For more verbose output:</p> <pre><code>dbl diff --verbose  # (if implemented)\n</code></pre>"},{"location":"commands/changes/diff/#filtering-output","title":"Filtering Output","text":"<p>Check specific tables only (via <code>track_tables</code> in <code>dbl.yaml</code>):</p> <pre><code>track_tables:\n  - users\n  - posts\n  - comments\n</code></pre> <p>Performance Optimization</p> <p>For databases with hundreds of tables, use <code>--tables</code> to check only relevant tables: <pre><code># Much faster than scanning all 500+ tables\ndbl diff --tables critical_table\n</code></pre></p>"},{"location":"commands/changes/diff/#complete-example","title":"Complete Example","text":""},{"location":"commands/changes/diff/#scenario-add-user-profiles","title":"Scenario: Add User Profiles","text":"<pre><code># 1. Start sandbox\n$ dbl sandbox start\n\u2713 Sandbox created\n\n# 2. Make changes\n$ psql -d myapp_sandbox\nmyapp_sandbox=# CREATE TABLE user_profiles (\n    user_id INTEGER PRIMARY KEY REFERENCES users(id),\n    bio TEXT,\n    avatar_url VARCHAR(255),\n    location VARCHAR(100)\n);\nCREATE TABLE\n\nmyapp_sandbox=# CREATE INDEX idx_profiles_location ON user_profiles(location);\nCREATE INDEX\n\n# 3. Review changes\n$ dbl diff\n\n+ CREATE TABLE user_profiles (\n+     user_id INTEGER PRIMARY KEY REFERENCES users(id),\n+     bio TEXT,\n+     avatar_url VARCHAR(255),\n+     location VARCHAR(100)\n+ );\n\n+ CREATE INDEX idx_profiles_location ON user_profiles(location);\n\nSummary:\n  Tables added: 1\n  Indexes added: 1\n\nExit code: 1\n\n# 4. If satisfied, commit\n$ dbl commit -m \"Add user profiles table\"\n</code></pre>"},{"location":"commands/changes/diff/#data-changes-example","title":"Data Changes Example","text":"<p>With <code>track_tables</code> configured:</p> <pre><code># dbl.yaml\ntrack_tables:\n  - users\n</code></pre> <pre><code># Insert test data\n$ psql -d myapp_sandbox -c \"\nINSERT INTO users (username, email) VALUES \n    ('alice', 'alice@example.com'),\n    ('bob', 'bob@example.com');\n\"\n\n# See data changes\n$ dbl diff\n</code></pre> <p>Output: <pre><code>-- Data changes for tracked tables:\n\nTable: users\n+ INSERT INTO users (id, username, email) VALUES \n+   (1, 'alice', 'alice@example.com'),\n+   (2, 'bob', 'bob@example.com');\n\nSummary:\n  Rows inserted: 2 (users)\n\nExit code: 1\n</code></pre></p>"},{"location":"commands/changes/diff/#cicd-pipeline-example","title":"CI/CD Pipeline Example","text":"<p>Detect uncommitted schema changes:</p> <pre><code># .github/workflows/check-schema.yml\nname: Check Schema Changes\n\non: [pull_request]\n\njobs:\n  check:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v2\n\n      - name: Setup database\n        run: |\n          # Start test database\n          docker run -d -p 5432:5432 postgres:15\n\n      - name: Check for uncommitted changes\n        run: |\n          dbl init\n          dbl sandbox start\n\n          # Run migrations\n          psql -f migrations/*.sql\n\n          # Check diff\n          dbl diff\n          if [ $? -eq 1 ]; then\n            echo \"\u274c Schema changes detected but not committed!\"\n            echo \"Run 'dbl commit' to save these changes.\"\n            exit 1\n          else\n            echo \"\u2705 No uncommitted changes\"\n          fi\n</code></pre>"},{"location":"commands/changes/diff/#understanding-the-output","title":"Understanding the Output","text":""},{"location":"commands/changes/diff/#new-table","title":"New Table","text":"<pre><code>+ CREATE TABLE table_name (\n+     column1 TYPE,\n+     column2 TYPE\n+ );\n</code></pre>"},{"location":"commands/changes/diff/#new-column","title":"New Column","text":"<pre><code>+ ALTER TABLE table_name \n+   ADD COLUMN column_name TYPE;\n</code></pre>"},{"location":"commands/changes/diff/#dropped-column","title":"Dropped Column","text":"<pre><code>- ALTER TABLE table_name \n-   DROP COLUMN column_name;\n</code></pre>"},{"location":"commands/changes/diff/#type-change","title":"Type Change","text":"<pre><code>~ ALTER TABLE table_name \n~   ALTER COLUMN column_name TYPE new_type;\n</code></pre>"},{"location":"commands/changes/diff/#new-index","title":"New Index","text":"<pre><code>+ CREATE INDEX index_name ON table_name(column);\n</code></pre>"},{"location":"commands/changes/diff/#new-constraint","title":"New Constraint","text":"<pre><code>+ ALTER TABLE table_name \n+   ADD CONSTRAINT constraint_name FOREIGN KEY (col) REFERENCES other(id);\n</code></pre>"},{"location":"commands/changes/diff/#important-notes","title":"Important Notes","text":"<p>Requires Active Sandbox</p> <p><code>dbl diff</code> only works when a sandbox is active. Run <code>dbl sandbox start</code> first.</p> <p>Baseline Comparison</p> <p>Changes are compared against the state captured when the sandbox was created, not the last commit.</p> <p>Review Before Commit</p> <p>Always run <code>dbl diff</code> before <code>dbl commit</code> to understand what will be saved.</p>"},{"location":"commands/changes/diff/#common-issues","title":"Common Issues","text":""},{"location":"commands/changes/diff/#no-sandbox-active","title":"No Sandbox Active","text":"<p>Error: <pre><code>Error: No active sandbox found\n</code></pre></p> <p>Solution: <pre><code>dbl sandbox start\n</code></pre></p>"},{"location":"commands/changes/diff/#no-changes-detected","title":"No Changes Detected","text":"<p>If you made changes but diff shows nothing:</p> <ol> <li> <p>Check you're in the sandbox: <pre><code>dbl sandbox status\n</code></pre></p> </li> <li> <p>Verify changes were applied: <pre><code>psql -d your_database_sandbox -c \"\\dt\"  # List tables\n</code></pre></p> </li> <li> <p>Check table tracking:</p> </li> <li>Data changes require <code>track_tables</code> configuration</li> </ol>"},{"location":"commands/changes/diff/#diff-shows-unexpected-changes","title":"Diff Shows Unexpected Changes","text":"<p>If diff shows changes you didn't make:</p> <ul> <li>System tables: Add them to <code>ignore_tables</code> in <code>dbl.yaml</code></li> <li>Auto-generated objects: Some extensions create objects automatically</li> </ul> <pre><code>ignore_tables:\n  - pg_stat_statements\n  - sessions\n  - _prisma_migrations\n</code></pre>"},{"location":"commands/changes/diff/#performance-considerations","title":"Performance Considerations","text":"<p>For large databases:</p> <ul> <li>Schema diff: Fast (metadata only)</li> <li>Data diff: Slower (requires full table comparison)</li> </ul> <p>Optimize: <pre><code># Only track tables you need\ntrack_tables:\n  - critical_table1\n  - critical_table2\n\n# Ignore large tables\nignore_tables:\n  - audit_logs\n  - analytics_events\n</code></pre></p>"},{"location":"commands/changes/diff/#next-steps","title":"Next Steps","text":"<p>After reviewing diff:</p> <ol> <li>If satisfied \u2192 <code>dbl commit</code></li> <li>If not satisfied \u2192 Make more changes and <code>dbl diff</code> again</li> <li>If want to discard \u2192 <code>dbl sandbox rollback</code></li> </ol>"},{"location":"commands/changes/diff/#see-also","title":"See Also","text":"<ul> <li><code>dbl commit</code> - Save changes as a layer</li> <li><code>dbl sandbox start</code> - Create sandbox</li> <li><code>dbl sandbox rollback</code> - Discard changes</li> <li>Configuration Guide - Configure table tracking</li> </ul>"},{"location":"commands/changes/reset/","title":"dbl reset","text":"<p>Rebuild the database from scratch using committed layers.</p>"},{"location":"commands/changes/reset/#synopsis","title":"Synopsis","text":"<pre><code>dbl reset                  # Reset current database\ndbl reset --hard           # Force reset, ignore errors\ndbl reset --to L005        # Reset to specific layer\n</code></pre>"},{"location":"commands/changes/reset/#description","title":"Description","text":"<p>Drops and recreates the database, then replays all committed layers in order. This is useful for:</p> <ul> <li>Testing that migrations are reproducible</li> <li>Recovering from manual errors</li> <li>Creating clean database from layer history</li> <li>Verifying layer sequence integrity</li> </ul>"},{"location":"commands/changes/reset/#options","title":"Options","text":"Option Description <code>--hard</code> Force reset, continue even on errors <code>--to L00X</code> Stop at specific layer (don't apply later layers)"},{"location":"commands/changes/reset/#what-it-does","title":"What It Does","text":"<ol> <li>Drops database - Removes existing database completely</li> <li>Recreates database - Creates fresh empty database</li> <li>Replays layers - Applies committed layers in order (L001, L002, ...)</li> <li>Updates state - Marks layers as applied</li> </ol>"},{"location":"commands/changes/reset/#usage-examples","title":"Usage Examples","text":""},{"location":"commands/changes/reset/#basic-reset","title":"Basic Reset","text":"<pre><code>dbl reset\n</code></pre> <p>Output: <pre><code>\u26a0\ufe0f  Warning: This will DROP and RECREATE the database 'myapp'\nAll data will be lost. Only committed layers will be replayed.\n\nAre you sure? (y/n): y\n\nDropping database myapp...\n\u2713 Database dropped\n\nCreating database myapp...\n\u2713 Database created\n\nReplaying layers:\n  \u2192 L001_initial_schema.sql\n  \u2192 L002_add_users.sql\n  \u2192 L003_add_posts.sql\n  \u2192 L004_add_indexes.sql\n  \u2192 L005_add_comments.sql\n\n\u2713 Reset complete\n\u2713 5 layers applied\nDatabase myapp is now at layer L005\n</code></pre></p>"},{"location":"commands/changes/reset/#reset-to-specific-layer","title":"Reset to Specific Layer","text":"<pre><code>dbl reset --to L003\n</code></pre> <p>Output: <pre><code>Resetting to layer L003...\n\nDropping database myapp...\nCreating database myapp...\n\nReplaying layers:\n  \u2192 L001_initial_schema.sql\n  \u2192 L002_add_users.sql\n  \u2192 L003_add_posts.sql\n\n\u2713 Reset complete (stopped at L003)\nLayers L004 and L005 were NOT applied\n</code></pre></p>"},{"location":"commands/changes/reset/#force-reset","title":"Force Reset","text":"<pre><code>dbl reset --hard\n</code></pre> <p>Output: <pre><code>Force reset enabled (--hard)\n\nDropping database myapp...\nCreating database myapp...\n\nReplaying layers:\n  \u2192 L001_initial_schema.sql \u2713\n  \u2192 L002_add_users.sql \u2717 Error: column already exists\n    (continuing due to --hard)\n  \u2192 L003_add_posts.sql \u2713\n\n\u26a0\ufe0f  Reset completed with 1 error\nCheck layer L002 for issues\n</code></pre></p>"},{"location":"commands/changes/reset/#complete-examples","title":"Complete Examples","text":""},{"location":"commands/changes/reset/#test-migration-reproducibility","title":"Test Migration Reproducibility","text":"<pre><code># Current state\n$ dbl log\n* L005 - Add comments\n* L004 - Add indexes\n* L003 - Add posts\n* L002 - Add users\n* L001 - Initial schema\n\n# Reset to verify all layers replay correctly\n$ dbl reset\n\nDropping database myapp...\nCreating database myapp...\nReplaying layers:\n  \u2192 L001 \u2713\n  \u2192 L002 \u2713\n  \u2192 L003 \u2713\n  \u2192 L004 \u2713\n  \u2192 L005 \u2713\n\n\u2713 All layers replayed successfully\n\n# Verify final state\n$ psql -d myapp -c \"\\dt\"\n         List of relations\n Schema |      Name       | Type  \n--------+-----------------+-------\n public | users           | table\n public | posts           | table\n public | comments        | table\n\n# Schema matches expected state!\n</code></pre>"},{"location":"commands/changes/reset/#recover-from-manual-changes","title":"Recover from Manual Changes","text":"<pre><code># Accidentally modified database directly\n$ psql -d myapp\nmyapp=# DROP TABLE users;  -- Oops!\n\n# Recover by resetting\n$ dbl reset\n\nDropping database myapp...\nCreating database myapp...\nReplaying layers...\n\u2713 Reset complete\n\n# Database restored from layers\n</code></pre>"},{"location":"commands/changes/reset/#test-partial-history","title":"Test Partial History","text":"<pre><code># Test up to specific point\n$ dbl reset --to L003\n\nReplaying layers:\n  \u2192 L001_initial_schema\n  \u2192 L002_add_users\n  \u2192 L003_add_posts\n\nDatabase now at L003\n\n# App testing at this state\n$ ./run-tests.sh\n\n# Continue to next layer\n$ dbl reset --to L004\n</code></pre>"},{"location":"commands/changes/reset/#cicd-testing","title":"CI/CD Testing","text":"<pre><code># .github/workflows/test-migrations.yml\nname: Test Migrations\n\non: [push, pull_request]\n\njobs:\n  test:\n    runs-on: ubuntu-latest\n    services:\n      postgres:\n        image: postgres:14\n        env:\n          POSTGRES_PASSWORD: postgres\n        options: &gt;-\n          --health-cmd pg_isready\n          --health-interval 10s\n\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Install DBL\n        run: pip install git+https://github.com/...\n\n      - name: Initialize\n        run: dbl init\n\n      - name: Test full replay\n        run: dbl reset\n\n      - name: Verify schema\n        run: |\n          dbl reset\n          ./verify-schema.sh\n\n      - name: Test incremental\n        run: |\n          for layer in L001 L002 L003; do\n            dbl reset --to $layer\n            ./test-at-layer.sh $layer\n          done\n</code></pre>"},{"location":"commands/changes/reset/#safety-features","title":"Safety Features","text":""},{"location":"commands/changes/reset/#confirmation-prompt","title":"Confirmation Prompt","text":"<p>By default, <code>reset</code> requires confirmation:</p> <pre><code>$ dbl reset\n\u26a0\ufe0f  Warning: This will DROP and RECREATE the database\nAll data will be lost.\nAre you sure? (y/n): \n</code></pre> <p>Skip with <code>--yes</code>:</p> <pre><code>dbl reset --yes  # No prompt\n</code></pre>"},{"location":"commands/changes/reset/#backup-recommendation","title":"Backup Recommendation","text":"<pre><code># Always backup before reset in production\n$ pg_dump myapp &gt; backup_$(date +%Y%m%d).sql\n$ dbl reset\n</code></pre>"},{"location":"commands/changes/reset/#what-gets-deleted","title":"What Gets Deleted","text":""},{"location":"commands/changes/reset/#deleted","title":"Deleted:","text":"<ul> <li>\u274c Entire database</li> <li>\u274c All tables</li> <li>\u274c All data</li> <li>\u274c All indexes, views, functions</li> <li>\u274c Manual changes not in layers</li> </ul>"},{"location":"commands/changes/reset/#preserved","title":"Preserved:","text":"<ul> <li>\u2705 Layer files (<code>.dbl/layers/</code>)</li> <li>\u2705 DBL metadata</li> <li>\u2705 Branches</li> <li>\u2705 Configuration</li> </ul>"},{"location":"commands/changes/reset/#use-cases","title":"Use Cases","text":""},{"location":"commands/changes/reset/#development","title":"Development","text":"<pre><code># Clean slate for testing\ndbl reset\n</code></pre>"},{"location":"commands/changes/reset/#testing","title":"Testing","text":"<pre><code># Verify migrations work\ndbl reset &amp;&amp; ./run-tests.sh\n</code></pre>"},{"location":"commands/changes/reset/#production-deploy-caution","title":"Production Deploy (Caution!)","text":"<pre><code># In staging first\ndbl --config staging.yaml reset\n./verify-schema.sh\n\n# Then production (during maintenance)\npg_dump production &gt; backup.sql\ndbl --config production.yaml reset\n</code></pre>"},{"location":"commands/changes/reset/#debugging-layers","title":"Debugging Layers","text":"<pre><code># Find which layer breaks\nfor i in {1..10}; do\n    echo \"Testing up to L00$i\"\n    dbl reset --to L00$i || break\ndone\n</code></pre>"},{"location":"commands/changes/reset/#performance","title":"Performance","text":"<p>Reset speed depends on: - Number of layers: More layers = slower - Layer complexity: Complex SQL = slower - Database size: Dropping large DB takes time</p>"},{"location":"commands/changes/reset/#optimization","title":"Optimization","text":"<pre><code># Combine small layers\n# Instead of:\nL001: CREATE TABLE users\nL002: CREATE TABLE posts\nL003: CREATE TABLE comments\n\n# Better:\nL001: CREATE TABLE users; CREATE TABLE posts; CREATE TABLE comments;\n</code></pre>"},{"location":"commands/changes/reset/#error-handling","title":"Error Handling","text":""},{"location":"commands/changes/reset/#layer-fails-to-apply","title":"Layer Fails to Apply","text":"<p>Error: <pre><code>Replaying layers:\n  \u2192 L001 \u2713\n  \u2192 L002 \u2717 ERROR: relation \"users\" already exists\n\nReset failed at layer L002\n</code></pre></p> <p>Solution: <pre><code># Check layer SQL\ncat .dbl/layers/L002_*.sql\n\n# Fix the layer\n# Then try again\ndbl reset\n</code></pre></p>"},{"location":"commands/changes/reset/#database-connection-lost","title":"Database Connection Lost","text":"<p>Error: <pre><code>Error: Lost connection during reset\nDatabase may be in incomplete state\n</code></pre></p> <p>Solution: <pre><code># Database was dropped but not fully recreated\n# Run reset again\ndbl reset\n\n# Or manually cleanup and retry\ndropdb myapp\ncreatedb myapp\ndbl reset\n</code></pre></p>"},{"location":"commands/changes/reset/#permission-denied","title":"Permission Denied","text":"<p>Error: <pre><code>Error: Permission denied to drop database\n</code></pre></p> <p>Solution: <pre><code>-- Grant database creation/drop permissions\nALTER USER myuser WITH CREATEDB;\n\n-- Or use superuser\nsudo -u postgres psql\nALTER USER myuser WITH SUPERUSER;\n</code></pre></p>"},{"location":"commands/changes/reset/#important-notes","title":"Important Notes","text":"<p>Data Loss</p> <p><code>dbl reset</code> permanently deletes all data in the database. Only use in development or after backing up.</p> <p>Production Use</p> <p>Never run <code>reset</code> on production without: 1. Maintenance window 2. Complete backup 3. Tested in staging 4. Team approval</p> <p>Test Often</p> <p>Reset frequently in development to ensure layers are reproducible.</p>"},{"location":"commands/changes/reset/#comparison-with-other-commands","title":"Comparison with Other Commands","text":"Command Effect Data Loss Use When <code>reset</code> Rebuild from layers Yes Testing, recovery <code>sandbox apply</code> Apply sandbox to main No Normal development <code>sandbox rollback</code> Delete sandbox Sandbox only Discard experiment"},{"location":"commands/changes/reset/#advanced-usage","title":"Advanced Usage","text":""},{"location":"commands/changes/reset/#automated-testing","title":"Automated Testing","text":"<pre><code>#!/bin/bash\n# test-migrations.sh\n\nLAYERS=$(ls .dbl/layers/ | grep -oE 'L[0-9]+' | sort -u)\n\nfor layer in $LAYERS; do\n    echo \"Testing up to $layer...\"\n    dbl reset --to $layer --yes\n\n    if ! ./verify-schema.sh $layer; then\n        echo \"FAILED at $layer\"\n        exit 1\n    fi\ndone\n\necho \"All layers verified!\"\n</code></pre>"},{"location":"commands/changes/reset/#reset-with-seed-data","title":"Reset with Seed Data","text":"<pre><code># After reset, load seed data\ndbl reset --yes\n\n# Load fixtures\npsql -d myapp -f fixtures/seed_users.sql\npsql -d myapp -f fixtures/seed_posts.sql\n</code></pre>"},{"location":"commands/changes/reset/#branch-switching","title":"Branch Switching","text":"<pre><code># Switch branches and reset to that branch's state\ndbl checkout feature-xyz\ndbl reset\n\n# Now database matches feature-xyz layers\n</code></pre>"},{"location":"commands/changes/reset/#partial-reset-future","title":"Partial Reset (Future)","text":"<pre><code># Drop specific schemas only (future feature)\ndbl reset --schema public\n\n# Reset specific tables (future feature)\ndbl reset --tables users,posts\n</code></pre>"},{"location":"commands/changes/reset/#recovery-strategies","title":"Recovery Strategies","text":""},{"location":"commands/changes/reset/#if-reset-fails","title":"If Reset Fails","text":"<ol> <li>Check logs: Review error messages</li> <li>Verify layer SQL: Ensure SQL is valid</li> <li>Test layer manually: Run SQL directly</li> <li>Fix layer: Edit layer file</li> <li>Retry reset: Run <code>dbl reset</code> again</li> </ol>"},{"location":"commands/changes/reset/#if-database-corrupted","title":"If Database Corrupted","text":"<pre><code># Manual cleanup\ndropdb myapp\ncreatedb myapp\n\n# Re-init DBL\ndbl init\n\n# Reset\ndbl reset\n</code></pre>"},{"location":"commands/changes/reset/#see-also","title":"See Also","text":"<ul> <li><code>dbl commit</code> - Create layers</li> <li><code>dbl log</code> - View layers</li> <li><code>dbl branch</code> - Manage branches</li> <li><code>dbl sandbox apply</code> - Apply sandbox changes</li> <li>Best Practices - Reset guidelines</li> </ul>"},{"location":"commands/history/log/","title":"dbl log","text":"<p>Display the history of committed layers.</p>"},{"location":"commands/history/log/#synopsis","title":"Synopsis","text":"<pre><code>dbl log                    # Show all layers\ndbl log -n 10              # Show last 10 layers\ndbl log --oneline          # Compact format\ndbl log L003..L007         # Show range\ndbl log --branch main      # Show specific branch\n</code></pre>"},{"location":"commands/history/log/#description","title":"Description","text":"<p>Shows the chronological history of database changes (layers) with commit messages, timestamps, authors, and layer IDs.</p>"},{"location":"commands/history/log/#options","title":"Options","text":"Option Description <code>-n, --max-count N</code> Limit output to N entries <code>--oneline</code> Show each layer on a single line <code>--branch NAME</code> Show layers for specific branch <code>--all</code> Show layers from all branches <code>L001..L005</code> Show specific range of layers"},{"location":"commands/history/log/#usage-examples","title":"Usage Examples","text":""},{"location":"commands/history/log/#basic-log","title":"Basic Log","text":"<pre><code>dbl log\n</code></pre> <p>Output: <pre><code>* L005 - Add comments feature\n  Date: 2024-12-30 14:32:11\n  Branch: main\n\n  Added comments table with foreign keys to posts and users.\n  Includes indexes for common queries.\n\n* L004 - Add search indexes\n  Date: 2024-12-30 12:15:33\n  Branch: main\n\n  Added GIN indexes for full-text search on posts and users.\n\n* L003 - Add posts table\n  Date: 2024-12-29 16:45:22\n  Branch: main\n\n  Created posts table with author reference.\n\n* L002 - Add users table\n  Date: 2024-12-29 10:20:15\n  Branch: main\n\n  Basic user table with authentication fields.\n\n* L001 - Initial schema\n  Date: 2024-12-28 09:00:00\n  Branch: main\n\n  Database initialization.\n</code></pre></p>"},{"location":"commands/history/log/#compact-format","title":"Compact Format","text":"<pre><code>dbl log --oneline\n</code></pre> <p>Output: <pre><code>L005 Add comments feature\nL004 Add search indexes\nL003 Add posts table\nL002 Add users table\nL001 Initial schema\n</code></pre></p>"},{"location":"commands/history/log/#last-n-entries","title":"Last N Entries","text":"<pre><code>dbl log -n 3\n</code></pre> <p>Output: <pre><code>* L005 - Add comments feature (2024-12-30 14:32:11)\n* L004 - Add search indexes (2024-12-30 12:15:33)\n* L003 - Add posts table (2024-12-29 16:45:22)\n</code></pre></p>"},{"location":"commands/history/log/#specific-range","title":"Specific Range","text":"<pre><code>dbl log L002..L004\n</code></pre> <p>Output: <pre><code>* L004 - Add search indexes\n* L003 - Add posts table\n* L002 - Add users table\n</code></pre></p>"},{"location":"commands/history/log/#output-format","title":"Output Format","text":""},{"location":"commands/history/log/#full-format","title":"Full Format","text":"<pre><code>* L005 - Add comments feature\n  Date: 2024-12-30 14:32:11\n  Author: john@example.com\n  Branch: main\n  Files: .dbl/layers/L005_add_comments_feature.sql\n\n  Added comments table with foreign keys to posts and users.\n  Includes indexes for common queries.\n\n  Tables added: comments\n  Indexes added: 2\n</code></pre>"},{"location":"commands/history/log/#oneline-format","title":"Oneline Format","text":"<pre><code>L005 Add comments feature\n</code></pre>"},{"location":"commands/history/log/#graph-format-future","title":"Graph Format (future)","text":"<pre><code>dbl log --graph\n</code></pre> <p>Output: <pre><code>* L008 - Merge feature-auth (main)\n|\\\n| * L007 - Add session tracking (feature-auth)\n| * L006 - Add auth tokens (feature-auth)\n|/\n* L005 - Add comments (main)\n* L004 - Add indexes (main)\n</code></pre></p>"},{"location":"commands/history/log/#complete-examples","title":"Complete Examples","text":""},{"location":"commands/history/log/#review-recent-work","title":"Review Recent Work","text":"<pre><code># What did we do today?\n$ dbl log -n 5\n\n* L015 - Add webhooks system\n  Date: 2024-12-30 15:45:00\n\n* L014 - Add notification preferences\n  Date: 2024-12-30 14:20:33\n\n* L013 - Add email templates\n  Date: 2024-12-30 11:32:15\n\n* L012 - Add user settings\n  Date: 2024-12-30 09:15:42\n\n* L011 - Add admin dashboard\n  Date: 2024-12-30 08:00:00\n</code></pre>"},{"location":"commands/history/log/#find-specific-change","title":"Find Specific Change","text":"<pre><code># Search for layers mentioning \"index\"\n$ dbl log --oneline | grep -i index\n\nL014 Add indexes for performance\nL008 Add search indexes\nL003 Add initial indexes\n</code></pre>"},{"location":"commands/history/log/#compare-branches","title":"Compare Branches","text":"<pre><code># Main branch\n$ dbl log --branch main -n 3\n* L010 - Add admin features (main)\n* L009 - Add user profiles (main)\n* L008 - Add posts (main)\n\n# Feature branch\n$ dbl log --branch feature-auth -n 3\n* L012 - Add 2FA (feature-auth)\n* L011 - Add OAuth (feature-auth)\n* L008 - Add posts (main)  \u2190 Common ancestor\n</code></pre>"},{"location":"commands/history/log/#layer-details","title":"Layer Details","text":"<pre><code># See what changed in L005\n$ dbl log L005..L005\n\n* L005 - Add comments feature\n  Date: 2024-12-30 14:32:11\n  Files: .dbl/layers/L005_add_comments_feature.sql\n\n  Added comments table with foreign keys to posts and users.\n\n# View the actual SQL\n$ cat .dbl/layers/L005_add_comments_feature.sql\n</code></pre>"},{"location":"commands/history/log/#use-cases","title":"Use Cases","text":""},{"location":"commands/history/log/#code-review","title":"Code Review","text":"<pre><code># Review changes in PR\n$ dbl log -n 5 --oneline &gt; changes.txt\n$ cat changes.txt\n\nL015 Add webhooks\nL014 Add notifications\nL013 Add email templates\n\n# Share with team\n</code></pre>"},{"location":"commands/history/log/#debugging","title":"Debugging","text":"<pre><code># When did we add that table?\n$ dbl log --oneline | grep comments\n\nL005 Add comments feature\n\n# What was in that layer?\n$ cat .dbl/layers/L005_*\n</code></pre>"},{"location":"commands/history/log/#documentation","title":"Documentation","text":"<pre><code># Generate changelog\n$ dbl log --oneline &gt; CHANGELOG.txt\n\n# Or with dates\n$ dbl log -n 20 | grep -E \"^\\* L\" &gt; release-notes.txt\n</code></pre>"},{"location":"commands/history/log/#release-planning","title":"Release Planning","text":"<pre><code># What's in this release?\n$ dbl log v1.0..v1.1\n\n* L025 - Add payment processing\n* L024 - Add subscription tiers\n* L023 - Add billing history\n</code></pre>"},{"location":"commands/history/log/#integration-examples","title":"Integration Examples","text":""},{"location":"commands/history/log/#git-hook","title":"Git Hook","text":"<pre><code>#!/bin/bash\n# .git/hooks/pre-commit\n\n# Verify layer history is clean\nif ! dbl log -n 1; then\n    echo \"Error: DBL history corrupted\"\n    exit 1\nfi\n</code></pre>"},{"location":"commands/history/log/#cicd","title":"CI/CD","text":"<pre><code># .github/workflows/changelog.yml\nname: Generate Changelog\n\non:\n  release:\n    types: [published]\n\njobs:\n  changelog:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Generate changelog\n        run: |\n          dbl log --oneline &gt; CHANGELOG.md\n          git add CHANGELOG.md\n          git commit -m \"Update changelog\"\n          git push\n</code></pre>"},{"location":"commands/history/log/#monitoring-script","title":"Monitoring Script","text":"<pre><code># monitor_layers.py\nimport subprocess\nimport json\n\ndef get_layer_count():\n    result = subprocess.run(['dbl', 'log', '--oneline'], \n                           capture_output=True, text=True)\n    return len(result.stdout.strip().split('\\n'))\n\ncount = get_layer_count()\nprint(f\"Total layers: {count}\")\n\n# Alert if too many layers\nif count &gt; 100:\n    print(\"Warning: Consider squashing old layers\")\n</code></pre>"},{"location":"commands/history/log/#output-filtering","title":"Output Filtering","text":""},{"location":"commands/history/log/#by-date","title":"By Date","text":"<pre><code># Layers from last week (manual filtering)\ndbl log | grep \"2024-12-2[3-9]\"\n</code></pre>"},{"location":"commands/history/log/#by-author","title":"By Author","text":"<pre><code># Layers by specific author (future)\ndbl log --author john@example.com\n</code></pre>"},{"location":"commands/history/log/#by-message","title":"By Message","text":"<pre><code># Find layers with specific keyword\ndbl log --oneline | grep -i \"auth\"\n\nL012 Add authentication\nL007 Add auth tokens\nL003 Add user auth\n</code></pre>"},{"location":"commands/history/log/#performance","title":"Performance","text":"<p>Log is fast for most repositories:</p> <ul> <li>&lt; 100 layers: Instant</li> <li>100-1000 layers: &lt; 1s</li> <li>&gt; 1000 layers: Consider pagination</li> </ul> <pre><code># For large repos, use pagination\ndbl log -n 50  # Show 50 at a time\n</code></pre>"},{"location":"commands/history/log/#error-handling","title":"Error Handling","text":""},{"location":"commands/history/log/#no-layers","title":"No Layers","text":"<pre><code>$ dbl log\nNo layers found\n\nInitialize with: dbl init\n</code></pre>"},{"location":"commands/history/log/#corrupted-history","title":"Corrupted History","text":"<pre><code>$ dbl log\nError: Layer history corrupted\nMissing layer L003\n\nCheck .dbl/layers/ directory\n</code></pre>"},{"location":"commands/history/log/#missing-branch","title":"Missing Branch","text":"<pre><code>$ dbl log --branch nonexistent\nError: Branch 'nonexistent' not found\n\nAvailable branches:\n  - main\n  - feature-auth\n</code></pre>"},{"location":"commands/history/log/#important-notes","title":"Important Notes","text":"<p>Oneline for Scripts</p> <p>Use <code>--oneline</code> in scripts for easier parsing.</p> <p>Chronological Order</p> <p>Layers are always shown newest first (reverse chronological).</p> <p>All Branches</p> <p>By default, shows current branch only. Use <code>--all</code> for all branches.</p>"},{"location":"commands/history/log/#advanced-usage","title":"Advanced Usage","text":""},{"location":"commands/history/log/#custom-format-future","title":"Custom Format (future)","text":"<pre><code># Custom output format\ndbl log --format \"%id - %msg (%date)\"\n\nL005 - Add comments (2024-12-30)\nL004 - Add indexes (2024-12-30)\n</code></pre>"},{"location":"commands/history/log/#export-history","title":"Export History","text":"<pre><code># Export to JSON\ndbl log --json &gt; history.json\n\n# Export to CSV\ndbl log --csv &gt; history.csv\n</code></pre>"},{"location":"commands/history/log/#statistics","title":"Statistics","text":"<pre><code># Layer count\ndbl log --oneline | wc -l\n\n# Layers per day\ndbl log | grep \"Date:\" | cut -d' ' -f3 | uniq -c\n\n# Most active contributors\ndbl log | grep \"Author:\" | sort | uniq -c | sort -nr\n</code></pre>"},{"location":"commands/history/log/#comparison-with-git","title":"Comparison with Git","text":"<p>DBL <code>log</code> is similar to <code>git log</code>:</p> Git DBL Purpose <code>git log</code> <code>dbl log</code> Show history <code>git log --oneline</code> <code>dbl log --oneline</code> Compact view <code>git log -n 5</code> <code>dbl log -n 5</code> Limit output <code>git log branch</code> <code>dbl log --branch branch</code> Branch history"},{"location":"commands/history/log/#aliases","title":"Aliases","text":"<pre><code># Add to shell config\nalias dlog='dbl log --oneline'\nalias dlast='dbl log -n 1'\n</code></pre>"},{"location":"commands/history/log/#layer-files","title":"Layer Files","text":"<p>Each layer in the log corresponds to a file:</p> <pre><code># Layer L005 in log\n$ dbl log --oneline | grep L005\nL005 Add comments feature\n\n# Corresponds to file\n$ ls .dbl/layers/L005_*\n.dbl/layers/L005_add_comments_feature.sql\n</code></pre>"},{"location":"commands/history/log/#see-also","title":"See Also","text":"<ul> <li><code>dbl commit</code> - Create layers</li> <li><code>dbl diff</code> - Show uncommitted changes</li> <li><code>dbl branch</code> - View branches</li> <li><code>dbl reset</code> - Replay layers</li> <li>Architecture: Layers - How layers work</li> </ul>"},{"location":"commands/sandbox/apply/","title":"dbl sandbox apply","text":"<p>Apply sandbox changes to the main database.</p>"},{"location":"commands/sandbox/apply/#synopsis","title":"Synopsis","text":"<pre><code>dbl sandbox apply\n</code></pre>"},{"location":"commands/sandbox/apply/#description","title":"Description","text":"<p>Applies all changes from the sandbox to your main database, making them permanent. This also cleans up the sandbox database automatically.</p>"},{"location":"commands/sandbox/apply/#what-it-does","title":"What It Does","text":"<ol> <li>Validates sandbox state - Ensures sandbox is active and has commits</li> <li>Applies layers - Executes committed SQL layers on main database</li> <li>Updates state - Marks layers as applied</li> <li>Drops sandbox - Removes temporary sandbox database</li> <li>Cleans metadata - Removes sandbox tracking files</li> </ol>"},{"location":"commands/sandbox/apply/#usage-example","title":"Usage Example","text":"<pre><code># Complete workflow\ndbl sandbox start\n# Make changes...\ndbl diff\ndbl commit -m \"Add user preferences\"\ndbl sandbox apply\n</code></pre> <p>Output: <pre><code>Applying sandbox changes to main database...\n\u2713 Executing layer L005\n\u2713 Changes applied successfully\n\u2713 Sandbox database dropped\n\u2713 Sandbox metadata cleared\n\nYour main database (myapp) now includes all sandbox changes.\n</code></pre></p>"},{"location":"commands/sandbox/apply/#detailed-workflow","title":"Detailed Workflow","text":""},{"location":"commands/sandbox/apply/#step-by-step","title":"Step-by-Step","text":"<pre><code># 1. Create sandbox\n$ dbl sandbox start\n\u2713 Sandbox created: myapp_sandbox\n\n# 2. Make changes\n$ psql -d myapp_sandbox -c \"\nCREATE TABLE notifications (\n    id SERIAL PRIMARY KEY,\n    user_id INTEGER NOT NULL,\n    message TEXT,\n    read BOOLEAN DEFAULT false\n);\n\"\n\n# 3. Review changes\n$ dbl diff\n+ CREATE TABLE notifications (...)\n\n# 4. Commit\n$ dbl commit -m \"Add notifications feature\"\n\u2713 Layer L008 created\n\n# 5. Apply to main\n$ dbl sandbox apply\n\u2713 Applied layer L008 to myapp\n\u2713 Sandbox cleaned up\n\n# 6. Verify\n$ psql -d myapp -c \"\\dt\"\n         List of relations\n Schema |      Name       | Type  \n--------+-----------------+-------\n public | users           | table\n public | posts           | table\n public | notifications   | table  \u2190 New!\n</code></pre>"},{"location":"commands/sandbox/apply/#safety-features","title":"Safety Features","text":""},{"location":"commands/sandbox/apply/#pre-apply-checks","title":"Pre-apply Checks","text":"<p>DBL validates before applying:</p> <ul> <li>\u2705 Sandbox is active</li> <li>\u2705 Commits exist to apply</li> <li>\u2705 Main database is accessible</li> <li>\u2705 No conflicting changes in main DB</li> </ul>"},{"location":"commands/sandbox/apply/#what-gets-applied","title":"What Gets Applied","text":"<p>Only committed layers are applied:</p> <pre><code># Sandbox has uncommitted changes\n$ dbl diff\n+ ALTER TABLE users ADD COLUMN email TEXT;\n\n$ dbl sandbox apply\nError: Uncommitted changes detected\nCommit your changes first with: dbl commit -m \"message\"\n\n# After committing\n$ dbl commit -m \"Add email column\"\n$ dbl sandbox apply\n\u2713 Applied successfully\n</code></pre>"},{"location":"commands/sandbox/apply/#complete-example","title":"Complete Example","text":""},{"location":"commands/sandbox/apply/#add-comments-feature","title":"Add Comments Feature","text":"<pre><code># 1. Start sandbox\n$ dbl sandbox start\n\u2713 Sandbox: myapp_sandbox\n\n# 2. Add tables\n$ psql -d myapp_sandbox &lt;&lt; EOF\n-- Comments table\nCREATE TABLE comments (\n    id SERIAL PRIMARY KEY,\n    post_id INTEGER REFERENCES posts(id) ON DELETE CASCADE,\n    user_id INTEGER NOT NULL,\n    content TEXT NOT NULL,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Indexes\nCREATE INDEX idx_comments_post ON comments(post_id);\nCREATE INDEX idx_comments_user ON comments(user_id);\nEOF\n\n# 3. Review\n$ dbl diff\n+ CREATE TABLE comments (...)\n+ CREATE INDEX idx_comments_post ...\n+ CREATE INDEX idx_comments_user ...\n\n# 4. Commit\n$ dbl commit -m \"Add comments feature with indexes\"\n\u2713 Layer L012 created\n\n# 5. Apply to main\n$ dbl sandbox apply\n\nApplying sandbox changes to main database (myapp)...\n  \u2192 Executing L012_add_comments_feature.sql\n  \u2192 Creating table comments\n  \u2192 Creating indexes\n\u2713 All changes applied successfully\n\nCleaning up sandbox...\n  \u2192 Dropping database myapp_sandbox\n  \u2192 Removing sandbox metadata\n\u2713 Sandbox cleaned up\n\nSummary:\n  Database: myapp\n  Layers applied: 1 (L012)\n  Tables added: 1 (comments)\n  Indexes added: 2\n</code></pre>"},{"location":"commands/sandbox/apply/#what-happens-after-apply","title":"What Happens After Apply","text":""},{"location":"commands/sandbox/apply/#database-state","title":"Database State","text":"<pre><code>Before:\n  Main DB: myapp          (old schema)\n  Sandbox: myapp_sandbox  (new schema)\n\nAfter:\n  Main DB: myapp          (new schema) \u2713\n  Sandbox: (deleted)\n</code></pre>"},{"location":"commands/sandbox/apply/#files-updated","title":"Files Updated","text":"<pre><code>.dbl/\n\u251c\u2500\u2500 state.json          \u2190 Updated (no active sandbox)\n\u251c\u2500\u2500 layers/\n\u2502   \u2514\u2500\u2500 L012_*.sql      \u2190 Applied to main\n\u2514\u2500\u2500 sandbox.json        \u2190 Deleted\n</code></pre>"},{"location":"commands/sandbox/apply/#important-notes","title":"Important Notes","text":"<p>Permanent Changes</p> <p>After <code>sandbox apply</code>, changes are in your main database. There is no undo except restoring from backups.</p> <p>Application Downtime</p> <p>Some operations may briefly lock tables. Plan accordingly for production.</p> <p>Test First</p> <p>Use <code>dbl reset</code> in a test environment to verify layers replay correctly before applying to production.</p>"},{"location":"commands/sandbox/apply/#rollback-alternative","title":"Rollback Alternative","text":"<p>If you're not ready to apply:</p> <pre><code># Discard sandbox instead\ndbl sandbox rollback\n\n# Sandbox and all changes are deleted\n# Main database untouched\n</code></pre>"},{"location":"commands/sandbox/apply/#production-deployment","title":"Production Deployment","text":""},{"location":"commands/sandbox/apply/#safe-production-apply","title":"Safe Production Apply","text":"<pre><code># 1. Backup first\npg_dump myapp_prod &gt; backup_$(date +%Y%m%d).sql\n\n# 2. Test in staging\ndbl --config staging.yaml sandbox apply\n\n# 3. Verify app works\n./run-tests.sh\n\n# 4. Apply to production (during maintenance window)\ndbl --config production.yaml sandbox apply\n\n# 5. Verify\n./verify-schema.sh\n</code></pre>"},{"location":"commands/sandbox/apply/#zero-downtime-deployment","title":"Zero-Downtime Deployment","text":"<p>Use expand-contract pattern:</p> <pre><code># Week 1: Expand (add columns)\ndbl sandbox start\nALTER TABLE users ADD COLUMN email TEXT;\ndbl commit -m \"expand: Add email column\"\ndbl sandbox apply\n# Deploy app v1.1 (reads from both old and new)\n\n# Week 2: Backfill\ndbl sandbox start\nUPDATE users SET email = username || '@example.com';\ndbl commit -m \"backfill: Populate email\" --with-data\ndbl sandbox apply\n\n# Week 3: Contract (enforce constraints)\ndbl sandbox start\nALTER TABLE users ALTER COLUMN email SET NOT NULL;\ndbl commit -m \"contract: Make email required\"\ndbl sandbox apply\n# Deploy app v1.2 (uses only new column)\n</code></pre>"},{"location":"commands/sandbox/apply/#error-handling","title":"Error Handling","text":""},{"location":"commands/sandbox/apply/#conflicting-changes","title":"Conflicting Changes","text":"<p>Error: <pre><code>Error: Main database has conflicting changes\nThe following tables were modified outside of DBL:\n  - users (column added)\n</code></pre></p> <p>Solution: 1. Review changes in main DB 2. Decide: merge or reset 3. If merging, commit manually 4. If resetting, use <code>dbl reset</code></p>"},{"location":"commands/sandbox/apply/#connection-lost","title":"Connection Lost","text":"<p>Error: <pre><code>Error: Lost connection to main database\n</code></pre></p> <p>Solution: - Sandbox remains intact - Fix connection issue - Run <code>dbl sandbox apply</code> again - Already-applied changes are skipped (idempotent)</p>"},{"location":"commands/sandbox/apply/#insufficient-permissions","title":"Insufficient Permissions","text":"<p>Error: <pre><code>Error: Permission denied\nUser 'dbl_user' cannot DROP TABLE\n</code></pre></p> <p>Solution: <pre><code>-- Grant necessary permissions\nALTER USER dbl_user WITH SUPERUSER;\n-- Or specific grants\nGRANT ALL ON DATABASE myapp TO dbl_user;\n</code></pre></p>"},{"location":"commands/sandbox/apply/#performance-considerations","title":"Performance Considerations","text":""},{"location":"commands/sandbox/apply/#large-databases","title":"Large Databases","text":"<p>For databases &gt; 100GB:</p> <ul> <li>Time: Apply may take several minutes</li> <li>Locks: Some operations acquire table locks</li> <li>Monitoring: Watch <code>pg_stat_activity</code> for progress</li> </ul>"},{"location":"commands/sandbox/apply/#optimize-apply","title":"Optimize Apply","text":"<pre><code># For large data migrations\ndbl commit -m \"Add indexes\" --with-data\n\n# Indexes created AFTER data loaded (faster)\n</code></pre>"},{"location":"commands/sandbox/apply/#cicd-integration","title":"CI/CD Integration","text":""},{"location":"commands/sandbox/apply/#automated-deployment","title":"Automated Deployment","text":"<pre><code># .github/workflows/deploy.yml\nname: Deploy Database Changes\n\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Apply sandbox\n        run: |\n          dbl sandbox start\n          # Run migrations\n          dbl reset\n          dbl sandbox apply\n\n      - name: Verify\n        run: ./verify-schema.sh\n</code></pre>"},{"location":"commands/sandbox/apply/#next-steps","title":"Next Steps","text":"<p>After applying:</p> <ul> <li>Verify changes: Check main database has expected schema</li> <li>Test application: Ensure app works with new schema</li> <li>Monitor logs: Watch for errors</li> <li>Update documentation: Document schema changes</li> </ul>"},{"location":"commands/sandbox/apply/#see-also","title":"See Also","text":"<ul> <li><code>dbl sandbox start</code> - Create sandbox</li> <li><code>dbl sandbox rollback</code> - Discard changes</li> <li><code>dbl diff</code> - Review changes</li> <li><code>dbl commit</code> - Save changes</li> <li><code>dbl reset</code> - Rebuild database</li> </ul>"},{"location":"commands/sandbox/rollback/","title":"dbl sandbox rollback","text":"<p>Discard all sandbox changes and delete the sandbox.</p>"},{"location":"commands/sandbox/rollback/#synopsis","title":"Synopsis","text":"<pre><code>dbl sandbox rollback\n</code></pre>"},{"location":"commands/sandbox/rollback/#description","title":"Description","text":"<p>Deletes the sandbox database and all uncommitted changes, leaving your main database untouched. This is a safe way to discard experimental changes.</p>"},{"location":"commands/sandbox/rollback/#what-it-does","title":"What It Does","text":"<ol> <li>Drops sandbox database - Removes <code>{database}_sandbox</code></li> <li>Clears metadata - Deletes sandbox tracking files</li> <li>Resets state - Marks no sandbox as active</li> </ol>"},{"location":"commands/sandbox/rollback/#usage-example","title":"Usage Example","text":"<pre><code># Create sandbox and make changes\ndbl sandbox start\npsql -d myapp_sandbox -c \"CREATE TABLE test (id INT);\"\n\n# Decide you don't want these changes\ndbl sandbox rollback\n</code></pre> <p>Output: <pre><code>Rolling back sandbox changes...\n\u2713 Dropped sandbox database (myapp_sandbox)\n\u2713 Cleared sandbox metadata\n\u2713 No active sandbox\n\nYour main database (myapp) remains unchanged.\n</code></pre></p>"},{"location":"commands/sandbox/rollback/#when-to-use","title":"When to Use","text":""},{"location":"commands/sandbox/rollback/#use-rollback-when","title":"\u2705 Use Rollback When:","text":"<ul> <li>Experimenting: Tried something that didn't work</li> <li>Testing: Wanted to see the effect of changes</li> <li>Mistakes: Made errors you want to discard</li> <li>Changing direction: Decided on a different approach</li> </ul>"},{"location":"commands/sandbox/rollback/#dont-use-when","title":"\u274c Don't Use When:","text":"<ul> <li>Want to keep changes: Use <code>dbl sandbox apply</code> instead</li> <li>Partially done: Commit what you have first</li> <li>Already applied: Can't rollback after <code>sandbox apply</code></li> </ul>"},{"location":"commands/sandbox/rollback/#complete-examples","title":"Complete Examples","text":""},{"location":"commands/sandbox/rollback/#experiment-gone-wrong","title":"Experiment Gone Wrong","text":"<pre><code># 1. Start experimenting\n$ dbl sandbox start\n\u2713 Sandbox: myapp_sandbox\n\n# 2. Try something\n$ psql -d myapp_sandbox\nmyapp_sandbox=# DROP TABLE users CASCADE;\nDROP TABLE\nmyapp_sandbox=# -- Oops, didn't mean to do that!\n\n# 3. Rollback\n$ dbl sandbox rollback\n\u2713 Sandbox dropped\n\u2713 Main database unchanged\n\n# 4. Start fresh\n$ dbl sandbox start\n\u2713 New clean sandbox created\n</code></pre>"},{"location":"commands/sandbox/rollback/#multiple-rollbacks","title":"Multiple Rollbacks","text":"<pre><code># Try approach 1\n$ dbl sandbox start\n# Make changes...\n$ dbl diff\n# Don't like it\n$ dbl sandbox rollback\n\n# Try approach 2\n$ dbl sandbox start\n# Make different changes...\n$ dbl diff\n# Don't like this either\n$ dbl sandbox rollback\n\n# Try approach 3\n$ dbl sandbox start\n# Finally got it right!\n$ dbl commit -m \"Final approach\"\n$ dbl sandbox apply\n</code></pre>"},{"location":"commands/sandbox/rollback/#save-some-discard-rest","title":"Save Some, Discard Rest","text":"<pre><code># Make several changes\n$ dbl sandbox start\n\n# Change 1: Good\n$ psql -d myapp_sandbox -c \"CREATE TABLE comments (...);\"\n$ dbl commit -m \"Add comments table\"\n\n# Change 2: Good\n$ psql -d myapp_sandbox -c \"CREATE INDEX idx_comments_post (...);\"\n$ dbl commit -m \"Add comments index\"\n\n# Change 3: Bad idea\n$ psql -d myapp_sandbox -c \"DROP TABLE users;\"\n# Don't commit this!\n\n# Rollback to discard uncommitted changes\n$ dbl sandbox rollback\n\n# Previously committed changes are safe in layers\n# Can apply them later in a new sandbox\n</code></pre>"},{"location":"commands/sandbox/rollback/#what-gets-deleted","title":"What Gets Deleted","text":""},{"location":"commands/sandbox/rollback/#deleted","title":"Deleted:","text":"<ul> <li>\u274c Sandbox database (<code>myapp_sandbox</code>)</li> <li>\u274c Uncommitted changes</li> <li>\u274c Sandbox metadata (<code>.dbl/sandbox.json</code>)</li> </ul>"},{"location":"commands/sandbox/rollback/#preserved","title":"Preserved:","text":"<ul> <li>\u2705 Main database (untouched)</li> <li>\u2705 Committed layers (<code>.dbl/layers/</code>)</li> <li>\u2705 Branch history</li> <li>\u2705 All previous work</li> </ul>"},{"location":"commands/sandbox/rollback/#comparison-with-apply","title":"Comparison with Apply","text":"Aspect Rollback Apply Sandbox DB Deleted Deleted Changes Discarded Applied to main Main DB Unchanged Updated Use when Don't want changes Want changes"},{"location":"commands/sandbox/rollback/#safety-features","title":"Safety Features","text":""},{"location":"commands/sandbox/rollback/#confirmation-prompt","title":"Confirmation Prompt","text":"<p>By default, DBL may prompt before rolling back:</p> <pre><code>$ dbl sandbox rollback\nWarning: This will discard all sandbox changes.\nAre you sure? (y/n): y\n\u2713 Sandbox rolled back\n</code></pre>"},{"location":"commands/sandbox/rollback/#no-undo","title":"No Undo","text":"<p>Permanent Deletion</p> <p>After rollback, sandbox changes are permanently lost. There is no undo.</p> <p>Commit First</p> <p>If unsure, commit changes before rolling back. You can always create a new sandbox and not apply those commits.</p>"},{"location":"commands/sandbox/rollback/#workflow-patterns","title":"Workflow Patterns","text":""},{"location":"commands/sandbox/rollback/#quick-experiment","title":"Quick Experiment","text":"<pre><code># Quick test\ndbl sandbox start\n# Test something...\ndbl sandbox rollback  # Discard\n</code></pre>"},{"location":"commands/sandbox/rollback/#iterative-development","title":"Iterative Development","text":"<pre><code># Loop until satisfied\nwhile true; do\n    dbl sandbox start\n    # Make changes...\n    dbl diff\n    read -p \"Keep? (y/n): \" keep\n    if [ \"$keep\" = \"y\" ]; then\n        dbl commit -m \"Changes\"\n        dbl sandbox apply\n        break\n    else\n        dbl sandbox rollback\n    fi\ndone\n</code></pre>"},{"location":"commands/sandbox/rollback/#feature-exploration","title":"Feature Exploration","text":"<pre><code># Try feature in sandbox\ndbl branch feature-xyz\ndbl checkout feature-xyz\ndbl sandbox start\n\n# Explore implementation\n# ... make changes ...\n\n# Not ready yet\ndbl sandbox rollback\n\n# Later, try again\ndbl sandbox start\n# ... better implementation ...\ndbl commit -m \"Feature XYZ\"\ndbl sandbox apply\n</code></pre>"},{"location":"commands/sandbox/rollback/#error-handling","title":"Error Handling","text":""},{"location":"commands/sandbox/rollback/#no-active-sandbox","title":"No Active Sandbox","text":"<p>Error: <pre><code>Error: No active sandbox found\n</code></pre></p> <p>Solution: - Nothing to rollback - Already clean state</p>"},{"location":"commands/sandbox/rollback/#sandbox-already-gone","title":"Sandbox Already Gone","text":"<p>Error: <pre><code>Error: Sandbox database not found\n</code></pre></p> <p>Solution: <pre><code># Clean up metadata\nrm .dbl/sandbox.json\n</code></pre></p>"},{"location":"commands/sandbox/rollback/#permission-issues","title":"Permission Issues","text":"<p>Error: <pre><code>Error: Permission denied to drop database\n</code></pre></p> <p>Solution: <pre><code>-- Grant drop permission\nALTER USER myuser WITH CREATEDB;\n</code></pre></p>"},{"location":"commands/sandbox/rollback/#important-notes","title":"Important Notes","text":"<p>Uncommitted Changes Lost</p> <p>Only uncommitted changes are lost. Committed layers are safe.</p> <p>Main DB Safe</p> <p>Your main database is never affected by rollback.</p> <p>No Cleanup Needed</p> <p>DBL automatically cleans up all sandbox artifacts.</p>"},{"location":"commands/sandbox/rollback/#after-rollback","title":"After Rollback","text":""},{"location":"commands/sandbox/rollback/#check-status","title":"Check Status","text":"<pre><code>$ dbl sandbox status\nNo active sandbox\n</code></pre>"},{"location":"commands/sandbox/rollback/#start-fresh","title":"Start Fresh","text":"<pre><code>$ dbl sandbox start\n\u2713 New sandbox created\n</code></pre>"},{"location":"commands/sandbox/rollback/#review-committed-layers","title":"Review Committed Layers","text":"<pre><code># Committed changes are safe\n$ dbl log\n* L005 - Add comments feature\n* L004 - Add indexes\n...\n</code></pre>"},{"location":"commands/sandbox/rollback/#cicd-integration","title":"CI/CD Integration","text":""},{"location":"commands/sandbox/rollback/#auto-rollback-on-failure","title":"Auto-rollback on Failure","text":"<pre><code># .github/workflows/test.yml\nname: Test Migrations\n\non: [pull_request]\n\njobs:\n  test:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Test migrations\n        run: |\n          dbl sandbox start\n          dbl reset || dbl sandbox rollback\n\n      - name: Cleanup on failure\n        if: failure()\n        run: dbl sandbox rollback\n</code></pre>"},{"location":"commands/sandbox/rollback/#cleanup-script","title":"Cleanup Script","text":"<pre><code>#!/bin/bash\n# cleanup.sh\n\n# Always rollback at end\ntrap \"dbl sandbox rollback 2&gt;/dev/null\" EXIT\n\n# Run tests\ndbl sandbox start\n./run-migrations.sh\n./run-tests.sh\n</code></pre>"},{"location":"commands/sandbox/rollback/#comparison-with-reset","title":"Comparison with Reset","text":"Command Purpose Scope <code>rollback</code> Discard sandbox Sandbox only <code>reset</code> Rebuild from layers Main database <pre><code># Rollback: discard sandbox changes\ndbl sandbox rollback\n\n# Reset: rebuild main DB from layers\ndbl reset\n</code></pre>"},{"location":"commands/sandbox/rollback/#best-practices","title":"Best Practices","text":"<ol> <li>Rollback freely - Don't be afraid to discard experiments</li> <li>Commit good parts - Save what works before rolling back rest</li> <li>Use branches - Isolate experiments in feature branches</li> <li>Document why - Note why you rolled back for team awareness</li> </ol>"},{"location":"commands/sandbox/rollback/#next-steps","title":"Next Steps","text":"<p>After rollback:</p> <ul> <li>Start new sandbox and try again</li> <li>Review committed layers</li> <li>Switch branches to try different approach</li> <li>Reset database to test layer replay</li> </ul>"},{"location":"commands/sandbox/rollback/#see-also","title":"See Also","text":"<ul> <li><code>dbl sandbox start</code> - Create sandbox</li> <li><code>dbl sandbox apply</code> - Apply changes</li> <li><code>dbl sandbox status</code> - Check sandbox state</li> <li><code>dbl commit</code> - Save changes before rollback</li> </ul>"},{"location":"commands/sandbox/start/","title":"dbl sandbox start","text":"<p>Create an isolated sandbox database for safe experimentation.</p>"},{"location":"commands/sandbox/start/#synopsis","title":"Synopsis","text":"<pre><code>dbl sandbox start\n</code></pre>"},{"location":"commands/sandbox/start/#description","title":"Description","text":"<p>Creates a temporary copy of your main database where you can safely make and test changes. The sandbox is a complete clone that runs in isolation from your production database.</p>"},{"location":"commands/sandbox/start/#what-it-does","title":"What It Does","text":"<ol> <li>Creates sandbox database: Clones your main database to <code>{database}_sandbox</code></li> <li>Captures baseline: Records the current state for change detection</li> <li>Updates tracking: Marks the sandbox as active in DBL state</li> <li>Switches context: All subsequent DBL commands target the sandbox</li> </ol>"},{"location":"commands/sandbox/start/#usage-example","title":"Usage Example","text":"<pre><code># Start a sandbox\ndbl sandbox start\n\n# Output:\n# Creating sandbox database mydb_sandbox...\n# \u2713 Sandbox created successfully\n# \u2713 You are now working in the sandbox\n# \n# Make your changes, then:\n#   dbl diff           - See what changed\n#   dbl commit -m \"msg\"  - Save changes\n#   dbl sandbox apply  - Apply to main DB\n#   dbl sandbox rollback - Discard changes\n</code></pre>"},{"location":"commands/sandbox/start/#workflow","title":"Workflow","text":"<pre><code>graph LR\n    A[Main DB] --&gt;|clone| B[Sandbox DB]\n    B --&gt;|make changes| C[Modified Sandbox]\n    C --&gt;|dbl diff| D[Review Changes]\n    D --&gt;|dbl commit| E[Create Layer]\n    E --&gt;|dbl sandbox apply| F[Apply to Main]\n    C --&gt;|dbl sandbox rollback| A\n</code></pre>"},{"location":"commands/sandbox/start/#safety-benefits","title":"Safety Benefits","text":""},{"location":"commands/sandbox/start/#why-use-sandboxes","title":"Why Use Sandboxes?","text":"Without Sandbox With Sandbox \u274c Changes affect production immediately \u2705 Changes isolated in copy \u274c Mistakes can break your app \u2705 Mistakes only affect sandbox \u274c Hard to undo changes \u2705 Easy rollback with <code>sandbox rollback</code> \u274c No preview before commit \u2705 Full preview with <code>dbl diff</code>"},{"location":"commands/sandbox/start/#what-you-can-do-in-a-sandbox","title":"What You Can Do in a Sandbox","text":"<ul> <li>\u2705 Create/drop tables</li> <li>\u2705 Add/remove columns</li> <li>\u2705 Modify constraints</li> <li>\u2705 Test data migrations</li> <li>\u2705 Experiment freely</li> </ul> <p>All without risk to your main database!</p>"},{"location":"commands/sandbox/start/#database-naming","title":"Database Naming","text":"<p>The sandbox database name follows this pattern: <pre><code>{original_database}_sandbox\n</code></pre></p>"},{"location":"commands/sandbox/start/#examples","title":"Examples:","text":"<ul> <li><code>myapp</code> \u2192 <code>myapp_sandbox</code></li> <li><code>production_db</code> \u2192 <code>production_db_sandbox</code></li> <li><code>test_db</code> \u2192 <code>test_db_sandbox</code></li> </ul>"},{"location":"commands/sandbox/start/#connection-details","title":"Connection Details","text":"<p>While in a sandbox, DBL automatically:</p> <ul> <li>\ud83d\udd04 Switches all commands to use sandbox database</li> <li>\ud83d\udcca Tracks changes against the baseline</li> <li>\ud83d\udeab Prevents modifications to main database</li> </ul> <p>To check which database you're using: <pre><code>dbl sandbox status\n</code></pre></p>"},{"location":"commands/sandbox/start/#docker-support","title":"Docker Support","text":"<p>If using Docker (with <code>container_name</code> in <code>dbl.yaml</code>):</p> <pre><code># DBL automatically runs inside the container\ndbl sandbox start\n\n# Equivalent to:\ndocker exec my_container createdb mydb_sandbox\ndocker exec my_container pg_dump mydb | docker exec -i my_container psql mydb_sandbox\n</code></pre>"},{"location":"commands/sandbox/start/#complete-example","title":"Complete Example","text":"<pre><code># 1. Create sandbox\n$ dbl sandbox start\n\u2713 Sandbox created: myapp_sandbox\n\n# 2. Make changes in your database tool\n# (e.g., add a column, create a table)\n\n# 3. Review changes\n$ dbl diff\n+ CREATE TABLE user_preferences (...);\n+ ALTER TABLE users ADD COLUMN last_login timestamp;\n\n# 4. Commit if satisfied\n$ dbl commit -m \"Add user preferences table\"\n\u2713 Layer committed: L001_add_user_preferences\n\n# 5. Apply to main database\n$ dbl sandbox apply\n\u2713 Changes applied to main database\n\u2713 Sandbox cleaned up\n</code></pre>"},{"location":"commands/sandbox/start/#after-sandbox-start","title":"After Sandbox Start","text":"<p>Once your sandbox is active, you typically:</p> <ol> <li>Make changes using your preferred database tool:</li> <li>pgAdmin, DBeaver, MySQL Workbench, etc.</li> <li> <p>Or direct SQL via <code>psql</code>/<code>mysql</code> CLI</p> </li> <li> <p>Review changes:    <pre><code>dbl diff\n</code></pre></p> </li> <li> <p>Commit changes:    <pre><code>dbl commit -m \"Description of changes\"\n</code></pre></p> </li> <li> <p>Apply or discard:    <pre><code>dbl sandbox apply     # Keep changes\n# OR\ndbl sandbox rollback  # Discard changes\n</code></pre></p> </li> </ol>"},{"location":"commands/sandbox/start/#important-notes","title":"Important Notes","text":"<p>One Sandbox at a Time</p> <p>You can only have one active sandbox per project. Running <code>sandbox start</code> again will fail if a sandbox already exists.</p> <p>Check status first: <pre><code>dbl sandbox status\n</code></pre></p> <p>Always Use Sandboxes</p> <p>DBL enforces sandbox usage by default. You cannot commit changes without an active sandbox (unless you disable <code>require_sandbox</code> in policies).</p> <p>Sandbox Persistence</p> <p>The sandbox database persists until you run <code>sandbox apply</code> or <code>sandbox rollback</code>. Even if you close your terminal, the sandbox remains active.</p>"},{"location":"commands/sandbox/start/#common-issues","title":"Common Issues","text":""},{"location":"commands/sandbox/start/#database-already-exists","title":"Database Already Exists","text":"<pre><code>Error: Database mydb_sandbox already exists\n</code></pre> <p>Solutions: 1. Check if sandbox is active: <pre><code>dbl sandbox status\n</code></pre> 2. Rollback existing sandbox: <pre><code>dbl sandbox rollback\n</code></pre> 3. Or manually drop: <pre><code>dropdb mydb_sandbox  # PostgreSQL\n</code></pre></p>"},{"location":"commands/sandbox/start/#permission-errors","title":"Permission Errors","text":"<pre><code>Error: Permission denied to create database\n</code></pre> <p>Solution: Ensure your database user has CREATE DATABASE privileges: <pre><code>-- PostgreSQL\nALTER USER myuser CREATEDB;\n\n-- MySQL\nGRANT CREATE ON *.* TO 'myuser'@'localhost';\n</code></pre></p>"},{"location":"commands/sandbox/start/#insufficient-disk-space","title":"Insufficient Disk Space","text":"<p>If your database is large, ensure you have enough disk space for a complete copy.</p> <p>Check space: <pre><code>df -h  # Unix/Linux\n</code></pre></p>"},{"location":"commands/sandbox/start/#performance-considerations","title":"Performance Considerations","text":"<p>For large databases:</p> <ul> <li>Time: Initial clone can take several minutes for GB-sized databases</li> <li>Space: Sandbox requires 2x the space of your database</li> <li>Memory: No extra memory needed (sandbox is separate database)</li> </ul> <p>Optimization tip: Use <code>ignore_tables</code> in <code>dbl.yaml</code> to exclude large tables that don't need tracking:</p> <pre><code>ignore_tables:\n  - audit_logs\n  - raw_data_imports\n</code></pre>"},{"location":"commands/sandbox/start/#next-steps","title":"Next Steps","text":"<ul> <li>Review changes with dbl diff</li> <li>Commit changes</li> <li>Apply sandbox</li> <li>Rollback sandbox</li> </ul>"},{"location":"commands/sandbox/start/#see-also","title":"See Also","text":"<ul> <li><code>dbl sandbox apply</code> - Apply sandbox changes</li> <li><code>dbl sandbox rollback</code> - Discard sandbox changes</li> <li><code>dbl sandbox status</code> - Check sandbox state</li> <li><code>dbl diff</code> - Preview changes</li> </ul>"},{"location":"commands/sandbox/status/","title":"dbl sandbox status","text":"<p>Check the current sandbox state.</p>"},{"location":"commands/sandbox/status/#synopsis","title":"Synopsis","text":"<pre><code>dbl sandbox status\n</code></pre>"},{"location":"commands/sandbox/status/#description","title":"Description","text":"<p>Displays information about the active sandbox, including uncommitted changes, committed layers pending apply, and sandbox database details.</p>"},{"location":"commands/sandbox/status/#usage-example","title":"Usage Example","text":"<pre><code>dbl sandbox status\n</code></pre> <p>Output: <pre><code>Active Sandbox: myapp_sandbox\nBase Database: myapp\nCreated: 2024-12-30 10:23:15\nBranch: feature-auth\n\nUncommitted Changes:\n  + 1 table added (user_sessions)\n  + 2 columns added\n  ~ 1 table modified\n\nCommitted Layers (not yet applied):\n  L012 - Add user preferences (2024-12-30 10:45:22)\n  L013 - Add session tracking (2024-12-30 11:02:05)\n\nStatus: Ready to apply (2 layers pending)\n\nNext steps:\n  - Review changes: dbl diff\n  - Commit changes: dbl commit -m \"message\"\n  - Apply to main: dbl sandbox apply\n  - Discard sandbox: dbl sandbox rollback\n</code></pre></p>"},{"location":"commands/sandbox/status/#output-sections","title":"Output Sections","text":""},{"location":"commands/sandbox/status/#sandbox-information","title":"Sandbox Information","text":"<pre><code>Active Sandbox: myapp_sandbox\nBase Database: myapp\nCreated: 2024-12-30 10:23:15\nBranch: feature-auth\n</code></pre> <p>Shows: - Sandbox name: Temporary database name - Base database: Original database - Created timestamp: When sandbox started - Branch: Current DBL branch</p>"},{"location":"commands/sandbox/status/#uncommitted-changes","title":"Uncommitted Changes","text":"<pre><code>Uncommitted Changes:\n  + 3 tables added\n  + 5 columns added\n  ~ 2 tables modified\n  - 1 table dropped\n</code></pre> <p>Shows diff summary before commit.</p>"},{"location":"commands/sandbox/status/#committed-layers","title":"Committed Layers","text":"<pre><code>Committed Layers (not yet applied):\n  L015 - Add notifications (2024-12-30 14:32:11)\n  L016 - Add indexes (2024-12-30 14:35:28)\n</code></pre> <p>Shows layers created in sandbox but not yet applied to main.</p>"},{"location":"commands/sandbox/status/#status-summary","title":"Status Summary","text":"<pre><code>Status: Ready to apply (2 layers pending)\n</code></pre> <p>Possible statuses: - <code>Clean</code> - No changes - <code>Uncommitted changes</code> - Changes not yet committed - <code>Ready to apply</code> - Commits ready for main DB - <code>Empty sandbox</code> - No changes made yet</p>"},{"location":"commands/sandbox/status/#when-no-sandbox","title":"When No Sandbox","text":"<pre><code>$ dbl sandbox status\nNo active sandbox\n\nYour main database: myapp\nLast applied layer: L014\nCurrent branch: main\n\nTo start a sandbox: dbl sandbox start\n</code></pre>"},{"location":"commands/sandbox/status/#complete-examples","title":"Complete Examples","text":""},{"location":"commands/sandbox/status/#during-development","title":"During Development","text":"<pre><code># Start sandbox\n$ dbl sandbox start\n\u2713 Sandbox: myapp_sandbox\n\n# Check status (empty)\n$ dbl sandbox status\nActive Sandbox: myapp_sandbox\nStatus: Empty sandbox (no changes)\n\n# Make changes\n$ psql -d myapp_sandbox -c \"CREATE TABLE comments (id SERIAL);\"\n\n# Check status (uncommitted)\n$ dbl sandbox status\nActive Sandbox: myapp_sandbox\nUncommitted Changes:\n  + 1 table added (comments)\nStatus: Uncommitted changes\n\n# Commit\n$ dbl commit -m \"Add comments\"\n\n# Check status (ready)\n$ dbl sandbox status\nActive Sandbox: myapp_sandbox\nCommitted Layers (not yet applied):\n  L008 - Add comments (2024-12-30 15:12:33)\nStatus: Ready to apply (1 layer pending)\n\n# Apply\n$ dbl sandbox apply\n\n# Check status (no sandbox)\n$ dbl sandbox status\nNo active sandbox\n</code></pre>"},{"location":"commands/sandbox/status/#multiple-commits","title":"Multiple Commits","text":"<pre><code>$ dbl sandbox status\n\nActive Sandbox: blog_sandbox\nBase Database: blog\n\nUncommitted Changes:\n  + 1 table added (comments)\n  ~ 1 table modified (posts)\n\nCommitted Layers (not yet applied):\n  L020 - Add user profiles (2024-12-30 09:15:33)\n  L021 - Add social login (2024-12-30 10:22:41)\n  L022 - Add rate limiting (2024-12-30 11:45:19)\n\nStatus: Ready to apply (3 layers pending)\nUncommitted: 2 changes\n\nNext steps:\n  1. Commit remaining changes: dbl commit -m \"Add comments\"\n  2. Apply all layers: dbl sandbox apply\n  3. Or rollback everything: dbl sandbox rollback\n</code></pre>"},{"location":"commands/sandbox/status/#use-cases","title":"Use Cases","text":""},{"location":"commands/sandbox/status/#before-committing","title":"Before Committing","text":"<pre><code># Check what needs to be committed\n$ dbl sandbox status\nUncommitted Changes:\n  + 3 tables added\n\n$ dbl diff  # See details\n$ dbl commit -m \"Add feature X\"\n</code></pre>"},{"location":"commands/sandbox/status/#before-applying","title":"Before Applying","text":"<pre><code># Review what will be applied\n$ dbl sandbox status\nCommitted Layers (not yet applied):\n  L015 - Add notifications\n  L016 - Add webhooks\n\n# Review each layer\n$ cat .dbl/layers/L015_*.sql\n$ cat .dbl/layers/L016_*.sql\n\n# Apply\n$ dbl sandbox apply\n</code></pre>"},{"location":"commands/sandbox/status/#cicd-checks","title":"CI/CD Checks","text":"<pre><code># Verify sandbox is clean before merging\n$ dbl sandbox status\nif [ \"$?\" -ne 0 ]; then\n    echo \"Sandbox has uncommitted changes!\"\n    exit 1\nfi\n</code></pre>"},{"location":"commands/sandbox/status/#team-coordination","title":"Team Coordination","text":"<pre><code># Share status with team\n$ dbl sandbox status &gt; sandbox-status.txt\n$ cat sandbox-status.txt\n\nActive Sandbox: myapp_sandbox\nCommitted Layers (not yet applied):\n  L030 - Add payment system (3 hours ago)\n  L031 - Add webhooks (1 hour ago)\n\n# Team knows what's being worked on\n</code></pre>"},{"location":"commands/sandbox/status/#status-indicators","title":"Status Indicators","text":""},{"location":"commands/sandbox/status/#clean-state","title":"Clean State","text":"<p><pre><code>Status: Clean\n</code></pre> - No uncommitted changes - No pending layers - Safe to close sandbox or switch branches</p>"},{"location":"commands/sandbox/status/#uncommitted-work","title":"Uncommitted Work","text":"<p><pre><code>Status: Uncommitted changes\n</code></pre> - Changes not yet committed - Should commit or discard before applying</p>"},{"location":"commands/sandbox/status/#ready-to-apply","title":"Ready to Apply","text":"<p><pre><code>Status: Ready to apply (N layers pending)\n</code></pre> - Has committed layers - Can apply to main database - May also have uncommitted changes</p>"},{"location":"commands/sandbox/status/#mixed-state","title":"Mixed State","text":"<p><pre><code>Status: Ready to apply (2 layers pending)\nUncommitted: 1 table added\n</code></pre> - Has both committed and uncommitted changes - Can apply committed layers - Uncommitted changes stay in sandbox or get discarded</p>"},{"location":"commands/sandbox/status/#integration-examples","title":"Integration Examples","text":""},{"location":"commands/sandbox/status/#git-hook","title":"Git Hook","text":"<pre><code>#!/bin/bash\n# .git/hooks/pre-push\n\n# Ensure sandbox is applied before push\nSTATUS=$(dbl sandbox status)\n\nif echo \"$STATUS\" | grep -q \"Active Sandbox\"; then\n    echo \"Error: Active sandbox detected\"\n    echo \"Apply or rollback sandbox before pushing\"\n    exit 1\nfi\n</code></pre>"},{"location":"commands/sandbox/status/#monitoring-script","title":"Monitoring Script","text":"<pre><code>#!/bin/bash\n# monitor-sandbox.sh\n\nwhile true; do\n    clear\n    echo \"=== Sandbox Status ===\"\n    dbl sandbox status\n    echo \"\"\n    echo \"Press Ctrl+C to exit\"\n    sleep 5\ndone\n</code></pre>"},{"location":"commands/sandbox/status/#status-api","title":"Status API","text":"<pre><code># get_sandbox_status.py\nimport subprocess\nimport json\n\nresult = subprocess.run(['dbl', 'sandbox', 'status'], \n                       capture_output=True, text=True)\n\nif result.returncode == 0:\n    print(f\"Status: {result.stdout}\")\nelse:\n    print(\"No active sandbox\")\n</code></pre>"},{"location":"commands/sandbox/status/#output-formats","title":"Output Formats","text":""},{"location":"commands/sandbox/status/#compact-format","title":"Compact Format","text":"<pre><code>$ dbl sandbox status --compact\nmyapp_sandbox: 2 uncommitted, 3 pending\n</code></pre>"},{"location":"commands/sandbox/status/#json-format-future","title":"JSON Format (future)","text":"<pre><code>$ dbl sandbox status --json\n{\n  \"sandbox\": \"myapp_sandbox\",\n  \"base\": \"myapp\",\n  \"created\": \"2024-12-30T10:23:15Z\",\n  \"branch\": \"feature-auth\",\n  \"uncommitted\": 2,\n  \"pending_layers\": [\n    {\"id\": \"L012\", \"message\": \"Add user preferences\"},\n    {\"id\": \"L013\", \"message\": \"Add session tracking\"}\n  ],\n  \"status\": \"ready\"\n}\n</code></pre>"},{"location":"commands/sandbox/status/#error-messages","title":"Error Messages","text":""},{"location":"commands/sandbox/status/#no-database-connection","title":"No Database Connection","text":"<pre><code>Error: Cannot connect to database\nCheck your database configuration in dbl.yaml\n</code></pre>"},{"location":"commands/sandbox/status/#sandbox-database-missing","title":"Sandbox Database Missing","text":"<pre><code>Warning: Sandbox metadata exists but database not found\nThe sandbox may have been deleted manually.\nRun: dbl sandbox rollback\n</code></pre>"},{"location":"commands/sandbox/status/#corrupted-state","title":"Corrupted State","text":"<pre><code>Error: Sandbox state appears corrupted\nMetadata: myapp_sandbox\nDatabase: Not found\n\nTo recover:\n  1. dbl sandbox rollback (clear state)\n  2. dbl sandbox start (start fresh)\n</code></pre>"},{"location":"commands/sandbox/status/#performance","title":"Performance","text":"<p>Status check is fast: - Queries database metadata only - No table scanning - Caches results briefly</p> <pre><code>$ time dbl sandbox status\n# ~0.1s for most databases\n</code></pre>"},{"location":"commands/sandbox/status/#important-notes","title":"Important Notes","text":"<p>Read-Only</p> <p>Status command only reads state, never modifies anything.</p> <p>Check Often</p> <p>Run <code>dbl sandbox status</code> frequently during development to track progress.</p> <p>Metadata vs Reality</p> <p>Status shows DBL's view. Always verify with database tools if something seems wrong.</p>"},{"location":"commands/sandbox/status/#aliases-and-shortcuts","title":"Aliases and Shortcuts","text":"<pre><code># Short form (if implemented)\ndbl status\ndbl s\n\n# Watch mode\nwatch -n 2 dbl sandbox status\n</code></pre>"},{"location":"commands/sandbox/status/#related-workflows","title":"Related Workflows","text":""},{"location":"commands/sandbox/status/#development-workflow","title":"Development Workflow","text":"<pre><code># 1. Check initial state\ndbl sandbox status\n\n# 2. Make changes\n# ... edit database ...\n\n# 3. Check progress\ndbl sandbox status\n\n# 4. Commit when ready\ndbl commit -m \"Changes\"\n\n# 5. Verify commits\ndbl sandbox status\n\n# 6. Apply\ndbl sandbox apply\n</code></pre>"},{"location":"commands/sandbox/status/#review-workflow","title":"Review Workflow","text":"<pre><code># Before code review\ndbl sandbox status &gt; status.txt\ndbl diff &gt; changes.sql\n\n# Share with team\ngit add status.txt changes.sql\ngit commit -m \"Database changes for review\"\n</code></pre>"},{"location":"commands/sandbox/status/#see-also","title":"See Also","text":"<ul> <li><code>dbl diff</code> - See detailed changes</li> <li><code>dbl commit</code> - Commit changes</li> <li><code>dbl sandbox apply</code> - Apply sandbox</li> <li><code>dbl sandbox rollback</code> - Discard sandbox</li> <li><code>dbl log</code> - View layer history</li> </ul>"},{"location":"commands/setup/init/","title":"dbl init","text":"<p>Initialize a DBL project in the current directory.</p>"},{"location":"commands/setup/init/#synopsis","title":"Synopsis","text":"<pre><code>dbl init\n</code></pre>"},{"location":"commands/setup/init/#description","title":"Description","text":"<p>The <code>init</code> command sets up DBL in your project by creating the necessary configuration files and directory structure. This is the first command you should run when starting to use DBL with a database.</p>"},{"location":"commands/setup/init/#what-it-does","title":"What It Does","text":"<ol> <li>Creates <code>dbl.yaml</code>: The main configuration file containing database connection details and settings</li> <li>Creates <code>.dbl/</code> directory: Internal DBL workspace for storing:</li> <li><code>layers/</code>: Version-controlled SQL migrations</li> <li><code>manifest.json</code>: Branch and layer metadata</li> <li><code>state.json</code>: Current database state tracking</li> <li><code>snapshot.sql</code>: Baseline database dump</li> <li>Initializes <code>master</code> branch: Creates the default branch in the manifest</li> </ol>"},{"location":"commands/setup/init/#usage-example","title":"Usage Example","text":"<pre><code># Navigate to your project\ncd my-project\n\n# Initialize DBL\ndbl init\n\n# Output:\n# \u2713 Created dbl.yaml configuration file\n# \u2713 Created .dbl directory structure\n# \u2713 Initialized master branch\n</code></pre>"},{"location":"commands/setup/init/#what-happens-after-init","title":"What Happens After Init","text":"<p>After running <code>init</code>, you need to:</p> <ol> <li> <p>Edit <code>dbl.yaml</code> with your database credentials:    <pre><code>engine: postgres  # or mysql\nhost: localhost\nport: 5432\nuser: myuser\npassword: mypassword\ndatabase: mydb\n</code></pre></p> </li> <li> <p>Import your database (optional):    <pre><code>dbl import snapshot.sql\n</code></pre></p> </li> <li> <p>Start working with sandboxes:    <pre><code>dbl sandbox start\n</code></pre></p> </li> </ol>"},{"location":"commands/setup/init/#configuration-file-dblyaml","title":"Configuration File (dbl.yaml)","text":"<p>The generated <code>dbl.yaml</code> contains:</p> <pre><code>engine: postgres  # Database engine (postgres or mysql)\n\n# Connection details\nhost: localhost\nport: 5432\nuser: your_user\npassword: your_password\ndatabase: your_database\n\n# Optional: Docker support\n# container_name: my_postgres_container\n\n# Optional: Table filtering\nignore_tables: []   # Tables to exclude from tracking\ntrack_tables: []    # Only track these tables (if set)\n\n# Optional: Safety policies\npolicies:\n  allow_data_loss: false  # Prevent destructive operations\n  require_sandbox: true   # Force sandbox usage\n\n# Optional: Validation rules\nvalidate:\n  strict: false              # Treat warnings as errors\n  allow_orphaned: false      # Allow backfill without expand\n  require_comments: false    # Require comments for contract phase\n  detect_type_changes: true  # Warn about column type changes\n</code></pre>"},{"location":"commands/setup/init/#directory-structure","title":"Directory Structure","text":"<p>After initialization:</p> <pre><code>my-project/\n\u251c\u2500\u2500 dbl.yaml              # Configuration file\n\u251c\u2500\u2500 .dbl/                 # DBL workspace (add to .gitignore)\n\u2502   \u251c\u2500\u2500 layers/           # Migration layers\n\u2502   \u2502   \u2514\u2500\u2500 manifest.json # Branch and layer metadata\n\u2502   \u251c\u2500\u2500 snapshot.sql      # Database baseline\n\u2502   \u251c\u2500\u2500 state.json        # Current state\n\u2502   \u2514\u2500\u2500 sandbox.json      # Sandbox metadata (when active)\n\u2514\u2500\u2500 .gitignore            # (recommended) Add .dbl/ here\n</code></pre>"},{"location":"commands/setup/init/#important-notes","title":"Important Notes","text":"<p>Security</p> <p>The <code>dbl.yaml</code> file contains database credentials. Never commit it to version control if it contains sensitive information.</p> <p>Version Control</p> <p>Add <code>.dbl/</code> to your <code>.gitignore</code>: <pre><code>echo \".dbl/\" &gt;&gt; .gitignore\n</code></pre></p> <p>Only track migration layers separately if needed for team collaboration.</p> <p>Docker Support</p> <p>If using Docker, uncomment and set <code>container_name</code> in <code>dbl.yaml</code> to run commands inside the container.</p>"},{"location":"commands/setup/init/#common-issues","title":"Common Issues","text":""},{"location":"commands/setup/init/#already-initialized","title":"Already Initialized","text":"<p>If DBL is already initialized: <pre><code>Error: dbl.yaml already exists\n</code></pre></p> <p>Solution: Remove existing <code>dbl.yaml</code> and <code>.dbl/</code> directory if you want to reinitialize: <pre><code>rm dbl.yaml\nrm -rf .dbl/\ndbl init\n</code></pre></p>"},{"location":"commands/setup/init/#permission-denied","title":"Permission Denied","text":"<p>If you get permission errors: <pre><code>Error: Permission denied creating .dbl/\n</code></pre></p> <p>Solution: Ensure you have write permissions in the current directory or run with appropriate permissions.</p>"},{"location":"commands/setup/init/#next-steps","title":"Next Steps","text":"<p>After initialization:</p> <ol> <li>Configure your database connection</li> <li>Create your first sandbox</li> <li>Make your first migration</li> </ol>"},{"location":"commands/setup/init/#see-also","title":"See Also","text":"<ul> <li><code>dbl import</code> - Import an existing database</li> <li>Configuration Guide</li> <li>Quick Start Tutorial</li> </ul>"},{"location":"commands/setup/update/","title":"dbl update","text":"<p>Check for and install DBL updates.</p>"},{"location":"commands/setup/update/#synopsis","title":"Synopsis","text":"<pre><code>dbl update              # Interactive mode\ndbl update -y           # Auto-confirm\ndbl update --yes        # Auto-confirm (long form)\n</code></pre>"},{"location":"commands/setup/update/#description","title":"Description","text":"<p>Checks GitHub for the latest DBL release, compares with your current version, and optionally installs the update automatically via pip.</p>"},{"location":"commands/setup/update/#options","title":"Options","text":"Option Description <code>-y, --yes</code> Auto-confirm update installation without prompting"},{"location":"commands/setup/update/#what-it-does","title":"What It Does","text":"<ol> <li>Checks dependencies - Verifies PyYAML and other requirements</li> <li>Queries GitHub - Fetches latest release information</li> <li>Compares versions - Checks if update is available</li> <li>Shows release notes - Displays what's new</li> <li>Installs update - Updates via pip (if confirmed)</li> </ol>"},{"location":"commands/setup/update/#usage-examples","title":"Usage Examples","text":""},{"location":"commands/setup/update/#interactive-update","title":"Interactive Update","text":"<pre><code>dbl update\n</code></pre> <p>Output: <pre><code>Checking for updates...\nCurrent version: 0.0.1-alpha\nLatest version: 0.1.0-beta.1\n\n============================================================\n\ud83c\udf89 A new version is available!\n============================================================\n\nRelease notes:\n### Added\n- New sandbox features\n- Improved validation\n- Better error messages\n\n### Fixed\n- Bug in diff command\n- Connection issues with MySQL\n\nDo you want to update to version 0.1.0-beta.1? (y/n): y\n\nInstalling update...\n\u2713 Update successful!\nDBL has been updated to version 0.1.0-beta.1\n\nPlease restart your terminal or run 'hash -r' to use the new version.\n</code></pre></p>"},{"location":"commands/setup/update/#auto-confirm","title":"Auto-confirm","text":"<pre><code>dbl update -y\n</code></pre> <p>Output: <pre><code>Checking for updates...\nCurrent version: 0.0.1-alpha\nLatest version: 0.1.0-beta.1\n\n\ud83c\udf89 A new version is available!\n\nInstalling update...\n\u2713 Update successful!\n</code></pre></p>"},{"location":"commands/setup/update/#already-up-to-date","title":"Already Up to Date","text":"<pre><code>dbl update\n</code></pre> <p>Output: <pre><code>Checking for updates...\nCurrent version: 0.1.0\nLatest version: 0.1.0\n\n\u2713 You are already using the latest version!\n</code></pre></p>"},{"location":"commands/setup/update/#dependency-management","title":"Dependency Management","text":"<p><code>dbl update</code> also checks and installs missing dependencies:</p> <pre><code>dbl update\n</code></pre> <p>Output: <pre><code>\u26a0\ufe0f  Missing required dependencies (PyYAML)\nDo you want to install missing dependencies? (y/n): y\n\nInstalling missing dependencies...\n\u2713 Dependencies installed successfully!\n\nChecking for updates...\n...\n</code></pre></p>"},{"location":"commands/setup/update/#how-it-works","title":"How It Works","text":"<ol> <li> <p>Queries GitHub API:    <pre><code>https://api.github.com/repos/alann-estrada-KSH/dbl-sandbox/releases/latest\n</code></pre></p> </li> <li> <p>Compares versions:</p> </li> <li>Strips pre-release tags for comparison</li> <li> <p><code>0.0.1-alpha</code> vs <code>0.1.0-beta</code> \u2192 compares <code>0.0.1</code> vs <code>0.1.0</code></p> </li> <li> <p>Installs via pip:    <pre><code>pip install --upgrade git+https://github.com/alann-estrada-KSH/dbl-sandbox.git\n</code></pre></p> </li> </ol>"},{"location":"commands/setup/update/#cicd-integration","title":"CI/CD Integration","text":""},{"location":"commands/setup/update/#auto-update-in-ci","title":"Auto-update in CI","text":"<pre><code># .github/workflows/update-dbl.yml\nname: Update DBL\non:\n  schedule:\n    - cron: '0 0 * * 0'  # Weekly\n\njobs:\n  update:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Update DBL\n        run: dbl update -y\n</code></pre>"},{"location":"commands/setup/update/#pre-deployment-check","title":"Pre-deployment Check","text":"<pre><code># Before deploying migrations\ndbl update -y\ndbl version\n</code></pre>"},{"location":"commands/setup/update/#manual-update-alternative","title":"Manual Update Alternative","text":"<p>If <code>dbl update</code> fails:</p> <pre><code># Via pip\npip install --upgrade git+https://github.com/alann-estrada-KSH/dbl-sandbox.git\n\n# Verify\ndbl version\n</code></pre>"},{"location":"commands/setup/update/#important-notes","title":"Important Notes","text":"<p>Internet Required</p> <p>This command requires an internet connection to check GitHub.</p> <p>Restart Terminal</p> <p>After updating, restart your terminal or run <code>hash -r</code> (Unix) / <code>refreshenv</code> (Windows) to ensure the new version is used.</p> <p>Pre-releases</p> <p>DBL update includes alpha and beta versions. Check release notes before updating.</p>"},{"location":"commands/setup/update/#troubleshooting","title":"Troubleshooting","text":""},{"location":"commands/setup/update/#connection-error","title":"Connection Error","text":"<p>Error: <pre><code>Could not connect to GitHub\nPlease check your internet connection.\n</code></pre></p> <p>Solution: 1. Check internet connection 2. Verify GitHub is accessible 3. Try manual update with pip</p>"},{"location":"commands/setup/update/#permission-error","title":"Permission Error","text":"<p>Error: <pre><code>Permission denied during installation\n</code></pre></p> <p>Solution: <pre><code># User install\npip install --user --upgrade git+https://github.com/...\n\n# Or use sudo (Unix)\nsudo dbl update -y\n</code></pre></p>"},{"location":"commands/setup/update/#pip-not-found","title":"Pip Not Found","text":"<p>Error: <pre><code>pip: command not found\n</code></pre></p> <p>Solution: <pre><code>python -m pip install --upgrade git+https://github.com/...\n</code></pre></p>"},{"location":"commands/setup/update/#no-releases-found","title":"No Releases Found","text":"<p>Error: <pre><code>No releases found in repository\n</code></pre></p> <p>Solution: - Wait for first release to be published - Use manual git pull and install</p>"},{"location":"commands/setup/update/#version-comparison-logic","title":"Version Comparison Logic","text":"<p>DBL compares versions intelligently:</p> <pre><code># Example comparisons\n\"0.0.1-alpha\" &lt; \"0.1.0-beta\"   # True\n\"0.1.0\" == \"0.1.0-alpha\"       # True (ignores pre-release for comparison)\n\"1.0.0\" &gt; \"0.9.9\"              # True\n</code></pre>"},{"location":"commands/setup/update/#release-information","title":"Release Information","text":"<p>Each update shows:</p> <ul> <li>Version number</li> <li>Release date</li> <li>Release notes:</li> <li>Added features</li> <li>Changed behavior</li> <li>Fixed bugs</li> <li>Breaking changes</li> </ul>"},{"location":"commands/setup/update/#automation-scripts","title":"Automation Scripts","text":""},{"location":"commands/setup/update/#daily-update-check","title":"Daily Update Check","text":"<pre><code>#!/bin/bash\n# check-updates.sh\n\nOUTPUT=$(dbl update -y 2&gt;&amp;1)\nif echo \"$OUTPUT\" | grep -q \"Update successful\"; then\n    echo \"DBL updated successfully\"\n    # Notify team\n    curl -X POST webhook-url -d \"DBL updated\"\nfi\n</code></pre>"},{"location":"commands/setup/update/#pre-commit-hook","title":"Pre-commit Hook","text":"<pre><code>#!/bin/bash\n# .git/hooks/pre-commit\n\n# Ensure DBL is up to date\ndbl update -y --quiet\n</code></pre>"},{"location":"commands/setup/update/#configuration","title":"Configuration","text":"<p>Control update behavior in <code>dbl.yaml</code> (future):</p> <pre><code># Future feature\nupdates:\n  auto_check: true         # Check on every command\n  auto_install: false      # Don't auto-install\n  channel: stable          # stable, beta, alpha\n</code></pre>"},{"location":"commands/setup/update/#see-also","title":"See Also","text":"<ul> <li><code>dbl version</code> - Check current version</li> <li>Changelog - See what's new</li> <li>Installation - Install methods</li> </ul>"},{"location":"commands/setup/validate/","title":"dbl validate","text":"<p>Validate layer integrity and database schema consistency.</p>"},{"location":"commands/setup/validate/#synopsis","title":"Synopsis","text":"<pre><code>dbl validate                    # Validate everything\ndbl validate --layers           # Validate layers only\ndbl validate --schema           # Validate schema only\ndbl validate --fix              # Auto-fix issues\n</code></pre>"},{"location":"commands/setup/validate/#description","title":"Description","text":"<p>Checks for: - Layer file integrity - SQL syntax errors - Schema consistency - State file corruption - Missing dependencies</p>"},{"location":"commands/setup/validate/#options","title":"Options","text":"Option Description <code>--layers</code> Validate layer files only <code>--schema</code> Validate database schema only <code>--fix</code> Automatically fix detected issues <code>--strict</code> Fail on warnings (not just errors)"},{"location":"commands/setup/validate/#usage-examples","title":"Usage Examples","text":""},{"location":"commands/setup/validate/#full-validation","title":"Full Validation","text":"<pre><code>dbl validate\n</code></pre> <p>Output: <pre><code>Validating DBL repository...\n\n\u2713 Configuration (dbl.yaml)\n\u2713 State file (.dbl/state.json)\n\u2713 Layer files (15 layers)\n\u2713 SQL syntax\n\u2713 Database schema\n\u2713 Layer sequence\n\nAll checks passed!\nRepository is healthy.\n</code></pre></p>"},{"location":"commands/setup/validate/#layer-validation","title":"Layer Validation","text":"<pre><code>dbl validate --layers\n</code></pre> <p>Output: <pre><code>Validating layers...\n\n\u2713 L001_initial_schema.sql - OK\n\u2713 L002_add_users.sql - OK\n\u2713 L003_add_posts.sql - OK\n\u26a0 L004_add_indexes.sql - Warning: Index already exists\n\u2713 L005_add_comments.sql - OK\n\n5 layers checked, 1 warning\n</code></pre></p>"},{"location":"commands/setup/validate/#schema-validation","title":"Schema Validation","text":"<pre><code>dbl validate --schema\n</code></pre> <p>Output: <pre><code>Validating database schema...\n\n\u2713 Tables match expected state\n\u2713 Indexes are correct\n\u2713 Foreign keys intact\n\u2713 Constraints valid\n\nSchema is consistent with layers.\n</code></pre></p>"},{"location":"commands/setup/validate/#with-auto-fix","title":"With Auto-fix","text":"<pre><code>dbl validate --fix\n</code></pre> <p>Output: <pre><code>Validating with auto-fix...\n\n\u26a0 Issue: Missing layer index in state file\n  \u2192 Fixed: Regenerated state index\n\n\u26a0 Issue: Duplicate layer L005\n  \u2192 Fixed: Renamed to L006\n\n\u2713 All issues resolved\n</code></pre></p>"},{"location":"commands/setup/validate/#what-it-checks","title":"What It Checks","text":""},{"location":"commands/setup/validate/#1-configuration","title":"1. Configuration","text":"<pre><code># Checks dbl.yaml\n\u2713 File exists\n\u2713 Valid YAML syntax\n\u2713 Required fields present\n\u2713 Database connection valid\n</code></pre>"},{"location":"commands/setup/validate/#2-state-files","title":"2. State Files","text":"<pre><code>\u2713 .dbl/state.json exists\n\u2713 Valid JSON\n\u2713 Branch information correct\n\u2713 Layer tracking accurate\n</code></pre>"},{"location":"commands/setup/validate/#3-layer-files","title":"3. Layer Files","text":"<pre><code>\u2713 Sequential numbering (L001, L002, L003...)\n\u2713 No gaps in sequence\n\u2713 Valid SQL syntax\n\u2713 File naming convention\n\u2713 Commit messages present\n</code></pre>"},{"location":"commands/setup/validate/#4-sql-syntax","title":"4. SQL Syntax","text":"<pre><code>-- Validates SQL in each layer\n\u2713 CREATE TABLE syntax\n\u2713 ALTER TABLE syntax\n\u2713 INDEX definitions\n\u2713 Constraint syntax\n</code></pre>"},{"location":"commands/setup/validate/#5-database-schema","title":"5. Database Schema","text":"<pre><code>\u2713 Current schema matches layers\n\u2713 No manual changes detected\n\u2713 All tables accounted for\n\u2713 Indexes match definitions\n</code></pre>"},{"location":"commands/setup/validate/#6-dependencies","title":"6. Dependencies","text":"<pre><code>\u2713 Database engine available\n\u2713 Required Python packages\n\u2713 Database credentials valid\n</code></pre>"},{"location":"commands/setup/validate/#complete-examples","title":"Complete Examples","text":""},{"location":"commands/setup/validate/#pre-deployment-check","title":"Pre-deployment Check","text":"<pre><code># Before deploying to production\n$ dbl validate --strict\n\nValidating DBL repository (strict mode)...\n\n\u2713 Configuration\n\u2713 State files\n\u2713 Layer files (20 layers)\n\u2713 SQL syntax\n\u26a0 Warning: Layer L015 has no rollback\n\u2717 Error: Strict mode - warnings treated as errors\n\nValidation failed.\nFix warnings before deploying.\n</code></pre>"},{"location":"commands/setup/validate/#find-corrupted-layers","title":"Find Corrupted Layers","text":"<pre><code>$ dbl validate --layers\n\nValidating layers...\n\n\u2713 L001_initial_schema.sql\n\u2713 L002_add_users.sql\n\u2717 L003_add_posts.sql - Syntax error at line 15\n\u2713 L004_add_indexes.sql\n\nLayer L003 has errors. Check SQL syntax.\n</code></pre>"},{"location":"commands/setup/validate/#verify-after-reset","title":"Verify After Reset","text":"<pre><code># Reset database\n$ dbl reset\n\n# Validate result\n$ dbl validate --schema\n\n\u2713 Schema matches layer L015\n\u2713 All tables present\n\u2713 No extra tables found\n\nDatabase is in expected state.\n</code></pre>"},{"location":"commands/setup/validate/#issue-detection","title":"Issue Detection","text":""},{"location":"commands/setup/validate/#common-issues","title":"Common Issues","text":""},{"location":"commands/setup/validate/#missing-layers","title":"Missing Layers","text":"<pre><code>\u2717 Layer L003 missing\n  Expected: L001, L002, L003, L004\n  Found: L001, L002, L004\n</code></pre> <p>Fix: <pre><code># Renumber layers\nmv .dbl/layers/L004_*.sql .dbl/layers/L003_*.sql\ndbl validate --fix\n</code></pre></p>"},{"location":"commands/setup/validate/#sql-syntax-error","title":"SQL Syntax Error","text":"<pre><code>\u2717 L005_add_comments.sql:12\n  ERROR: syntax error at or near \"TALBE\"\n  CREATE TALBE comments (...)\n         ^\n</code></pre> <p>Fix: <pre><code># Edit layer file\nnano .dbl/layers/L005_add_comments.sql\n# Fix: TALBE \u2192 TABLE\ndbl validate\n</code></pre></p>"},{"location":"commands/setup/validate/#schema-mismatch","title":"Schema Mismatch","text":"<pre><code>\u26a0 Database has extra table 'temp_data'\n  Not defined in any layer.\n</code></pre> <p>Fix: <pre><code># Option 1: Commit the change\ndbl sandbox start\n# Make matching changes\ndbl commit -m \"Add temp_data table\"\n\n# Option 2: Drop manual change\npsql -d myapp -c \"DROP TABLE temp_data;\"\n</code></pre></p>"},{"location":"commands/setup/validate/#duplicate-layer-id","title":"Duplicate Layer ID","text":"<pre><code>\u2717 Duplicate layer ID: L008\n  Files: L008_add_auth.sql, L008_add_profiles.sql\n</code></pre> <p>Fix: <pre><code># Renumber one\nmv .dbl/layers/L008_add_profiles.sql \\\n   .dbl/layers/L009_add_profiles.sql\ndbl validate --fix\n</code></pre></p>"},{"location":"commands/setup/validate/#cicd-integration","title":"CI/CD Integration","text":""},{"location":"commands/setup/validate/#pre-merge-validation","title":"Pre-merge Validation","text":"<pre><code># .github/workflows/validate.yml\nname: Validate DBL\n\non: [pull_request]\n\njobs:\n  validate:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Install DBL\n        run: pip install git+https://github.com/...\n\n      - name: Validate\n        run: dbl validate --strict\n\n      - name: Validate SQL\n        run: dbl validate --layers\n</code></pre>"},{"location":"commands/setup/validate/#pre-deployment-gate","title":"Pre-deployment Gate","text":"<pre><code>#!/bin/bash\n# deploy.sh\n\n# Validate before deploying\nif ! dbl validate --strict; then\n    echo \"Validation failed. Aborting deployment.\"\n    exit 1\nfi\n\n# Deploy\ndbl --config production.yaml sandbox apply\n</code></pre>"},{"location":"commands/setup/validate/#scheduled-checks","title":"Scheduled Checks","text":"<pre><code># .github/workflows/nightly-validation.yml\nname: Nightly Validation\n\non:\n  schedule:\n    - cron: '0 0 * * *'\n\njobs:\n  validate:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      - name: Full validation\n        run: dbl validate --strict\n</code></pre>"},{"location":"commands/setup/validate/#validation-levels","title":"Validation Levels","text":""},{"location":"commands/setup/validate/#basic-default","title":"Basic (default)","text":"<pre><code>dbl validate\n# Checks: layers, state, configuration\n# Fails on: errors only\n</code></pre>"},{"location":"commands/setup/validate/#strict","title":"Strict","text":"<pre><code>dbl validate --strict\n# Checks: layers, state, configuration, best practices\n# Fails on: errors AND warnings\n</code></pre>"},{"location":"commands/setup/validate/#quick","title":"Quick","text":"<pre><code>dbl validate --quick\n# Checks: basic file integrity\n# Skips: SQL parsing, schema checks\n</code></pre>"},{"location":"commands/setup/validate/#auto-fix-capabilities","title":"Auto-fix Capabilities","text":""},{"location":"commands/setup/validate/#what-can-be-fixed","title":"What Can Be Fixed","text":"<ul> <li>\u2705 State file regeneration</li> <li>\u2705 Layer renumbering</li> <li>\u2705 Metadata updates</li> <li>\u2705 File naming standardization</li> </ul>"},{"location":"commands/setup/validate/#what-requires-manual-fix","title":"What Requires Manual Fix","text":"<ul> <li>\u274c SQL syntax errors</li> <li>\u274c Schema conflicts</li> <li>\u274c Missing database</li> <li>\u274c Logic errors in layers</li> </ul>"},{"location":"commands/setup/validate/#performance","title":"Performance","text":"<p>Validation speed:</p> <ul> <li>Layers only: ~0.1s per layer</li> <li>Schema check: ~0.5s per database</li> <li>Full validation: ~2-5s typical</li> </ul> <pre><code>$ time dbl validate\nreal    0m2.341s\n</code></pre>"},{"location":"commands/setup/validate/#error-codes","title":"Error Codes","text":"<p>DBL validate returns exit codes:</p> Code Meaning 0 All checks passed 1 Warnings found (non-strict) 2 Errors found 3 Critical failure <pre><code># Use in scripts\nif dbl validate; then\n    echo \"Valid\"\nelse\n    echo \"Invalid (code: $?)\"\nfi\n</code></pre>"},{"location":"commands/setup/validate/#reporting","title":"Reporting","text":""},{"location":"commands/setup/validate/#summary-report","title":"Summary Report","text":"<pre><code>$ dbl validate\n\nSummary:\n  Layers: 15 checked, 0 errors, 1 warning\n  Schema: Consistent\n  State: Valid\n  Config: Valid\n\nOverall: PASS (with warnings)\n</code></pre>"},{"location":"commands/setup/validate/#detailed-report","title":"Detailed Report","text":"<pre><code>$ dbl validate --verbose\n\nConfiguration Check:\n  \u2713 dbl.yaml found\n  \u2713 Database: myapp\n  \u2713 Engine: postgres\n  \u2713 Connection: OK\n\nState Check:\n  \u2713 .dbl/state.json valid\n  \u2713 Current branch: main\n  \u2713 Last layer: L015\n\nLayer Check:\n  \u2713 L001_initial_schema.sql (345 bytes)\n  \u2713 L002_add_users.sql (521 bytes)\n  ...\n  \u2713 L015_add_webhooks.sql (892 bytes)\n\nSchema Check:\n  \u2713 Tables: 12 expected, 12 found\n  \u2713 Indexes: 24 expected, 24 found\n  \u2713 Constraints: 8 expected, 8 found\n\nAll checks passed!\n</code></pre>"},{"location":"commands/setup/validate/#json-output","title":"JSON Output","text":"<pre><code>$ dbl validate --json\n{\n  \"status\": \"pass\",\n  \"errors\": 0,\n  \"warnings\": 1,\n  \"checks\": {\n    \"config\": \"pass\",\n    \"state\": \"pass\",\n    \"layers\": \"pass\",\n    \"schema\": \"pass\"\n  },\n  \"warnings\": [\n    {\n      \"layer\": \"L004\",\n      \"message\": \"Index already exists\"\n    }\n  ]\n}\n</code></pre>"},{"location":"commands/setup/validate/#important-notes","title":"Important Notes","text":"<p>Validate Often</p> <p>Run <code>dbl validate</code> frequently during development to catch issues early.</p> <p>Strict in CI</p> <p>Always use <code>--strict</code> in CI/CD pipelines to enforce quality.</p> <p>Read-only</p> <p>Validation without <code>--fix</code> never modifies anything.</p>"},{"location":"commands/setup/validate/#best-practices","title":"Best Practices","text":"<ol> <li> <p>Validate before commit:    <pre><code>dbl validate &amp;&amp; dbl commit -m \"Changes\"\n</code></pre></p> </li> <li> <p>Validate before apply:    <pre><code>dbl validate --strict &amp;&amp; dbl sandbox apply\n</code></pre></p> </li> <li> <p>Regular checks:    <pre><code># Add to daily routine\ndbl validate\n</code></pre></p> </li> <li> <p>CI integration:    <pre><code># Always validate in CI\n- run: dbl validate --strict\n</code></pre></p> </li> </ol>"},{"location":"commands/setup/validate/#troubleshooting","title":"Troubleshooting","text":""},{"location":"commands/setup/validate/#false-positives","title":"False Positives","text":"<p>Some warnings may be expected:</p> <pre><code># Suppress specific warnings\ndbl validate --ignore-warning index-exists\n</code></pre>"},{"location":"commands/setup/validate/#validation-hangs","title":"Validation Hangs","text":"<p>If validation hangs on schema check:</p> <pre><code># Check database connection\npsql -d myapp -c \"SELECT 1;\"\n\n# Skip schema check if needed\ndbl validate --layers\n</code></pre>"},{"location":"commands/setup/validate/#permission-issues","title":"Permission Issues","text":"<pre><code># Validate without database access\ndbl validate --no-db\n</code></pre>"},{"location":"commands/setup/validate/#see-also","title":"See Also","text":"<ul> <li><code>dbl reset</code> - Rebuild and test layers</li> <li><code>dbl commit</code> - Create validated layers</li> <li><code>dbl log</code> - Review layer history</li> <li>Best Practices - Validation guidelines</li> </ul>"},{"location":"commands/setup/version/","title":"dbl version","text":"<p>Display DBL version information.</p>"},{"location":"commands/setup/version/#synopsis","title":"Synopsis","text":"<pre><code>dbl version\n</code></pre>"},{"location":"commands/setup/version/#description","title":"Description","text":"<p>Shows the currently installed version of DBL along with the repository URL.</p>"},{"location":"commands/setup/version/#usage-example","title":"Usage Example","text":"<pre><code>dbl version\n</code></pre> <p>Output: <pre><code>DBL (Database Layering) v0.0.1-alpha\nRepository: https://github.com/alann-estrada-KSH/dbl-sandbox\n</code></pre></p>"},{"location":"commands/setup/version/#version-format","title":"Version Format","text":"<p>DBL follows Semantic Versioning:</p> <pre><code>MAJOR.MINOR.PATCH-prerelease\n</code></pre>"},{"location":"commands/setup/version/#examples","title":"Examples","text":"<ul> <li><code>0.0.1-alpha</code> - Alpha pre-release</li> <li><code>0.1.0-beta.1</code> - Beta pre-release  </li> <li><code>0.1.0-rc.1</code> - Release candidate</li> <li><code>1.0.0</code> - Stable release</li> </ul>"},{"location":"commands/setup/version/#pre-release-tags","title":"Pre-release Tags","text":"Tag Stage Stability <code>alpha</code> Early development Unstable, frequent changes <code>beta</code> Feature complete Stabilizing <code>rc</code> Release candidate Final testing (none) Stable Production ready"},{"location":"commands/setup/version/#checking-for-updates","title":"Checking for Updates","text":"<p>After checking your version, update to the latest:</p> <pre><code># Check current version\ndbl version\n\n# Update to latest\ndbl update\n</code></pre>"},{"location":"commands/setup/version/#version-history","title":"Version History","text":"<p>View changelog:</p> <pre><code># Online\n# Visit: https://github.com/alann-estrada-KSH/dbl-sandbox/releases\n\n# Or in docs\ncat docs/changelog.md\n</code></pre>"},{"location":"commands/setup/version/#use-cases","title":"Use Cases","text":""},{"location":"commands/setup/version/#verify-installation","title":"Verify Installation","text":"<pre><code>dbl version\n# Confirms DBL is installed and accessible\n</code></pre>"},{"location":"commands/setup/version/#bug-reports","title":"Bug Reports","text":"<p>Always include version when reporting issues:</p> <pre><code>$ dbl version\nDBL (Database Layering) v0.0.1-alpha\n\n# Include this in bug report\n</code></pre>"},{"location":"commands/setup/version/#cicd","title":"CI/CD","text":"<p>Check version in pipelines:</p> <pre><code># .github/workflows/test.yml\n- name: Check DBL version\n  run: dbl version\n</code></pre>"},{"location":"commands/setup/version/#see-also","title":"See Also","text":"<ul> <li><code>dbl update</code> - Update to latest version</li> <li><code>dbl help</code> - Show available commands</li> <li>Changelog - Version history</li> </ul>"},{"location":"es/","title":"DBL - Database Layering","text":"<p>Control de versiones tipo Git para bases de datos</p>"},{"location":"es/#que-es-dbl","title":"\u00bfQu\u00e9 es DBL?","text":"<p>DBL (Database Layering) es un sistema de control de versiones para bases de datos, similar a Git pero dise\u00f1ado espec\u00edficamente para la evoluci\u00f3n del esquema de bases de datos.</p>"},{"location":"es/#capacidades-clave","title":"Capacidades Clave","text":"<ul> <li>\ud83c\udf3f Ramifica tu esquema - Trabaja en m\u00faltiples features en paralelo</li> <li>\ud83d\udd12 Pruebas en sandbox - Experimenta sin afectar tu base de datos</li> <li>\ud83d\udce6 Capas de cambios - Control de versiones para todas tus migraciones SQL</li> <li>\u2705 Migraciones validadas - Controles integrados para cambios seguros</li> <li>\ud83d\udd04 Reconstrucciones reproducibles - Reconstrucci\u00f3n determinista de BD</li> </ul>"},{"location":"es/#inicio-rapido","title":"Inicio R\u00e1pido","text":"<pre><code># 1. Inicializa proyecto\ndbl init\n\n# 2. Crea sandbox de desarrollo\ndbl sandbox start\n\n# 3. Realiza tus cambios\n# Usa tu cliente de BD favorito para modificar el esquema\n\n# 4. Guarda tus cambios\ndbl commit -m \"Agregar tabla user_preferences\"\n\n# 5. Aplica a la base de datos principal\ndbl sandbox apply\n</code></pre>"},{"location":"es/#caracteristicas-principales","title":"Caracter\u00edsticas Principales","text":""},{"location":"es/#experimentacion-segura-con-sandboxes","title":"Experimentaci\u00f3n Segura con Sandboxes","text":"<p>Trabaja en un sandbox aislado - una copia temporal de tu base de datos donde puedes probar cambios sin riesgo alguno a producci\u00f3n o desarrollo.</p>"},{"location":"es/#historial-completo-de-capas","title":"Historial Completo de Capas","text":"<p>Cada cambio se guarda como una capa numerada (como commits de Git), creando un historial completo y auditable de la evoluci\u00f3n de tu base de datos. Ver el historial en cualquier momento con <code>dbl log</code>.</p>"},{"location":"es/#ramificacion-tipo-git","title":"Ramificaci\u00f3n tipo Git","text":"<p>Crea ramas para diferentes features:</p> <pre><code>dbl branch create feature/authentication\ndbl checkout feature/authentication\n# ... realiza tus cambios ...\ndbl checkout main\ndbl merge feature/authentication\n</code></pre>"},{"location":"es/#bases-de-datos-soportadas","title":"Bases de Datos Soportadas","text":"<ul> <li>\u2705 PostgreSQL 11+</li> <li>\u2705 MySQL 5.7+</li> <li>\ud83d\udd04 SQLite (planeado)</li> </ul>"},{"location":"es/#instalacion","title":"Instalaci\u00f3n","text":"<p>Instala DBL con pip:</p> <pre><code>pip install dbl\n</code></pre> <p>O clona desde GitHub para desarrollo:</p> <pre><code>git clone https://github.com/alann-estrada-KSH/dbl-sandbox.git\ncd dbl-sandbox\npip install -e .\n</code></pre>"},{"location":"es/#aprende-mas","title":"Aprende M\u00e1s","text":""},{"location":"es/#comienza-aqui","title":"Comienza Aqu\u00ed","text":"<p>\u00bfNuevo en DBL? Comienza aqu\u00ed:</p> <ul> <li>Gu\u00eda de Instalaci\u00f3n - Instrucciones de setup detalladas</li> <li>Tutorial R\u00e1pido - Tus primeros cambios en 5 minutos</li> <li>Primera Migraci\u00f3n - Ejemplo completo paso a paso</li> </ul>"},{"location":"es/#referencia","title":"Referencia","text":"<p>\u00bfNecesitas ayuda con un comando espec\u00edfico?</p> <ul> <li>Todos los Comandos - Referencia completa de comandos</li> <li>Gesti\u00f3n de Sandbox - Trabaja con sandboxes</li> <li>Gu\u00eda de Ramas - Gesti\u00f3n de ramas</li> </ul>"},{"location":"es/#analisis-profundos","title":"An\u00e1lisis Profundos","text":"<p>Aprende arquitectura y patrones:</p> <ul> <li>Visi\u00f3n General de Arquitectura - C\u00f3mo funciona DBL</li> <li>Bases de Datos Soportadas - PostgreSQL, MySQL, m\u00e1s</li> <li>Mejores Pr\u00e1cticas - Consejos para equipos y proyectos</li> <li>Configuraci\u00f3n - Opciones de setup avanzado</li> </ul>"},{"location":"es/#ayuda-y-recursos","title":"Ayuda y Recursos","text":"<ul> <li>FAQ - 40+ preguntas frecuentes respondidas</li> <li>Soluci\u00f3n de Problemas - Resuelve problemas comunes</li> <li>Changelog - Historial de versiones y cambios</li> </ul>"},{"location":"es/#flujos-de-trabajo-comunes","title":"Flujos de Trabajo Comunes","text":""},{"location":"es/#agregando-una-nueva-feature","title":"Agregando una Nueva Feature","text":"<pre><code># Crea rama de feature\ndbl branch create feature/payments\n\n# Cambia a rama de feature\ndbl checkout feature/payments\n\n# Crea sandbox\ndbl sandbox start\n\n# Realiza cambios de esquema usando tu cliente de BD\n# ... CREATE TABLE payments ...\n# ... CREATE INDEX idx_payments ...\n\n# Revisa cambios\ndbl diff\n\n# Guarda cambios\ndbl commit -m \"Agregar tabla de pagos con \u00edndices\"\n\n# Aplica a la BD de la rama de feature\ndbl sandbox apply\n\n# Vuelve a main\ndbl checkout main\n\n# Fusiona cambios\ndbl merge feature/payments\n</code></pre>"},{"location":"es/#testeando-migraciones","title":"Testeando Migraciones","text":"<pre><code># Prueba en un ambiente limpio\ndbl sandbox start\n\n# Reconstruye BD desde todas las capas\ndbl reset\n\n# Ejecuta tus tests de aplicaci\u00f3n\n./run-tests.sh\n\n# Verifica que el esquema coincida\ndbl validate\n\n# Despliega cuando est\u00e9 listo\ndbl sandbox apply\n</code></pre>"},{"location":"es/#por-que-dbl","title":"\u00bfPor Qu\u00e9 DBL?","text":""},{"location":"es/#a-diferencia-de-scripts-sql-raw","title":"A Diferencia de Scripts SQL Raw","text":"<ul> <li>\u2705 Versionado con Git</li> <li>\u2705 Sin ordenamiento manual de migraciones</li> <li>\u2705 Pruebas seguras en sandbox</li> <li>\u2705 Auditor\u00eda completa</li> </ul>"},{"location":"es/#a-diferencia-de-migraciones-de-orm-alembic-django","title":"A Diferencia de Migraciones de ORM (Alembic, Django)","text":"<ul> <li>\u2705 Agn\u00f3stico de BD (PostgreSQL, MySQL, SQLite)</li> <li>\u2705 SQL puro - sin dependencia de framework</li> <li>\u2705 Portable entre proyectos</li> <li>\u2705 Funciona con cualquier lenguaje de programaci\u00f3n</li> </ul>"},{"location":"es/#a-diferencia-de-herramientas-de-migracion-flyway-liquibase","title":"A Diferencia de Herramientas de Migraci\u00f3n (Flyway, Liquibase)","text":"<ul> <li>\u2705 Ramificaci\u00f3n tipo Git para trabajo paralelo</li> <li>\u2705 Sandbox para pruebas seguras</li> <li>\u2705 Configuraci\u00f3n YAML simple</li> <li>\u2705 F\u00e1cil de aprender y usar</li> </ul>"},{"location":"es/#contribuir","title":"Contribuir","text":"<p>\u00a1Bienvenidas las contribuciones! Aqu\u00ed hay formas de ayudar:</p> <ul> <li>\ud83d\udc1b Reportar bugs</li> <li>\ud83d\udca1 Sugerir features</li> <li>\ud83d\udcda Mejorar documentaci\u00f3n</li> <li>\ud83d\udcbb Enviar c\u00f3digo</li> </ul>"},{"location":"es/#licencia","title":"Licencia","text":"<p>DBL est\u00e1 licenciado bajo Apache 2.0. Ver LICENSE para detalles.</p>"},{"location":"es/#soporte","title":"Soporte","text":"<ul> <li>\ud83d\udc19 GitHub: alann-estrada-KSH/dbl-sandbox</li> <li>\ud83d\udcdd Issues: Reporta un bug</li> <li>\ud83d\udcac Discussions: Haz una pregunta</li> </ul> <p>Hecho con \u2764\ufe0f por Alan Estrada</p>"},{"location":"es/changelog/","title":"Changelog","text":"<p>Historial de cambios en DBL.</p>"},{"location":"es/changelog/#220-2024-12-30","title":"[2.2.0] - 2024-12-30","text":""},{"location":"es/changelog/#agregado","title":"Agregado","text":"<ul> <li>Nuevo comando <code>dbl update</code> para actualizar autom\u00e1ticamente DBL</li> <li>Detecci\u00f3n y instalaci\u00f3n autom\u00e1tica de dependencias faltantes</li> <li>Soporte mejorado para MySQL 8.0</li> <li>Comando <code>dbl validate</code> para validar integridad de esquema</li> <li>Mejores mensajes de error con sugerencias de soluci\u00f3n</li> </ul>"},{"location":"es/changelog/#mejorado","title":"Mejorado","text":"<ul> <li>Performance de reset en bases de datos grandes (40% m\u00e1s r\u00e1pido)</li> <li>Interfaz de usuario m\u00e1s clara con colores y emojis</li> <li>Documentaci\u00f3n completa en ingl\u00e9s y espa\u00f1ol</li> <li>Validaci\u00f3n de SQL antes de aplicar cambios</li> </ul>"},{"location":"es/changelog/#corregido","title":"Corregido","text":"<ul> <li>Problema con conexi\u00f3n perdida durante sandbox apply</li> <li>Issue con caracteres especiales en nombres de tablas</li> <li>Manejo de permisos en PostgreSQL</li> </ul>"},{"location":"es/changelog/#breaking-changes","title":"Breaking Changes","text":"<ul> <li>Deprecated <code>dbl config</code> (usar <code>dbl init</code> en su lugar)</li> </ul>"},{"location":"es/changelog/#210-2024-11-15","title":"[2.1.0] - 2024-11-15","text":""},{"location":"es/changelog/#agregado_1","title":"Agregado","text":"<ul> <li>Soporte para ramas de base de datos (branching)</li> <li>Comando <code>dbl merge</code> para fusionar ramas</li> <li>Comando <code>dbl branch</code> para gestionar ramas</li> </ul>"},{"location":"es/changelog/#mejorado_1","title":"Mejorado","text":"<ul> <li>Mejor manejo de transacciones</li> <li>Mensajes de commit m\u00e1s descriptivos</li> <li>UI mejorada con mejor feedback</li> </ul>"},{"location":"es/changelog/#corregido_1","title":"Corregido","text":"<ul> <li>Issue con caracteres UTF-8 en SQL</li> <li>Problema de timezone en timestamps</li> <li>Bug en validaci\u00f3n de constraints</li> </ul>"},{"location":"es/changelog/#200-2024-09-01","title":"[2.0.0] - 2024-09-01","text":""},{"location":"es/changelog/#agregado_2","title":"Agregado","text":"<ul> <li>\u00a1Lanzamiento de DBL 2.0!</li> <li>Nuevo modelo de sandbox mejorado</li> <li>Sistema de capas completamente redise\u00f1ado</li> <li>Soporte para PostgreSQL 13+</li> <li>Soporte mejorado para MySQL 5.7+</li> </ul>"},{"location":"es/changelog/#mejorado_2","title":"Mejorado","text":"<ul> <li>API completamente redise\u00f1ada (incompatible con 1.x)</li> <li>Rendimiento 10x mejor</li> <li>C\u00f3digo m\u00e1s limpio y mantenible</li> </ul>"},{"location":"es/changelog/#removido","title":"Removido","text":"<ul> <li>Soporte para PostgreSQL &lt; 11</li> <li>Legacy command structure</li> </ul>"},{"location":"es/changelog/#152-2024-06-15-legacy","title":"[1.5.2] - 2024-06-15 (Legacy)","text":""},{"location":"es/changelog/#corregido_2","title":"Corregido","text":"<ul> <li>Bug en manejo de \u00edndices</li> <li>Issue con constraints duplicados</li> </ul>"},{"location":"es/changelog/#deprecado","title":"Deprecado","text":"<ul> <li>Esta versi\u00f3n est\u00e1 deprecated. Usar 2.0+</li> </ul>"},{"location":"es/changelog/#notas-de-actualizacion","title":"Notas de Actualizaci\u00f3n","text":""},{"location":"es/changelog/#de-1x-a-20","title":"De 1.x a 2.0+","text":"<p>Cambios importantes:</p> <pre><code>1.x: dbl create-table users ...\n2.0: dbl sandbox start\n     # ... cambios ...\n     dbl commit -m \"Create users table\"\n</code></pre> <p>Ver gu\u00eda de actualizaci\u00f3n para m\u00e1s detalles.</p>"},{"location":"es/changelog/#de-20-a-22","title":"De 2.0 a 2.2+","text":"<p>Cambios menores. Compatible hacia atr\u00e1s.</p>"},{"location":"es/changelog/#roadmap-futuro","title":"Roadmap Futuro","text":""},{"location":"es/changelog/#v30-planeado-para-q2-2025","title":"v3.0 (Planeado para Q2 2025)","text":"<ul> <li> Soporte para MariaDB</li> <li> Soporte para SQLite</li> <li> API GraphQL para DBL</li> <li> Dashboard web</li> </ul>"},{"location":"es/changelog/#futuro-lejano","title":"Futuro Lejano","text":"<ul> <li> Soporte para SQL Server</li> <li> Integraci\u00f3n con Kubernetes</li> <li> Replicaci\u00f3n autom\u00e1tica entre ambientes</li> <li> Machine learning para detectar problemas</li> </ul>"},{"location":"es/changelog/#descargas","title":"Descargas","text":"<ul> <li>GitHub Releases</li> <li>PyPI</li> </ul>"},{"location":"es/changelog/#contribuir","title":"Contribuir","text":"<p>Reportar bugs y sugerir features: - Issues en GitHub - Discussions</p>"},{"location":"es/changelog/#licencia","title":"Licencia","text":"<p>DBL es open source bajo licencia Apache 2.0.</p> <p>Ver LICENSE para detalles.</p>"},{"location":"es/commands/","title":"Referencia de Comandos","text":"<p>Lista completa de comandos DBL disponibles.</p>"},{"location":"es/commands/#setup","title":"Setup","text":"<p>Comandos para inicializar y configurar.</p> <ul> <li><code>dbl init</code> - Inicializar nuevo proyecto</li> <li><code>dbl update</code> - Actualizar DBL</li> <li><code>dbl validate</code> - Validar esquema</li> <li><code>dbl version</code> - Ver versi\u00f3n</li> </ul>"},{"location":"es/commands/#sandbox","title":"Sandbox","text":"<p>Trabajar con sandbox de desarrollo seguro.</p> <ul> <li><code>dbl sandbox start</code> - Crear sandbox</li> <li><code>dbl sandbox apply</code> - Aplicar cambios a principal</li> <li><code>dbl sandbox rollback</code> - Descartar sandbox</li> <li><code>dbl sandbox status</code> - Ver estado sandbox</li> </ul>"},{"location":"es/commands/#cambios","title":"Cambios","text":"<p>Gestionar cambios en base de datos.</p> <ul> <li><code>dbl diff</code> - Ver cambios sin guardar</li> <li><code>dbl commit</code> - Guardar cambios como capa</li> <li><code>dbl reset</code> - Reconstruir desde capas</li> </ul>"},{"location":"es/commands/#historial","title":"Historial","text":"<p>Ver y navegar por historial de cambios.</p> <ul> <li><code>dbl log</code> - Ver historial de capas</li> </ul>"},{"location":"es/commands/#ramas","title":"Ramas","text":"<p>Gestionar ramas para desarrollo paralelo.</p> <ul> <li><code>dbl branch</code> - Crear/gestionar ramas</li> </ul>"},{"location":"es/commands/#proximos-pasos","title":"Pr\u00f3ximos Pasos","text":"<ul> <li>Gu\u00eda de inicio</li> <li>Mejores pr\u00e1cticas</li> </ul>"},{"location":"es/getting-started/","title":"Introducci\u00f3n a DBL","text":"<p>Database Layering - Control de versiones para bases de datos.</p>"},{"location":"es/getting-started/#que-es-dbl","title":"\u00bfQu\u00e9 es DBL?","text":"<p>DBL es una herramienta que trata cambios de esquema en base de datos como c\u00f3digo:</p> <ul> <li>Versionarlos con Git</li> <li>Trabajar en ramas</li> <li>Revisar cambios antes de aplicar</li> <li>Mantener historial completo</li> </ul>"},{"location":"es/getting-started/#por-que-usar-dbl","title":"Por Qu\u00e9 Usar DBL?","text":""},{"location":"es/getting-started/#seguridad","title":"Seguridad","text":"<p>Todos los cambios pasan por sandbox primero. Nunca afectas la base principal por accidente.</p>"},{"location":"es/getting-started/#trazabilidad","title":"Trazabilidad","text":"<p>Cada cambio tiene: - Qui\u00e9n lo hizo - Cu\u00e1ndo lo hizo - Por qu\u00e9 (mensaje de commit)</p>"},{"location":"es/getting-started/#reproducibilidad","title":"Reproducibilidad","text":"<p>Reproducir exactamente el esquema en cualquier momento: <pre><code>dbl reset  # Reconstruir desde capas\n</code></pre></p>"},{"location":"es/getting-started/#colaboracion","title":"Colaboraci\u00f3n","text":"<p>M\u00faltiples developers trabajando en paralelo sin conflictos: <pre><code>dbl branch create feature/auth\ndbl branch create feature/payments\n</code></pre></p>"},{"location":"es/getting-started/#conceptos-principales","title":"Conceptos Principales","text":""},{"location":"es/getting-started/#capas-layers","title":"Capas (Layers)","text":"<p>Cada cambio se guarda como una \"capa\" SQL: <pre><code>L001: CREATE TABLE users\nL002: CREATE TABLE posts\nL003: ADD COLUMN email TO users\n</code></pre></p>"},{"location":"es/getting-started/#sandbox","title":"Sandbox","text":"<p>Tu \u00e1rea privada de trabajo. Cambios se quedan aqu\u00ed hasta que est\u00e9s listo: <pre><code>dbl sandbox start\n# Trabajar libremente\ndbl sandbox apply  # Cuando est\u00e9 listo\n</code></pre></p>"},{"location":"es/getting-started/#commit","title":"Commit","text":"<p>Guardar cambios como capa permanente: <pre><code>dbl commit -m \"Add email verification\"\n</code></pre></p>"},{"location":"es/getting-started/#ramas","title":"Ramas","text":"<p>Trabajo independiente en features: <pre><code>dbl branch create feature/auth\ndbl checkout feature/auth\n</code></pre></p>"},{"location":"es/getting-started/#flujo-basico","title":"Flujo B\u00e1sico","text":"<pre><code>1. Crear sandbox \u2192 Espacio seguro\n2. Hacer cambios \u2192 SQL normal\n3. dbl commit \u2192 Guardar como capa\n4. dbl sandbox apply \u2192 Aplicar a base principal\n5. git commit \u2192 Guardar en Git\n6. git push \u2192 Compartir con equipo\n</code></pre>"},{"location":"es/getting-started/#proximos-pasos","title":"Pr\u00f3ximos Pasos","text":"<ul> <li>Instalaci\u00f3n</li> <li>Quick Start</li> <li>First Migration</li> <li>Todos los comandos</li> </ul> <p>Comencemos: Instalar DBL \u2192</p>"},{"location":"es/architecture/engines/","title":"Motores de Base de Datos","text":"<p>DBL soporta m\u00faltiples sistemas de bases de datos.</p>"},{"location":"es/architecture/engines/#postgresql","title":"PostgreSQL","text":"<p>Motor principal y recomendado de DBL.</p>"},{"location":"es/architecture/engines/#ventajas","title":"Ventajas","text":"<ul> <li>\u2705 Mejor soporte en DBL</li> <li>\u2705 Transacciones ACID robustas</li> <li>\u2705 Excelente para migraciones</li> <li>\u2705 Herramientas avanzadas</li> </ul>"},{"location":"es/architecture/engines/#configurar","title":"Configurar","text":"<pre><code># dbl.yaml\nengine: postgres\ndatabase:\n  host: localhost\n  port: 5432\n  database: myapp\n  user: postgres\n  password: secret\n</code></pre>"},{"location":"es/architecture/engines/#caracteristicas-especiales","title":"Caracter\u00edsticas Especiales","text":"<pre><code>-- Schemas\nCREATE SCHEMA IF NOT EXISTS public;\nCREATE SCHEMA IF NOT EXISTS app;\n\n-- Tipos personalizados\nCREATE TYPE user_role AS ENUM ('admin', 'user', 'guest');\n\n-- JSON\nALTER TABLE users ADD COLUMN metadata JSONB;\n\n-- Full-text search\nCREATE INDEX idx_posts_search ON posts USING gin(to_tsvector('spanish', content));\n</code></pre>"},{"location":"es/architecture/engines/#mysql","title":"MySQL","text":"<p>Soporte completo para MySQL 5.7+.</p>"},{"location":"es/architecture/engines/#ventajas_1","title":"Ventajas","text":"<ul> <li>\u2705 Muy popular</li> <li>\u2705 Buenas transacciones (InnoDB)</li> <li>\u2705 Rendimiento en OLTP</li> </ul>"},{"location":"es/architecture/engines/#diferencias-con-postgresql","title":"Diferencias con PostgreSQL","text":"<pre><code>-- No hay SCHEMAS (usar databases)\nUSE myapp;\n\n-- Tipos enum\nALTER TABLE users ADD COLUMN status ENUM('active', 'inactive');\n\n-- JSON\nALTER TABLE users ADD COLUMN metadata JSON;\n\n-- Full-text search\nALTER TABLE posts ADD FULLTEXT INDEX ft_search (title, content);\n</code></pre>"},{"location":"es/architecture/engines/#configurar_1","title":"Configurar","text":"<pre><code># dbl.yaml\nengine: mysql\ndatabase:\n  host: localhost\n  port: 3306\n  database: myapp\n  user: root\n  password: secret\n</code></pre>"},{"location":"es/architecture/engines/#consideraciones-especiales","title":"Consideraciones Especiales","text":"<pre><code>-- Cuidado: MySQL no soporta TRUNCATE CASCADE\n-- Usar DELETE en su lugar\nDELETE FROM comments WHERE post_id IN (SELECT id FROM posts);\nDELETE FROM posts;\n\n-- Cuidado: Sin transacciones expl\u00edcitas por defecto\nBEGIN;\nCREATE TABLE users (...);\nINSERT INTO users VALUES (...);\nCOMMIT;\n</code></pre>"},{"location":"es/architecture/engines/#soportados","title":"Soportados","text":""},{"location":"es/architecture/engines/#version-matrix","title":"Version Matrix","text":"Base de Datos Versi\u00f3n M\u00ednima Estado PostgreSQL 11+ \u2705 Soportado PostgreSQL 9.6-10 \u26a0\ufe0f Legacy MySQL 5.7+ \u2705 Soportado MySQL 5.6 \u274c No soportado"},{"location":"es/architecture/engines/#planes-futuros","title":"Planes Futuros","text":"<ul> <li>\ud83d\udd04 MariaDB (pr\u00f3ximamente)</li> <li>\ud83d\udd04 SQLite (development)</li> <li>\ud83d\udd04 SQL Server (roadmap)</li> </ul>"},{"location":"es/architecture/engines/#compatibilidad-de-features","title":"Compatibilidad de Features","text":""},{"location":"es/architecture/engines/#transacciones","title":"Transacciones","text":"Feature PostgreSQL MySQL BEGIN/COMMIT \u2705 \u2705 Rollback \u2705 \u2705 (InnoDB) Savepoints \u2705 \u2705"},{"location":"es/architecture/engines/#constraints","title":"Constraints","text":"Constraint PostgreSQL MySQL PRIMARY KEY \u2705 \u2705 FOREIGN KEY \u2705 \u2705 UNIQUE \u2705 \u2705 CHECK \u2705 \u26a0\ufe0f (ignored)"},{"location":"es/architecture/engines/#tipos-de-datos","title":"Tipos de Datos","text":"Tipo PostgreSQL MySQL INTEGER \u2705 \u2705 VARCHAR \u2705 \u2705 TEXT \u2705 \u2705 JSONB \u2705 JSON UUID \u2705 VARCHAR(36) ARRAY \u2705 \u274c"},{"location":"es/architecture/engines/#ejemplos-por-engine","title":"Ejemplos por Engine","text":""},{"location":"es/architecture/engines/#postgresql_1","title":"PostgreSQL","text":"<pre><code>-- Crear tabla con UUID\nCREATE EXTENSION IF NOT EXISTS uuid-ossp;\nCREATE TABLE users (\n    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n    email TEXT UNIQUE NOT NULL,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- JSON avanzado\nCREATE TABLE events (\n    id SERIAL PRIMARY KEY,\n    data JSONB NOT NULL\n);\nCREATE INDEX idx_events_data ON events USING gin(data);\n</code></pre>"},{"location":"es/architecture/engines/#mysql_1","title":"MySQL","text":"<pre><code>-- UUID alternativo\nCREATE TABLE users (\n    id CHAR(36) PRIMARY KEY DEFAULT (UUID()),\n    email VARCHAR(255) UNIQUE NOT NULL,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- JSON b\u00e1sico\nCREATE TABLE events (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    data JSON NOT NULL\n);\n</code></pre>"},{"location":"es/architecture/engines/#diferencias-de-sintaxis","title":"Diferencias de Sintaxis","text":""},{"location":"es/architecture/engines/#create-table","title":"CREATE TABLE","text":"<pre><code>PostgreSQL:\n  SERIAL      \u2192 Auto-increment\n  TIMESTAMP   \u2192 Timestamp\n  TEXT        \u2192 Texto largo\n\nMySQL:\n  AUTO_INCREMENT  \u2192 Auto-increment\n  DATETIME        \u2192 Timestamp\n  VARCHAR(255)    \u2192 Texto m\u00e1x 255\n</code></pre>"},{"location":"es/architecture/engines/#indices","title":"\u00cdndices","text":"<pre><code>-- PostgreSQL\nCREATE UNIQUE INDEX idx_name ON table(column);\n\n-- MySQL\nCREATE UNIQUE INDEX idx_name ON table(column);\n-- Iguales\n</code></pre>"},{"location":"es/architecture/engines/#foreign-keys","title":"Foreign Keys","text":"<pre><code>-- Ambos soportan\nALTER TABLE posts ADD CONSTRAINT fk_posts_users\nFOREIGN KEY (user_id) REFERENCES users(id);\n</code></pre>"},{"location":"es/architecture/engines/#caracteristicas-unicas","title":"Caracter\u00edsticas \u00danicas","text":""},{"location":"es/architecture/engines/#postgresql-unico","title":"PostgreSQL \u00danico","text":"<pre><code>-- Particionamiento\nCREATE TABLE events_2024 PARTITION OF events\nFOR VALUES FROM ('2024-01-01') TO ('2025-01-01');\n\n-- Materialized Views\nCREATE MATERIALIZED VIEW user_stats AS\nSELECT user_id, COUNT(*) as posts\nFROM posts\nGROUP BY user_id;\n\n-- Funci\u00f3n PL/pgSQL\nCREATE FUNCTION update_timestamp() RETURNS TRIGGER AS $$\nBEGIN\n    NEW.updated_at = CURRENT_TIMESTAMP;\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n</code></pre>"},{"location":"es/architecture/engines/#mysql-unico","title":"MySQL \u00danico","text":"<pre><code>-- Particionamiento RANGE\nCREATE TABLE orders (\n    id INT,\n    order_date DATE\n) PARTITION BY RANGE (YEAR(order_date)) (\n    PARTITION p2023 VALUES LESS THAN (2024),\n    PARTITION p2024 VALUES LESS THAN (2025)\n);\n\n-- Generated Columns\nCREATE TABLE users (\n    first_name VARCHAR(50),\n    last_name VARCHAR(50),\n    full_name VARCHAR(101) GENERATED ALWAYS AS\n    (CONCAT(first_name, ' ', last_name)) STORED\n);\n</code></pre>"},{"location":"es/architecture/engines/#migracion-entre-engines","title":"Migraci\u00f3n Entre Engines","text":""},{"location":"es/architecture/engines/#postgresql-mysql","title":"PostgreSQL \u2192 MySQL","text":"<pre><code>-- Cambios necesarios:\n1. UUID \u2192 CHAR(36) con UUID()\n2. JSONB \u2192 JSON\n3. Triggers PL/pgSQL \u2192 triggers MySQL\n4. Schemas \u2192 Usar databases\n5. ENUM \u2192 VARCHAR o ENUM (MySQL)\n</code></pre>"},{"location":"es/architecture/engines/#proceso","title":"Proceso","text":"<pre><code># 1. Extraer schema actual\npg_dump --schema-only myapp &gt; schema.sql\n\n# 2. Adaptarlo a MySQL\nsed 's/CREATE TABLE/CREATE TABLE IF NOT EXISTS/g' schema.sql\n\n# 3. Importar en DBL\ndbl commit -m \"Migrate to MySQL\"\n\n# 4. Testear\ndbl reset --engine mysql\n</code></pre>"},{"location":"es/architecture/engines/#troubleshooting-por-engine","title":"Troubleshooting por Engine","text":""},{"location":"es/architecture/engines/#postgresql_2","title":"PostgreSQL","text":"<p>Problema: <code>UNIQUE constraint violation</code> Soluci\u00f3n: Revisar \u00edndices y datos duplicados</p>"},{"location":"es/architecture/engines/#mysql_2","title":"MySQL","text":"<p>Problema: <code>Deadlock detected</code> Soluci\u00f3n: Revisar orden de operaciones, usar transacciones</p>"},{"location":"es/architecture/engines/#proximos-pasos","title":"Pr\u00f3ximos Pasos","text":"<ul> <li>Configuraci\u00f3n de engines</li> <li>Mejores pr\u00e1cticas</li> <li>Troubleshooting</li> </ul>"},{"location":"es/architecture/overview/","title":"Visi\u00f3n General de Arquitectura","text":"<p>C\u00f3mo funciona DBL internamente y conceptos clave.</p>"},{"location":"es/architecture/overview/#modelo-de-capas-layers","title":"Modelo de Capas (Layers)","text":"<p>DBL ve tu base de datos como una serie de capas incrementales:</p> <pre><code>Capa L001: Esquema base\nCapa L002: Tabla de usuarios\nCapa L003: Tabla de posts\nCapa L004: Tabla de comentarios\n...\n</code></pre> <p>Cada capa: - Es un archivo SQL aut\u00f3nomo - Se puede ejecutar de forma independiente - Construye sobre capas previas - Es idempotente (se puede ejecutar m\u00faltiples veces)</p>"},{"location":"es/architecture/overview/#construccion-desde-cero","title":"Construcci\u00f3n Desde Cero","text":"<p>Para reproducir la base de datos:</p> <pre><code>$ dbl reset\n\n1. Ejecutar L001\n   \u2192 Crea tabla users, posts\n\n2. Ejecutar L002\n   \u2192 Crea tabla comments\n\n3. Ejecutar L003\n   \u2192 Agrega \u00edndices\n\n4. Ejecutar L004\n   \u2192 Agrega constraints\n</code></pre>"},{"location":"es/architecture/overview/#flujo-de-sandbox","title":"Flujo de Sandbox","text":"<p>El sandbox es tu \u00e1rea segura de trabajo:</p> <pre><code>Base de datos Principal\n     \u2193\n   COPIA\n     \u2193\nBase de datos Sandbox\n     \u2193\n  Cambios aqu\u00ed (seguro)\n     \u2193\n  \u00bfListo? Commit \u2192 Capas\n     \u2193\n  Aplicar a Principal\n</code></pre>"},{"location":"es/architecture/overview/#proceso-detallado","title":"Proceso Detallado","text":"<pre><code>1. dbl sandbox start\n   \u2192 Copia esquema a sandbox_db\n\n2. Hacer cambios\n   \u2192 Ejecutar SQL en sandbox_db\n   \u2192 Base principal intacta\n\n3. dbl diff\n   \u2192 Comparar sandbox vs main\n   \u2192 Ver qu\u00e9 cambi\u00f3\n\n4. dbl commit\n   \u2192 Guardar cambios como nueva capa\n\n5. dbl sandbox apply\n   \u2192 Ejecutar capa en base principal\n   \u2192 Eliminar sandbox_db\n</code></pre>"},{"location":"es/architecture/overview/#almacenamiento-de-estado","title":"Almacenamiento de Estado","text":""},{"location":"es/architecture/overview/#directorio-dbl","title":"Directorio .dbl","text":"<pre><code>.dbl/\n\u251c\u2500\u2500 config.yaml         \u2190 Configuraci\u00f3n\n\u251c\u2500\u2500 state.json          \u2190 Estado actual\n\u251c\u2500\u2500 sandbox.json        \u2190 Metadata del sandbox\n\u2514\u2500\u2500 layers/\n    \u251c\u2500\u2500 L001_initial_schema.sql\n    \u251c\u2500\u2500 L002_add_users.sql\n    \u251c\u2500\u2500 L003_add_posts.sql\n    ...\n</code></pre>"},{"location":"es/architecture/overview/#statejson","title":"state.json","text":"<pre><code>{\n  \"version\": \"2.1.0\",\n  \"database\": \"myapp\",\n  \"engine\": \"postgres\",\n  \"current_branch\": \"main\",\n  \"latest_layer\": \"L015\",\n  \"layers_applied\": 15,\n  \"last_update\": \"2024-12-30T14:35:22Z\"\n}\n</code></pre>"},{"location":"es/architecture/overview/#gestion-de-ramas","title":"Gesti\u00f3n de Ramas","text":"<p>Las ramas permiten desarrollo paralelo:</p> <pre><code>main\n\u251c\u2500\u2500 L001 \u2192 L002 \u2192 L003 \u2192 ... \u2192 L015\n\u2514\u2500\u2500 feature/auth\n    \u2514\u2500\u2500 L001 \u2192 L002 \u2192 L003 \u2192 ... \u2192 L012 \u2192 L013 \u2192 L014\n</code></pre> <p>Cada rama tiene su propio historial de capas.</p>"},{"location":"es/architecture/overview/#sincronizacion-entre-ambientes","title":"Sincronizaci\u00f3n Entre Ambientes","text":"<pre><code>Desarrollo\n   \u2193\nCapas guardadas en .dbl/layers\n   \u2193\nStaging (aplica capas)\n   \u2193\nProducci\u00f3n (aplica capas)\n</code></pre> <p>Mismo c\u00f3digo de migraci\u00f3n en todos los ambientes.</p>"},{"location":"es/architecture/overview/#conceptos-clave","title":"Conceptos Clave","text":""},{"location":"es/architecture/overview/#idempotencia","title":"Idempotencia","text":"<p>Cada capa debe poderse ejecutar m\u00faltiples veces sin error:</p> <pre><code>-- \u2705 Idempotente\nCREATE TABLE IF NOT EXISTS users (\n    id SERIAL PRIMARY KEY\n);\n\n-- \u274c No idempotente\nCREATE TABLE users (\n    id SERIAL PRIMARY KEY\n);  -- Error si tabla existe\n</code></pre>"},{"location":"es/architecture/overview/#declarativo-vs-imperativo","title":"Declarativo vs Imperativo","text":"<p>DBL favorece cambios declarativos:</p> <pre><code>-- \u2705 Declarativo (DBL lo prefiere)\nCREATE TABLE comments (\n    id SERIAL PRIMARY KEY,\n    post_id INTEGER REFERENCES posts(id)\n);\n\n-- \u274c Imperativo (evitar)\nDO $$ BEGIN\n    IF NOT EXISTS (SELECT FROM information_schema.tables WHERE table_name = 'comments') THEN\n        CREATE TABLE comments ...\n    END IF;\nEND $$;\n</code></pre>"},{"location":"es/architecture/overview/#atomicidad","title":"Atomicidad","text":"<p>Cada capa debe ser una transacci\u00f3n:</p> <pre><code>BEGIN;\n    CREATE TABLE notifications (...);\n    CREATE INDEX idx_notifications (...);\n    INSERT INTO config VALUES (...);\nCOMMIT;\n</code></pre> <p>Si algo falla, nada se aplica.</p>"},{"location":"es/architecture/overview/#flujo-de-desarrollo","title":"Flujo de Desarrollo","text":"<pre><code>1. Clone del repo\n   \u2192 Obtiene .dbl/layers/\n\n2. dbl reset\n   \u2192 Reconstruye base desde capas\n\n3. dbl sandbox start\n   \u2192 \u00c1rea segura para cambios\n\n4. Hacer cambios\n   \u2192 Experimentar sin riesgos\n\n5. dbl commit\n   \u2192 Guardar cambios\n\n6. dbl sandbox apply\n   \u2192 Aplicar a base principal\n\n7. git commit\n   \u2192 Guardar capas en Git\n\n8. git push\n   \u2192 Compartir con equipo\n</code></pre>"},{"location":"es/architecture/overview/#comparacion-con-alternativas","title":"Comparaci\u00f3n con Alternativas","text":""},{"location":"es/architecture/overview/#vs-raw-sql-scripts","title":"vs Raw SQL Scripts","text":"<pre><code>Raw SQL:\n- \u274c Dif\u00edcil de reproducir\n- \u274c Sin versionado\n- \u274c Sin rollback seguro\n- \u274c Sin debugging\n\nDBL:\n- \u2705 Reproducible\n- \u2705 Versionado con Git\n- \u2705 Sandbox seguro\n- \u2705 Debugging claro\n</code></pre>"},{"location":"es/architecture/overview/#vs-migraciones-orm-sequelize-alembic","title":"vs Migraciones ORM (Sequelize, Alembic)","text":"<pre><code>ORM Migrations:\n- \u2705 Integrado con c\u00f3digo\n- \u274c C\u00f3digo espec\u00edfico por lenguaje\n- \u274c Acoplado a ORM\n\nDBL:\n- \u2705 SQL puro, agn\u00f3stico de lenguaje\n- \u2705 Independiente de c\u00f3digo\n- \u2705 Funciona con cualquier framework\n</code></pre>"},{"location":"es/architecture/overview/#proximos-pasos","title":"Pr\u00f3ximos Pasos","text":"<ul> <li>Engines soportados</li> <li>Gu\u00eda de configuraci\u00f3n</li> <li>Mejores pr\u00e1cticas</li> </ul>"},{"location":"es/commands/","title":"Resumen de Comandos","text":"<p>DBL proporciona un conjunto completo de comandos organizados por funcionalidad. Esta gu\u00eda te ayudar\u00e1 a entender qu\u00e9 hace cada comando y cu\u00e1ndo usarlo.</p>"},{"location":"es/commands/#categorias-de-comandos","title":"Categor\u00edas de Comandos","text":""},{"location":"es/commands/#comandos-de-configuracion","title":"\ud83d\udd27 Comandos de Configuraci\u00f3n","text":"<p>Comandos para inicializar y mantener tu instalaci\u00f3n de DBL.</p> Comando Descripci\u00f3n <code>dbl init</code> Inicializar DBL en tu proyecto <code>dbl version</code> Mostrar informaci\u00f3n de versi\u00f3n de DBL <code>dbl update</code> Verificar e instalar actualizaciones de DBL"},{"location":"es/commands/#comandos-de-sandbox","title":"\ud83c\udfd6\ufe0f Comandos de Sandbox","text":"<p>Entorno de pruebas seguro para cambios en la base de datos.</p> Comando Descripci\u00f3n <code>dbl sandbox start</code> Crear una base de datos sandbox aislada <code>dbl sandbox apply</code> Aplicar cambios del sandbox a la DB principal <code>dbl sandbox rollback</code> Descartar todos los cambios del sandbox <code>dbl sandbox status</code> Verificar estado del sandbox"},{"location":"es/commands/#gestion-de-cambios","title":"\ud83d\udcdd Gesti\u00f3n de Cambios","text":"<p>Comandos para rastrear y confirmar cambios en la base de datos.</p> Comando Descripci\u00f3n <code>dbl diff</code> Mostrar cambios en sandbox vs l\u00ednea base <code>dbl commit</code> Guardar cambios como una capa versionada <code>dbl reset</code> Reconstruir base de datos desde capas"},{"location":"es/commands/#ramificacion","title":"\ud83c\udf3f Ramificaci\u00f3n","text":"<p>Ramificaci\u00f3n tipo Git para desarrollo paralelo.</p> Comando Descripci\u00f3n <code>dbl branch</code> Listar, crear o eliminar ramas <code>dbl checkout</code> Cambiar a una rama diferente <code>dbl merge</code> Fusionar cambios de otra rama <code>dbl pull</code> Traer cambios de otra rama <code>dbl rebase</code> Rebasar rama actual sobre otra"},{"location":"es/commands/#historial-e-inspeccion","title":"\ud83d\udcdc Historial e Inspecci\u00f3n","text":"<p>Ver y validar tu historial de base de datos.</p> Comando Descripci\u00f3n <code>dbl log</code> Ver historial de capas <code>dbl rev-parse</code> Resolver referencias (HEAD, ramas) <code>dbl validate</code> Validar patrones de migraci\u00f3n"},{"location":"es/commands/#referencia-rapida","title":"Referencia R\u00e1pida","text":""},{"location":"es/commands/#flujos-de-trabajo-comunes","title":"Flujos de Trabajo Comunes","text":"<p>Flujo b\u00e1sico: <pre><code>dbl sandbox start      # Crear sandbox\n# Hacer cambios en la base de datos...\ndbl diff              # Revisar cambios\ndbl commit -m \"msg\"   # Guardar cambios\ndbl sandbox apply     # Aplicar a DB principal\n</code></pre></p> <p>Flujo de ramas: <pre><code>dbl branch feature-x  # Crear rama\ndbl checkout feature-x # Cambiar a rama\n# Trabajar en la funcionalidad...\ndbl checkout master   # Volver a master\ndbl merge feature-x   # Fusionar cambios\n</code></pre></p> <p>Revisar historial: <pre><code>dbl log               # Historial completo\ndbl log --oneline     # Vista compacta\ndbl log -n 5          # \u00daltimas 5 capas\n</code></pre></p>"},{"location":"es/commands/#patrones-de-sintaxis-de-comandos","title":"Patrones de Sintaxis de Comandos","text":"<p>DBL sigue patrones consistentes en todos los comandos:</p> <ul> <li>Banderas: Opciones que comienzan con <code>-</code> o <code>--</code></li> <li>Argumentos: Par\u00e1metros requeridos u opcionales</li> <li>Subcomandos: Comandos con acciones (ej., <code>sandbox start</code>)</li> </ul>"},{"location":"es/commands/#ejemplos","title":"Ejemplos:","text":"<pre><code>dbl comando [opciones] [argumentos]\ndbl comando subcomando [opciones]\ndbl comando --bandera valor argumento\n</code></pre>"},{"location":"es/commands/#obtener-ayuda","title":"Obtener Ayuda","text":"<p>Para ayuda detallada sobre cualquier comando: <pre><code>dbl help\ndbl &lt;comando&gt; --help\n</code></pre></p>"},{"location":"es/commands/#proximos-pasos","title":"Pr\u00f3ximos Pasos","text":"<ul> <li>Tutorial de Inicio R\u00e1pido</li> <li>Mejores Pr\u00e1cticas</li> <li>Gu\u00eda de Configuraci\u00f3n</li> </ul>"},{"location":"es/commands/#glosario","title":"Glosario","text":"<p>Capa (Layer): Un conjunto versionado de cambios SQL Sandbox: Base de datos temporal para pruebas seguras Rama (Branch): L\u00ednea paralela de desarrollo de esquema Manifest: Registro de ramas, capas e historial HEAD: Referencia a la capa actual Baseline: Estado de referencia para detecci\u00f3n de cambios</p>"},{"location":"es/commands/branching/","title":"Ramas","text":"<p>Gestionar ramas de base de datos para desarrollo paralelo.</p>"},{"location":"es/commands/branching/#descripcion","title":"Descripci\u00f3n","text":"<p>Las ramas permiten que m\u00faltiples desarrolladores trabajen en cambios independientes sin interferir entre s\u00ed. Cada rama tiene su propio historial de capas y puede fusionarse cuando est\u00e1 lista.</p>"},{"location":"es/commands/branching/#conceptos-clave","title":"Conceptos Clave","text":""},{"location":"es/commands/branching/#rama-principal-main","title":"Rama Principal (Main)","text":"<p>La rama <code>main</code> es tu fuente de verdad. Contiene todas las capas aprobadas y estables. Directamente conectada a tu base de datos de producci\u00f3n.</p> <pre><code>$ dbl branch\n* main\n  feature-auth\n  feature-payments\n</code></pre>"},{"location":"es/commands/branching/#ramas-de-feature","title":"Ramas de Feature","text":"<p>Crea ramas para trabajar en features aisladamente:</p> <pre><code># Crear rama\n$ dbl branch create feature-comments\n\u2713 Created branch: feature-comments\n\n# Cambiar a rama\n$ dbl checkout feature-comments\n</code></pre>"},{"location":"es/commands/branching/#flujo-de-trabajo","title":"Flujo de Trabajo","text":""},{"location":"es/commands/branching/#crear-feature","title":"Crear Feature","text":"<pre><code># 1. Crear rama desde main\n$ dbl branch create feature-auth\n\u2713 Branch feature-auth created\n\n# 2. Cambiar a rama\n$ dbl checkout feature-auth\n\n# 3. Hacer cambios\n$ dbl sandbox start\n# ... crear tablas ...\n$ dbl commit -m \"Add authentication tables\"\n$ dbl sandbox apply\n\n# 4. Fusionar cuando lista\n$ dbl checkout main\n$ dbl merge feature-auth\n</code></pre>"},{"location":"es/commands/branching/#comandos-relacionados","title":"Comandos Relacionados","text":"<ul> <li><code>dbl branch</code> - Listar/crear ramas</li> <li><code>dbl checkout</code> - Cambiar rama</li> <li><code>dbl merge</code> - Fusionar ramas</li> </ul>"},{"location":"es/commands/branching/#mejores-practicas","title":"Mejores Pr\u00e1cticas","text":"<ul> <li>Rama por feature: Una rama por feature aislada</li> <li>Nombres descriptivos: <code>feature-auth</code>, no <code>work</code></li> <li>Sincronizar con main: Actualizar main regularmente</li> <li>PR antes de fusionar: Revisar cambios antes de merge</li> </ul>"},{"location":"es/commands/branching/#proximos-pasos","title":"Pr\u00f3ximos Pasos","text":"<ul> <li>Crear rama</li> <li>Revisar ramas</li> <li>Fusionar cambios</li> </ul>"},{"location":"es/commands/changes/commit/","title":"dbl commit","text":"<p>Guardar cambios del sandbox como una nueva capa versionada.</p>"},{"location":"es/commands/changes/commit/#sinopsis","title":"Sinopsis","text":"<pre><code>dbl commit -m \"mensaje\"              # Commit completo (esquema + datos)\ndbl commit -m \"mensaje\" --schema-only  # Solo cambios de esquema\n</code></pre>"},{"location":"es/commands/changes/commit/#descripcion","title":"Descripci\u00f3n","text":"<p>Guarda los cambios del sandbox como una \"capa\" (layer) - un archivo SQL versionado que puede ser replicado. Las capas son el equivalente de commits en Git, pero para esquemas de base de datos.</p> <p>Por defecto, se incluyen tanto cambios de esquema (DDL) como datos (DML). Usa <code>--schema-only</code> para excluir cambios de datos.</p>"},{"location":"es/commands/changes/commit/#opciones","title":"Opciones","text":"Opci\u00f3n Descripci\u00f3n <code>-m, --message MSG</code> Mensaje descriptivo del commit (requerido) <code>--schema-only</code> Guardar solo cambios de esquema (DDL), excluir datos (DML)"},{"location":"es/commands/changes/commit/#ejemplo-de-uso","title":"Ejemplo de Uso","text":"<pre><code>dbl commit -m \"Add notifications table\"\n</code></pre> <p>Salida: <pre><code>Creating layer from sandbox changes...\n\u2713 Generated SQL from diff (schema+data)\n\u2713 Layer L008 created: Add notifications table\n\u2713 Layer saved to .dbl/layers/L008_add_notifications_table.sql\n\nYour changes are now committed and can be applied.\n</code></pre></p>"},{"location":"es/commands/changes/commit/#ejemplo-completo","title":"Ejemplo Completo","text":""},{"location":"es/commands/changes/commit/#flujo-de-trabajo-tipico","title":"Flujo de Trabajo T\u00edpico","text":"<pre><code># 1. Crear sandbox\n$ dbl sandbox start\n\u2713 Sandbox created: myapp_sandbox\n\n# 2. Hacer cambios (esquema + datos)\n$ psql -d myapp_sandbox &lt;&lt; EOF\nCREATE TABLE comments (\n    id SERIAL PRIMARY KEY,\n    post_id INTEGER REFERENCES posts(id) ON DELETE CASCADE,\n    author_id INTEGER REFERENCES users(id),\n    content TEXT NOT NULL,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE INDEX idx_comments_post ON comments(post_id);\nCREATE INDEX idx_comments_author ON comments(author_id);\n\n-- Agregar datos de prueba\nINSERT INTO comments (post_id, author_id, content) \nVALUES (1, 100, 'Comentario de prueba');\nEOF\n\n# 3. Revisar cambios\n$ dbl diff\n+ CREATE TABLE comments (...)\n+ CREATE INDEX idx_comments_post ...\n+ CREATE INDEX idx_comments_author ...\n+ INSERT INTO comments (1 row changed)\n\n# 4a. Guardar solo esquema (ignorar datos de prueba)\n$ dbl commit -m \"Add comments table with indexes\" --schema-only\n\u2713 Layer L005 created (schema)\n\n# 4b. O guardar todo (esquema + datos)\n$ dbl commit -m \"Add comments table with sample data\"\n\u2713 Layer L005 created (schema+data)\n\n# 5. Aplicar a base principal\n$ dbl sandbox apply\n\u2713 Changes applied to myapp\n</code></pre>"},{"location":"es/commands/changes/commit/#casos-de-uso","title":"Casos de Uso","text":""},{"location":"es/commands/changes/commit/#commit-con-datos-por-defecto","title":"Commit con Datos (por defecto)","text":"<p>\u00datil cuando quieres migrar datos reales:</p> <pre><code># Agregar datos de producci\u00f3n\npsql -d myapp_sandbox -c \"\nINSERT INTO settings (key, value) VALUES \n    ('maintenance_mode', 'false'),\n    ('api_version', 'v2');\n\"\n\n# Commit incluye datos autom\u00e1ticamente\ndbl commit -m \"Add initial settings\"\n</code></pre>"},{"location":"es/commands/changes/commit/#commit-solo-esquema","title":"Commit Solo Esquema","text":"<p>\u00datil cuando trabajas con datos de prueba que no quieres en producci\u00f3n:</p> <pre><code># Hacer cambios con datos de prueba\npsql -d myapp_sandbox -c \"\nALTER TABLE users ADD COLUMN phone VARCHAR(20);\nINSERT INTO users (username, email, phone) VALUES \n    ('testuser', 'test@example.com', '555-0100');\n\"\n\n# Commit solo el ALTER, no el INSERT\ndbl commit -m \"Add phone column\" --schema-only\n</code></pre>"},{"location":"es/commands/changes/commit/#que-crea-un-commit","title":"Qu\u00e9 Crea un Commit","text":""},{"location":"es/commands/changes/commit/#archivo-de-capa","title":"Archivo de Capa","text":"<p>Cada commit crea un archivo:</p> <pre><code>.dbl/layers/L005_add_comments_table.sql\n</code></pre> <p>Contenido: <pre><code>-- Layer: L005\n-- Message: Add comments table with indexes\n-- Date: 2024-12-30 14:32:11\n-- Branch: main\n\nCREATE TABLE comments (\n    id SERIAL PRIMARY KEY,\n    post_id INTEGER REFERENCES posts(id) ON DELETE CASCADE,\n    author_id INTEGER REFERENCES users(id),\n    content TEXT NOT NULL,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE INDEX idx_comments_post ON comments(post_id);\nCREATE INDEX idx_comments_author ON comments(author_id);\n</code></pre></p>"},{"location":"es/commands/changes/commit/#actualizacion-de-estado","title":"Actualizaci\u00f3n de Estado","text":"<pre><code>// .dbl/state.json actualizado\n{\n  \"database\": \"myapp\",\n  \"branch\": \"main\",\n  \"last_layer\": \"L005\",  // \u2190 actualizado\n  \"active_sandbox\": \"myapp_sandbox\"\n}\n</code></pre>"},{"location":"es/commands/changes/commit/#mensajes-de-commit","title":"Mensajes de Commit","text":""},{"location":"es/commands/changes/commit/#buenos-mensajes","title":"Buenos Mensajes","text":"<pre><code># \u2705 Espec\u00edfico y claro\ndbl commit -m \"Add notifications table with user relationship\"\n\n# \u2705 Describe el cambio\ndbl commit -m \"Add email_verified column to users table\"\n\n# \u2705 Incluye contexto\ndbl commit -m \"Add indexes for post search performance\"\n</code></pre>"},{"location":"es/commands/changes/commit/#malos-mensajes","title":"Malos Mensajes","text":"<pre><code># \u274c Vago\ndbl commit -m \"changes\"\n\n# \u274c Sin informaci\u00f3n\ndbl commit -m \"update\"\n\n# \u274c No descriptivo\ndbl commit -m \"fix\"\n</code></pre>"},{"location":"es/commands/changes/commit/#convenciones","title":"Convenciones","text":"<pre><code># Tipo: acci\u00f3n\ndbl commit -m \"feat: Add user preferences table\"\ndbl commit -m \"fix: Correct foreign key constraint\"\ndbl commit -m \"perf: Add index for email lookups\"\ndbl commit -m \"refactor: Rename column user_name to username\"\n</code></pre>"},{"location":"es/commands/changes/commit/#commits-multiples","title":"Commits M\u00faltiples","text":"<p>Puedes hacer m\u00faltiples commits en un sandbox:</p> <pre><code># Sandbox activo\ndbl sandbox start\n\n# Commit 1: Tabla base\npsql -d myapp_sandbox -c \"CREATE TABLE tags (...);\"\ndbl commit -m \"Add tags table\"\n\n# Commit 2: Relaci\u00f3n\npsql -d myapp_sandbox -c \"CREATE TABLE post_tags (...);\"\ndbl commit -m \"Add post-tag relationship\"\n\n# Commit 3: \u00cdndices\npsql -d myapp_sandbox -c \"CREATE INDEX idx_post_tags_post (...);\"\ndbl commit -m \"Add indexes for tags\"\n\n# Ver todos los commits\ndbl log -n 3\n\n# Aplicar todos\ndbl sandbox apply\n</code></pre>"},{"location":"es/commands/changes/commit/#commits-con-datos","title":"Commits con Datos","text":""},{"location":"es/commands/changes/commit/#migracion-de-datos","title":"Migraci\u00f3n de Datos","text":"<pre><code># Hacer cambios de esquema Y datos\npsql -d myapp_sandbox &lt;&lt; EOF\n-- Agregar columna\nALTER TABLE users ADD COLUMN full_name VARCHAR(200);\n\n-- Migrar datos existentes\nUPDATE users SET full_name = first_name || ' ' || last_name;\n\n-- Eliminar columnas viejas\nALTER TABLE users DROP COLUMN first_name;\nALTER TABLE users DROP COLUMN last_name;\nEOF\n\n# Commit con flag de datos\ndbl commit -m \"Consolidate user names into full_name\" --with-data\n</code></pre> <p>Precauci\u00f3n con Datos</p> <p>El flag <code>--with-data</code> incluye las declaraciones UPDATE/INSERT en la capa. \u00dasalo solo cuando sea necesario.</p>"},{"location":"es/commands/changes/commit/#casos-de-uso_1","title":"Casos de Uso","text":""},{"location":"es/commands/changes/commit/#feature-development","title":"Feature Development","text":"<pre><code># Nueva feature completa\ndbl sandbox start\n\n# Implementar tablas\npsql -d myapp_sandbox -f migrations/feature-payments.sql\n\n# Verificar\ndbl diff\n\n# Guardar\ndbl commit -m \"Add payment processing system\"\ndbl sandbox apply\n</code></pre>"},{"location":"es/commands/changes/commit/#hotfix","title":"Hotfix","text":"<pre><code># Fix urgente\ndbl sandbox start\n\n# Corregir\npsql -d myapp_sandbox &lt;&lt; EOF\nALTER TABLE users ALTER COLUMN email SET NOT NULL;\nALTER TABLE users ADD CONSTRAINT unique_email UNIQUE(email);\nEOF\n\n# Commit y aplicar r\u00e1pido\ndbl commit -m \"hotfix: Add email constraints\"\ndbl sandbox apply\n</code></pre>"},{"location":"es/commands/changes/commit/#refactorizacion","title":"Refactorizaci\u00f3n","text":"<pre><code># Mejorar estructura\ndbl sandbox start\n\n# Cambios de refactoring\npsql -d myapp_sandbox &lt;&lt; EOF\n-- Renombrar para claridad\nALTER TABLE usr RENAME TO users;\nALTER TABLE pst RENAME TO posts;\n\n-- Normalizar nombres de columnas\nALTER TABLE users RENAME COLUMN usrnm TO username;\nALTER TABLE posts RENAME COLUMN usr_id TO user_id;\nEOF\n\n# Guardar\ndbl commit -m \"refactor: Normalize table and column names\"\ndbl sandbox apply\n</code></pre>"},{"location":"es/commands/changes/commit/#estructura-de-capas","title":"Estructura de Capas","text":""},{"location":"es/commands/changes/commit/#numeracion-secuencial","title":"Numeraci\u00f3n Secuencial","text":"<pre><code>.dbl/layers/\n\u251c\u2500\u2500 L001_initial_schema.sql\n\u251c\u2500\u2500 L002_add_users.sql\n\u251c\u2500\u2500 L003_add_posts.sql\n\u251c\u2500\u2500 L004_add_comments.sql\n\u2514\u2500\u2500 L005_add_notifications.sql\n</code></pre> <p>Capas se numeran autom\u00e1ticamente en secuencia.</p>"},{"location":"es/commands/changes/commit/#metadata-de-capa","title":"Metadata de Capa","text":"<p>Cada capa contiene:</p> <pre><code>-- Layer ID: L005\n-- Message: Add notifications system\n-- Created: 2024-12-30 14:32:11\n-- Author: developer@example.com (si est\u00e1 configurado)\n-- Branch: main\n\n-- Actual SQL changes\nCREATE TABLE ...\n</code></pre>"},{"location":"es/commands/changes/commit/#validacion-de-commits","title":"Validaci\u00f3n de Commits","text":""},{"location":"es/commands/changes/commit/#verificar-antes-de-commit","title":"Verificar Antes de Commit","text":"<pre><code># 1. Ver cambios\ndbl diff\n\n# 2. Verificar que se ve bien\n# Si hay errores, corregir en sandbox\n\n# 3. Commit solo cuando est\u00e9 seguro\ndbl commit -m \"Mensaje\"\n</code></pre>"},{"location":"es/commands/changes/commit/#validacion-automatica","title":"Validaci\u00f3n Autom\u00e1tica","text":"<pre><code># Validar capa despu\u00e9s de crear\ndbl commit -m \"Add feature\"\ndbl validate --layers\n\n# Si hay errores, la capa tiene problemas\n</code></pre>"},{"location":"es/commands/changes/commit/#integracion-con-control-de-versiones","title":"Integraci\u00f3n con Control de Versiones","text":""},{"location":"es/commands/changes/commit/#guardar-en-git","title":"Guardar en Git","text":"<pre><code># Despu\u00e9s de commit\ndbl commit -m \"Add notifications\"\n\n# Agregar a Git\ngit add .dbl/layers/\ngit commit -m \"Database: Add notifications system\"\ngit push\n\n# Tu equipo puede aplicar\ngit pull\ndbl reset  # Reconstruir con nuevas capas\n</code></pre>"},{"location":"es/commands/changes/commit/#workflow-de-equipo","title":"Workflow de Equipo","text":"<pre><code># Developer 1\ndbl commit -m \"Add user profiles\"\ngit push\n\n# Developer 2\ngit pull\ndbl reset  # Obtener cambios de Dev 1\ndbl sandbox start\n# ... su trabajo ...\ndbl commit -m \"Add comments\"\ngit push\n</code></pre>"},{"location":"es/commands/changes/commit/#notas-importantes","title":"Notas Importantes","text":"<p>Commits At\u00f3micos</p> <p>Haz commits peque\u00f1os y enfocados. Un commit = una funcionalidad.</p> <p>No Editar Capas</p> <p>Una vez creadas, no edites las capas manualmente. Crea nueva capa para correcciones.</p> <p>Mensajes Descriptivos</p> <p>Usa mensajes claros. Tu equipo (y t\u00fa mismo en el futuro) lo agradecer\u00e1.</p>"},{"location":"es/commands/changes/commit/#errores-comunes","title":"Errores Comunes","text":""},{"location":"es/commands/changes/commit/#no-active-sandbox","title":"\"No active sandbox\"","text":"<pre><code># Necesitas un sandbox primero\ndbl sandbox start\n</code></pre>"},{"location":"es/commands/changes/commit/#no-changes-detected","title":"\"No changes detected\"","text":"<pre><code># No hay cambios para guardar\ndbl diff  # Verificar que hay cambios\n</code></pre>"},{"location":"es/commands/changes/commit/#message-required","title":"\"Message required\"","text":"<pre><code># Falta el mensaje\ndbl commit -m \"Tu mensaje aqu\u00ed\"\n</code></pre>"},{"location":"es/commands/changes/commit/#ejemplos-avanzados","title":"Ejemplos Avanzados","text":""},{"location":"es/commands/changes/commit/#commits-condicionales","title":"Commits Condicionales","text":"<pre><code>#!/bin/bash\n# commit-if-changes.sh\n\nif dbl diff --summary | grep -q \"Total: 0\"; then\n    echo \"No changes to commit\"\nelse\n    dbl commit -m \"Auto: $(date +%Y-%m-%d) changes\"\nfi\n</code></pre>"},{"location":"es/commands/changes/commit/#commits-con-verificacion","title":"Commits con Verificaci\u00f3n","text":"<pre><code>#!/bin/bash\n# safe-commit.sh\n\n# Mostrar cambios\necho \"Changes to commit:\"\ndbl diff --summary\n\n# Confirmar\nread -p \"Commit these changes? (y/n): \" confirm\n\nif [[ $confirm == \"y\" ]]; then\n    read -p \"Commit message: \" msg\n    dbl commit -m \"$msg\"\n    echo \"\u2713 Committed\"\nelse\n    echo \"Cancelled\"\nfi\n</code></pre>"},{"location":"es/commands/changes/commit/#pre-commit-hooks","title":"Pre-commit Hooks","text":"<pre><code>#!/bin/bash\n# .git/hooks/pre-commit\n\n# Validar que no hay sandbox sin commit\nif dbl sandbox status 2&gt;/dev/null | grep -q \"Uncommitted\"; then\n    echo \"Error: Tienes cambios sin commit en sandbox\"\n    echo \"Ejecuta: dbl commit -m 'mensaje'\"\n    exit 1\nfi\n</code></pre>"},{"location":"es/commands/changes/commit/#ver-tambien","title":"Ver Tambi\u00e9n","text":"<ul> <li><code>dbl diff</code> - Ver cambios antes de commit</li> <li><code>dbl sandbox apply</code> - Aplicar commits</li> <li><code>dbl log</code> - Ver historial de commits</li> <li><code>dbl reset</code> - Reconstruir desde commits</li> <li>Mejores Pr\u00e1cticas - Gu\u00eda de commits</li> </ul>"},{"location":"es/commands/changes/diff/","title":"dbl diff","text":"<p>Mostrar diferencias entre el sandbox y la base de datos principal.</p>"},{"location":"es/commands/changes/diff/#sinopsis","title":"Sinopsis","text":"<pre><code>dbl diff                    # Ver todos los cambios\ndbl diff --tables users     # Solo tabla espec\u00edfica\ndbl diff --sql              # Solo SQL sin formato\n</code></pre>"},{"location":"es/commands/changes/diff/#descripcion","title":"Descripci\u00f3n","text":"<p>Compara el esquema del sandbox con la base principal y muestra las diferencias en formato SQL. Esto te permite revisar exactamente qu\u00e9 cambios has hecho antes de guardarlos.</p>"},{"location":"es/commands/changes/diff/#opciones","title":"Opciones","text":"Opci\u00f3n Descripci\u00f3n <code>--tables T1,T2</code> Mostrar diff solo para tablas espec\u00edficas <code>--sql</code> Salida solo SQL sin formato <code>--summary</code> Solo resumen, sin SQL detallado"},{"location":"es/commands/changes/diff/#ejemplo-de-uso","title":"Ejemplo de Uso","text":"<pre><code>dbl diff\n</code></pre> <p>Salida: <pre><code>-- Changes in sandbox (not yet committed)\n\n-- New tables\n+ CREATE TABLE notifications (\n+     id SERIAL PRIMARY KEY,\n+     user_id INTEGER NOT NULL REFERENCES users(id),\n+     message TEXT,\n+     read BOOLEAN DEFAULT false,\n+     created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n+ );\n\n-- New indexes\n+ CREATE INDEX idx_notifications_user ON notifications(user_id);\n\n-- Modified tables\n~ ALTER TABLE users ADD COLUMN last_login TIMESTAMP;\n\n-- Summary\n+ 1 table added (notifications)\n+ 1 index added\n~ 1 table modified (users)\n  Total changes: 3\n</code></pre></p>"},{"location":"es/commands/changes/diff/#ejemplo-completo","title":"Ejemplo Completo","text":""},{"location":"es/commands/changes/diff/#desarrollo-de-feature","title":"Desarrollo de Feature","text":"<pre><code># 1. Crear sandbox\n$ dbl sandbox start\n\n# 2. Agregar tabla de perfiles\n$ psql -d myapp_sandbox &lt;&lt; EOF\nCREATE TABLE user_profiles (\n    user_id INTEGER PRIMARY KEY REFERENCES users(id) ON DELETE CASCADE,\n    bio TEXT,\n    avatar_url VARCHAR(500),\n    location VARCHAR(100),\n    website VARCHAR(200),\n    twitter_handle VARCHAR(50),\n    github_handle VARCHAR(50)\n);\n\nCREATE INDEX idx_profiles_location ON user_profiles(location);\nEOF\n\n# 3. Modificar tabla users\n$ psql -d myapp_sandbox &lt;&lt; EOF\nALTER TABLE users \nADD COLUMN email_verified BOOLEAN DEFAULT false;\nEOF\n\n# 4. Ver todos los cambios\n$ dbl diff\n</code></pre> <p>Salida detallada: <pre><code>-- Changes in sandbox\n\n-- New tables\n+ CREATE TABLE user_profiles (\n+     user_id INTEGER PRIMARY KEY REFERENCES users(id) ON DELETE CASCADE,\n+     bio TEXT,\n+     avatar_url VARCHAR(500),\n+     location VARCHAR(100),\n+     website VARCHAR(200),\n+     twitter_handle VARCHAR(50),\n+     github_handle VARCHAR(50)\n+ );\n\n-- New indexes\n+ CREATE INDEX idx_profiles_location ON user_profiles(location);\n\n-- Modified tables\n~ ALTER TABLE users ADD COLUMN email_verified BOOLEAN DEFAULT false;\n\n-- Summary\n+ 1 table added (user_profiles)\n+ 2 indexes added (user_profiles_pkey, idx_profiles_location)\n~ 1 table modified (users: +1 column)\n  Total changes: 4\n</code></pre></p>"},{"location":"es/commands/changes/diff/#tipos-de-cambios","title":"Tipos de Cambios","text":""},{"location":"es/commands/changes/diff/#tablas-anadidas","title":"Tablas A\u00f1adidas","text":"<pre><code>+ CREATE TABLE comments (\n+     id SERIAL PRIMARY KEY,\n+     content TEXT NOT NULL\n+ );\n</code></pre>"},{"location":"es/commands/changes/diff/#tablas-modificadas","title":"Tablas Modificadas","text":"<pre><code>~ ALTER TABLE users ADD COLUMN phone VARCHAR(20);\n~ ALTER TABLE posts ADD COLUMN published_at TIMESTAMP;\n</code></pre>"},{"location":"es/commands/changes/diff/#tablas-eliminadas","title":"Tablas Eliminadas","text":"<pre><code>- DROP TABLE temp_data;\n</code></pre>"},{"location":"es/commands/changes/diff/#indices","title":"\u00cdndices","text":"<pre><code>+ CREATE INDEX idx_users_email ON users(email);\n- DROP INDEX idx_old_column;\n</code></pre>"},{"location":"es/commands/changes/diff/#constraints","title":"Constraints","text":"<pre><code>+ ALTER TABLE posts \n+ ADD CONSTRAINT fk_author \n+ FOREIGN KEY (author_id) REFERENCES users(id);\n</code></pre>"},{"location":"es/commands/changes/diff/#filtrar-cambios","title":"Filtrar Cambios","text":""},{"location":"es/commands/changes/diff/#tabla-especifica","title":"Tabla Espec\u00edfica","text":"<pre><code>dbl diff --tables users\n</code></pre> <p>Salida: <pre><code>-- Changes for table: users\n~ ALTER TABLE users ADD COLUMN last_login TIMESTAMP;\n~ ALTER TABLE users ADD COLUMN login_count INTEGER DEFAULT 0;\n</code></pre></p>"},{"location":"es/commands/changes/diff/#multiples-tablas","title":"M\u00faltiples Tablas","text":"<pre><code>dbl diff --tables users,posts,comments\n</code></pre>"},{"location":"es/commands/changes/diff/#solo-resumen","title":"Solo Resumen","text":"<pre><code>dbl diff --summary\n</code></pre> <p>Salida: <pre><code>Summary of changes:\n  + 2 tables added\n  ~ 3 tables modified\n  - 1 table dropped\n  + 5 indexes added\n  - 2 indexes dropped\n  Total: 13 changes\n</code></pre></p>"},{"location":"es/commands/changes/diff/#casos-de-uso","title":"Casos de Uso","text":""},{"location":"es/commands/changes/diff/#antes-de-commit","title":"Antes de Commit","text":"<pre><code># Revisar cambios antes de guardar\ndbl diff\n\n# Si se ven bien, guardar\ndbl commit -m \"Add user profiles feature\"\n</code></pre>"},{"location":"es/commands/changes/diff/#code-review","title":"Code Review","text":"<pre><code># Generar diff para revisi\u00f3n\ndbl diff &gt; changes.sql\n\n# Compartir con equipo\ngit add changes.sql\ngit commit -m \"Database changes for review\"\n</code></pre>"},{"location":"es/commands/changes/diff/#comparar-con-capa-anterior","title":"Comparar con Capa Anterior","text":"<pre><code># Ver qu\u00e9 ha cambiado desde \u00faltimo commit\ndbl diff\n\n# vs historial\ndbl log -n 1\n</code></pre>"},{"location":"es/commands/changes/diff/#depuracion","title":"Depuraci\u00f3n","text":"<pre><code># \u00bfQu\u00e9 cambi\u00f3?\ndbl diff --summary\n\n# Ver detalles de tabla problem\u00e1tica\ndbl diff --tables problematic_table\n</code></pre>"},{"location":"es/commands/changes/diff/#formato-de-salida","title":"Formato de Salida","text":""},{"location":"es/commands/changes/diff/#formato-estandar-default","title":"Formato Est\u00e1ndar (default)","text":"<pre><code>-- Comentarios explicativos\n+ SQL para creaciones (verde)\n~ SQL para modificaciones (amarillo)\n- SQL para eliminaciones (rojo)\n\n-- Summary al final\n</code></pre>"},{"location":"es/commands/changes/diff/#formato-sql-puro","title":"Formato SQL Puro","text":"<pre><code>dbl diff --sql\n</code></pre> <p>Salida: <pre><code>CREATE TABLE notifications (...);\nALTER TABLE users ADD COLUMN last_login TIMESTAMP;\nCREATE INDEX idx_notifications_user ON notifications(user_id);\n</code></pre></p> <p>Sin comentarios ni colores, listo para ejecutar.</p>"},{"location":"es/commands/changes/diff/#integracion-con-herramientas","title":"Integraci\u00f3n con Herramientas","text":""},{"location":"es/commands/changes/diff/#guardar-en-archivo","title":"Guardar en Archivo","text":"<pre><code># Para documentaci\u00f3n\ndbl diff &gt; docs/migration-2024-12-30.sql\n\n# Para revisi\u00f3n\ndbl diff --sql &gt; migration.sql\n</code></pre>"},{"location":"es/commands/changes/diff/#usar-en-scripts","title":"Usar en Scripts","text":"<pre><code>#!/bin/bash\n# check-changes.sh\n\nCHANGES=$(dbl diff --summary | grep \"Total:\")\n\nif [[ $CHANGES == *\"Total: 0\"* ]]; then\n    echo \"No changes detected\"\nelse\n    echo \"Changes found:\"\n    dbl diff --summary\nfi\n</code></pre>"},{"location":"es/commands/changes/diff/#validar-antes-de-aplicar","title":"Validar Antes de Aplicar","text":"<pre><code># Script de validaci\u00f3n\ndbl diff &gt; /tmp/changes.sql\n\n# Revisar SQL\nif grep -q \"DROP TABLE\" /tmp/changes.sql; then\n    echo \"\u26a0\ufe0f  Warning: Tables will be dropped!\"\n    read -p \"Continue? (y/n): \" confirm\n    [[ $confirm == \"y\" ]] || exit 1\nfi\n\ndbl commit -m \"Changes\"\n</code></pre>"},{"location":"es/commands/changes/diff/#comparacion-con-git","title":"Comparaci\u00f3n con Git","text":"<p>DBL diff es similar a <code>git diff</code>:</p> Git DBL Prop\u00f3sito <code>git diff</code> <code>dbl diff</code> Ver cambios sin guardar <code>git diff --staged</code> (N/A) DBL no tiene staging <code>git diff HEAD~1</code> <code>dbl log -n 1</code> Ver \u00faltimo cambio <code>git diff main</code> (futuro) Comparar ramas"},{"location":"es/commands/changes/diff/#notas-importantes","title":"Notas Importantes","text":"<p>Revisar Siempre</p> <p>Siempre ejecuta <code>dbl diff</code> antes de <code>dbl commit</code> para verificar cambios.</p> <p>Cambios Grandes</p> <p>Para esquemas grandes, diff puede tomar tiempo. Usa <code>--tables</code> para filtrar.</p> <p>Solo Esquema</p> <p>Diff solo muestra cambios de esquema, no datos.</p>"},{"location":"es/commands/changes/diff/#solucion-de-problemas","title":"Soluci\u00f3n de Problemas","text":""},{"location":"es/commands/changes/diff/#no-active-sandbox","title":"\"No active sandbox\"","text":"<pre><code># Necesitas crear un sandbox primero\ndbl sandbox start\n</code></pre>"},{"location":"es/commands/changes/diff/#diff-toma-mucho-tiempo","title":"Diff Toma Mucho Tiempo","text":"<pre><code># Filtrar por tablas espec\u00edficas\ndbl diff --tables tabla1,tabla2\n</code></pre>"},{"location":"es/commands/changes/diff/#diff-esta-vacio","title":"Diff Est\u00e1 Vac\u00edo","text":"<pre><code># Verificar que hiciste cambios\npsql -d myapp_sandbox -c \"\\dt\"\n\n# Comparar manualmente\npsql -d myapp -c \"\\dt\"\npsql -d myapp_sandbox -c \"\\dt\"\n</code></pre>"},{"location":"es/commands/changes/diff/#ejemplos-avanzados","title":"Ejemplos Avanzados","text":""},{"location":"es/commands/changes/diff/#comparar-esquemas-complejos","title":"Comparar Esquemas Complejos","text":"<pre><code># Ver cambios en estructura completa\ndbl diff\n\n# Ver solo nuevas tablas\ndbl diff | grep \"^+\"\n\n# Ver solo modificaciones\ndbl diff | grep \"^~\"\n\n# Ver solo eliminaciones\ndbl diff | grep \"^-\"\n</code></pre>"},{"location":"es/commands/changes/diff/#generar-reporte","title":"Generar Reporte","text":"<pre><code>#!/bin/bash\n# generate-report.sh\n\necho \"# Database Changes Report\" &gt; report.md\necho \"Date: $(date)\" &gt;&gt; report.md\necho \"\" &gt;&gt; report.md\necho \"## Summary\" &gt;&gt; report.md\ndbl diff --summary &gt;&gt; report.md\necho \"\" &gt;&gt; report.md\necho \"## Detailed Changes\" &gt;&gt; report.md\necho '```sql' &gt;&gt; report.md\ndbl diff --sql &gt;&gt; report.md\necho '```' &gt;&gt; report.md\n</code></pre>"},{"location":"es/commands/changes/diff/#cicd-integration","title":"CI/CD Integration","text":"<pre><code># .github/workflows/db-changes.yml\n- name: Show database changes\n  run: |\n    dbl diff --summary\n    dbl diff &gt; db-changes.sql\n\n- name: Upload changes\n  uses: actions/upload-artifact@v3\n  with:\n    name: db-changes\n    path: db-changes.sql\n</code></pre>"},{"location":"es/commands/changes/diff/#ver-tambien","title":"Ver Tambi\u00e9n","text":"<ul> <li><code>dbl commit</code> - Guardar cambios</li> <li><code>dbl sandbox status</code> - Estado del sandbox</li> <li><code>dbl sandbox start</code> - Crear sandbox</li> <li><code>dbl log</code> - Ver historial de cambios</li> </ul>"},{"location":"es/commands/changes/reset/","title":"dbl reset","text":"<p>Reconstruir la base de datos principal desde las capas guardadas.</p>"},{"location":"es/commands/changes/reset/#sinopsis","title":"Sinopsis","text":"<pre><code>dbl reset\n</code></pre>"},{"location":"es/commands/changes/reset/#descripcion","title":"Descripci\u00f3n","text":"<p>Elimina todo del esquema en la base de datos principal y lo reconstruye desde cero ejecutando todas las capas en orden. \u00datil para verificar que tus capas se replayan correctamente.</p>"},{"location":"es/commands/changes/reset/#que-hace","title":"Qu\u00e9 Hace","text":"<ol> <li>Respalda datos (opcional) - Crea backup antes de reset</li> <li>Limpia esquema - Elimina todas las tablas, \u00edndices, etc.</li> <li>Ejecuta capas - Aplica cada capa en orden desde cero</li> <li>Valida - Verifica integridad del resultado</li> </ol>"},{"location":"es/commands/changes/reset/#ejemplo-de-uso","title":"Ejemplo de Uso","text":"<pre><code>dbl reset\n</code></pre> <p>Salida: <pre><code>Resetting database to initial state...\nBacking up current schema...\n\u2713 Backup created: myapp_backup_20241230.sql\n\nClearing existing schema...\n\u2713 Dropped 45 tables, 28 indexes, 12 constraints\n\nReplaying layers from scratch...\n  \u2713 L001 - Initial schema (0.1s)\n  \u2713 L002 - Add users table (0.2s)\n  \u2713 L003 - Add posts table (0.3s)\n  \u2713 L004 - Add comments (0.1s)\n  \u2713 L005 - Add indexes (2.1s)\n\nSchema validation:\n  \u2713 45 tables\n  \u2713 28 indexes\n  \u2713 12 constraints\n  \u2713 Referential integrity OK\n\nReset complete in 2.8s\n</code></pre></p>"},{"location":"es/commands/changes/reset/#cuando-usar","title":"Cu\u00e1ndo Usar","text":""},{"location":"es/commands/changes/reset/#usa-reset-cuando","title":"\u2705 Usa Reset Cuando:","text":"<ul> <li>Verificar capas: Asegurar que se replayan correctamente</li> <li>Ambiente limpio: Necesitas empezar desde cero</li> <li>Eliminar datos: Limpiar base de datos en desarrollo</li> <li>Resolver corrupci\u00f3n: Reconstruir despu\u00e9s de errores</li> <li>Testing: Recrear estado inicial en tests</li> </ul>"},{"location":"es/commands/changes/reset/#no-uses-cuando","title":"\u274c No Uses Cuando:","text":"<ul> <li>Producci\u00f3n: \u00a1Peligro de p\u00e9rdida de datos!</li> <li>Datos importantes: Usar en dev/test solamente</li> <li>Querydepis guardadas: Verificarlas antes de reset</li> </ul>"},{"location":"es/commands/changes/reset/#ejemplos-detallados","title":"Ejemplos Detallados","text":""},{"location":"es/commands/changes/reset/#resetear-desarrollo","title":"Resetear Desarrollo","text":"<pre><code># Base de datos con datos de prueba old\n$ dbl reset\n\nResetting blog database...\n\u2713 Backed up as blog_backup_20241230.sql\n\u2713 Cleared 50 tables\n\u2713 Replayed 12 layers\n\u2713 Done in 3.2s\n\n# Ahora tienes esquema limpio desde capas\n</code></pre>"},{"location":"es/commands/changes/reset/#verificar-que-capas-sean-correctas","title":"Verificar Que Capas Sean Correctas","text":"<pre><code># Crear sandbox con cambios\n$ dbl sandbox start\n$ psql -d blog_sandbox -c \"ALTER TABLE posts ADD COLUMN featured BOOLEAN;\"\n$ dbl commit -m \"Add featured column\"\n$ dbl sandbox apply\n\n# Verificar que se replaya correctamente\n$ dbl reset  # Reconstruir desde cero\n$ psql -d blog -c \"\\d posts\"  # Verificar featured existe\n\n      Column      |  Type\n------------------+---------\n id               | integer\n title            | text\n featured         | boolean  \u2190 \u00a1Correcto!\n</code></pre>"},{"location":"es/commands/changes/reset/#resolver-errores-de-replayabilidad","title":"Resolver Errores de Replayabilidad","text":"<pre><code># Intentar reset\n$ dbl reset\nError: Layer L008 failed to replay\n  SQL Error in L008_add_comments.sql line 15:\n  Column \"user_id\" does not exist\n\n# Problema: L008 asume que existe \"user_id\" de L007\n# Pero L007 tiene el nombre \"author_id\"\n\n# Soluci\u00f3n: Arreglar L008\n$ nano .dbl/layers/L008_add_comments.sql\n# Cambiar user_id a author_id\n\n# Reintentar\n$ dbl reset\n\u2713 Reset successful\n</code></pre>"},{"location":"es/commands/changes/reset/#alternativas","title":"Alternativas","text":""},{"location":"es/commands/changes/reset/#sandbox-reset-seguro","title":"Sandbox Reset (Seguro)","text":"<p>Para probar reset sin afectar base principal:</p> <pre><code># Crear sandbox limpio\n$ dbl sandbox start\n\n# Sandbox comienza desde cero autom\u00e1ticamente\n# Ya est\u00e1 rebuildizado desde capas\n$ dbl sandbox status\nStatus: Clean (freshly built)\n</code></pre>"},{"location":"es/commands/changes/reset/#reset-selectivo","title":"Reset Selectivo","text":"<p>Para resetear solo ciertos datos:</p> <pre><code># Borrar solo datos, mantener esquema\n$ psql -d myapp -c \"\n  TRUNCATE users, posts, comments CASCADE;\n\"\n\n# O usar seed script\n$ dbl seed --file seeds.sql\n</code></pre>"},{"location":"es/commands/changes/reset/#seguridad-y-backups","title":"Seguridad y Backups","text":""},{"location":"es/commands/changes/reset/#backup-automatico","title":"Backup Autom\u00e1tico","text":"<p>DBL crea backup antes de reset:</p> <pre><code>myapp_backup_20241230_143022.sql\n</code></pre> <p>Puedes restaurar si algo sale mal:</p> <pre><code>$ psql myapp &lt; myapp_backup_20241230_143022.sql\n</code></pre>"},{"location":"es/commands/changes/reset/#sin-backup-en-ciertos-casos","title":"Sin Backup en Ciertos Casos","text":"<pre><code># Force reset sin backup (\u00a1cuidado!)\ndbl reset --no-backup\n</code></pre> <p>Sin Backup = Datos Perdidos</p> <p>Siempre hacer backup manual primero si es importante: <pre><code>pg_dump myapp &gt; myapp_manual_backup.sql\ndbl reset\n</code></pre></p>"},{"location":"es/commands/changes/reset/#flujo-completo","title":"Flujo Completo","text":""},{"location":"es/commands/changes/reset/#desarrollo-con-reset","title":"Desarrollo con Reset","text":"<pre><code># 1. Empezar\n$ dbl init blog\n\n# 2. Crear tabla usuarios\n$ dbl sandbox start\n$ psql -d blog_sandbox -c \"CREATE TABLE users (...);\"\n$ dbl commit -m \"Create users table\"\n$ dbl sandbox apply\n\n# 3. Agregar columnas\n$ dbl sandbox start\n$ psql -d blog_sandbox -c \"ALTER TABLE users ADD COLUMN email TEXT;\"\n$ dbl commit -m \"Add email column\"\n$ dbl sandbox apply\n\n# 4. Verificar que se replaya desde cero\n$ dbl reset\n\u2713 Database rebuilt from 2 layers\n\n# 5. Agregar datos de test\n$ psql blog &lt; seeds.sql\n\n# 6. Desarrollar\n# ...\n\n# 7. Limpiar para nuevo developer\n$ dbl reset\n</code></pre>"},{"location":"es/commands/changes/reset/#casos-de-uso","title":"Casos de Uso","text":""},{"location":"es/commands/changes/reset/#integracion-continua","title":"Integraci\u00f3n Continua","text":"<pre><code># .github/workflows/test.yml\nname: Test Schema\n\njobs:\n  test:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Reset to clean state\n        run: dbl reset\n\n      - name: Run migrations\n        run: ./migrations/run.sh\n\n      - name: Run tests\n        run: pytest tests/\n</code></pre>"},{"location":"es/commands/changes/reset/#onboarding-de-developers","title":"Onboarding de Developers","text":"<pre><code>#!/bin/bash\n# setup-dev.sh\n\n# Nuevo developer ejecuta:\n# 1. Clonar repo\ngit clone &lt;repo&gt;\n\n# 2. Instalar DBL\npip install dbl\n\n# 3. Crear base de datos limpia\ndbl reset\n\n# 4. Cargar datos de test\npsql myapp &lt; fixtures/seed.sql\n\necho \"\u2713 Development environment ready!\"\n</code></pre>"},{"location":"es/commands/changes/reset/#debugging-de-capas","title":"Debugging de Capas","text":"<pre><code># Problema: Layer L015 no se aplica correctamente\n$ dbl reset\nError: L015 failed\n\n# Investigar\n$ cat .dbl/layers/L015_*.sql\n\n# Arreglar\n$ vim .dbl/layers/L015_*.sql\n\n# Reintentar\n$ dbl reset\n\u2713 Success\n</code></pre>"},{"location":"es/commands/changes/reset/#estados-post-reset","title":"Estados Post-Reset","text":""},{"location":"es/commands/changes/reset/#despues-de-reset","title":"Despu\u00e9s de Reset","text":"<pre><code># Base est\u00e1 limpia, sin cambios sin guardar\n$ dbl sandbox status\nNo active sandbox\n\n# Logs siguen ah\u00ed\n$ dbl log\n* L005 - Add indexes\n* L004 - Add comments\n...\n\n# Puedes crear sandbox fresco\n$ dbl sandbox start\n$ dbl sandbox status\nStatus: Clean (freshly built)\n</code></pre>"},{"location":"es/commands/changes/reset/#ejemplos-de-replayabilidad","title":"Ejemplos de Replayabilidad","text":""},{"location":"es/commands/changes/reset/#problemas-comunes","title":"\u274c Problemas Comunes","text":"<pre><code>-- MALO: Asume estado previo\nALTER TABLE users ADD COLUMN email TEXT;\n-- \u00bfY si la tabla no existe?\n\n-- BUENO: Crea si no existe\nCREATE TABLE IF NOT EXISTS users (...);\nALTER TABLE users ADD COLUMN IF NOT EXISTS email TEXT;\n</code></pre>"},{"location":"es/commands/changes/reset/#practicas-correctas","title":"\u2705 Pr\u00e1cticas Correctas","text":"<pre><code>-- Usar IF NOT EXISTS en todo\nCREATE TABLE IF NOT EXISTS users (...);\nCREATE INDEX IF NOT EXISTS idx_users_email ON users(email);\n\n-- Estar expl\u00edcito\nCREATE SCHEMA IF NOT EXISTS public;\nCREATE EXTENSION IF NOT EXISTS uuid-ossp;\n\n-- Usar transacciones\nBEGIN;\n  -- Cambios at\u00f3micos\nCOMMIT;\n</code></pre>"},{"location":"es/commands/changes/reset/#limpieza-de-backups","title":"Limpieza de Backups","text":"<p>Los backups se acumulan. Limpiar peri\u00f3dicamente:</p> <pre><code># Encontrar backups antiguos\nfind . -name \"*_backup_*.sql\" -mtime +30\n\n# Eliminar backups m\u00e1s viejos de 30 d\u00edas\nfind . -name \"*_backup_*.sql\" -mtime +30 -delete\n\n# O manualmente\nrm myapp_backup_20241220*.sql\n</code></pre>"},{"location":"es/commands/changes/reset/#mejores-practicas","title":"Mejores Pr\u00e1cticas","text":"<ol> <li>Testear replayabilidad: Ejecutar reset regularmente</li> <li>Usar IF NOT EXISTS: Hacer capas idempotentes</li> <li>Ordenar capas: Dependencias en orden correcto</li> <li>Backup antes: Siempre hacer backup en datos importantes</li> <li>Documentar: Anotar por qu\u00e9 cada cambio es necesario</li> </ol>"},{"location":"es/commands/changes/reset/#ver-tambien","title":"Ver Tambi\u00e9n","text":"<ul> <li><code>dbl sandbox start</code> - Crear sandbox limpio</li> <li><code>dbl commit</code> - Guardar cambios en capas</li> <li><code>dbl log</code> - Ver historial de capas</li> <li><code>dbl diff</code> - Comparar cambios</li> <li>Troubleshooting - Resolver problemas</li> </ul>"},{"location":"es/commands/history/log/","title":"dbl log","text":"<p>Ver el historial de capas y cambios del database.</p>"},{"location":"es/commands/history/log/#sinopsis","title":"Sinopsis","text":"<pre><code>dbl log\ndbl log [--branch BRANCH]\ndbl log [--limit N]\ndbl log [--oneline]\n</code></pre>"},{"location":"es/commands/history/log/#descripcion","title":"Descripci\u00f3n","text":"<p>Muestra el historial de todas las capas creadas, incluyendo qui\u00e9n hizo el cambio, cu\u00e1ndo, y qu\u00e9 se modific\u00f3. Similar a <code>git log</code> pero para tu base de datos.</p>"},{"location":"es/commands/history/log/#ejemplo-de-uso","title":"Ejemplo de Uso","text":"<pre><code>dbl log\n</code></pre> <p>Salida: <pre><code>commit L015 (HEAD -&gt; main)\nAuthor: Ana Garc\u00eda &lt;ana@company.com&gt;\nDate:   2024-12-30 14:35:22 +0000\n\n    Add webhook notification system\n\ncommit L014\nAuthor: Carlos L\u00f3pez &lt;carlos@company.com&gt;\nDate:   2024-12-30 10:22:41 +0000\n\n    Add rate limiting to API\n\ncommit L013\nAuthor: Ana Garc\u00eda &lt;ana@company.com&gt;\nDate:   2024-12-29 16:18:33 +0000\n\n    Add user notifications table\n\ncommit L012\n...\n</code></pre></p>"},{"location":"es/commands/history/log/#opciones","title":"Opciones","text":""},{"location":"es/commands/history/log/#-oneline","title":"<code>--oneline</code>","text":"<p>Formato compacto:</p> <pre><code>$ dbl log --oneline\n\nL015 - Add webhook notification system\nL014 - Add rate limiting to API\nL013 - Add user notifications table\nL012 - Add comments feature\nL011 - Add post reactions\n</code></pre>"},{"location":"es/commands/history/log/#-limit-n","title":"<code>--limit N</code>","text":"<p>Ver solo \u00faltimas N capas:</p> <pre><code>$ dbl log --limit 5\n\n# Muestra las 5 capas m\u00e1s recientes\n</code></pre>"},{"location":"es/commands/history/log/#-branch-branch","title":"<code>--branch BRANCH</code>","text":"<p>Ver log de rama espec\u00edfica:</p> <pre><code>$ dbl log --branch feature-auth\n\n# Muestra historial de feature-auth\n</code></pre>"},{"location":"es/commands/history/log/#-author-author","title":"<code>--author AUTHOR</code>","text":"<p>Filtrar por autor:</p> <pre><code>$ dbl log --author \"Ana Garc\u00eda\"\n\n# Muestra solo cambios de Ana\n</code></pre>"},{"location":"es/commands/history/log/#-since-date","title":"<code>--since DATE</code>","text":"<p>Cambios despu\u00e9s de fecha:</p> <pre><code>$ dbl log --since \"2024-12-20\"\n\n# Cambios desde 20 de diciembre\n</code></pre>"},{"location":"es/commands/history/log/#ejemplos-completos","title":"Ejemplos Completos","text":""},{"location":"es/commands/history/log/#ver-historial-completo","title":"Ver Historial Completo","text":"<pre><code>$ dbl log\n\n* L015 Add webhook system (Ana, 14:35)\n* L014 Add rate limiting (Carlos, 10:22)\n* L013 Add notifications (Ana, 16:18)\n* L012 Add comments (Carlos, 09:45)\n* L011 Add reactions (Ana, 08:30)\n</code></pre>"},{"location":"es/commands/history/log/#buscar-cambio-especifico","title":"Buscar Cambio Espec\u00edfico","text":"<pre><code># Qui\u00e9n agreg\u00f3 una feature?\n$ dbl log | grep -i \"email\"\n\n* L008 Add email verification (Ana, 2024-12-25 11:22)\n\n# Detalles de esa capa\n$ cat .dbl/layers/L008_*.sql\n</code></pre>"},{"location":"es/commands/history/log/#ver-cambios-de-usuario","title":"Ver Cambios de Usuario","text":"<pre><code>$ dbl log --author \"Ana Garc\u00eda\"\n\n* L015 Add webhook system\n* L013 Add notifications\n* L011 Add reactions\n* L009 Add user preferences\n* L007 Add authentication\n</code></pre>"},{"location":"es/commands/history/log/#ultimas-n-capas","title":"\u00daltimas N Capas","text":"<pre><code>$ dbl log --limit 3 --oneline\n\n* L015 Add webhook notification system\n* L014 Add rate limiting to API\n* L013 Add user notifications table\n</code></pre>"},{"location":"es/commands/history/log/#historial-de-rama","title":"Historial de Rama","text":"<pre><code>$ dbl log --branch feature-auth\n\n* L010 Add OAuth2 integration (feature-auth)\n* L009 Add social login (feature-auth)\n* L008 Add password reset (feature-auth)\n\n$ dbl log --branch main\n\n* L007 Add authentication (main)\n* L006 Add users table (main)\n</code></pre>"},{"location":"es/commands/history/log/#interpretar-salida","title":"Interpretar Salida","text":""},{"location":"es/commands/history/log/#componentes","title":"Componentes","text":"<pre><code>commit L015                              \u2190 ID de capa\nAuthor: Ana Garc\u00eda &lt;ana@company.com&gt;     \u2190 Qui\u00e9n hizo cambio\nDate:   2024-12-30 14:35:22 +0000        \u2190 Cu\u00e1ndo\n                                          \u2190 Blank line\n    Add webhook notification system      \u2190 Mensaje de commit\n</code></pre>"},{"location":"es/commands/history/log/#estados-de-rama","title":"Estados de Rama","text":"<pre><code>commit L015 (HEAD -&gt; main)  \u2190 HEAD en main\ncommit L014 (feature-auth)  \u2190 HEAD en feature-auth\ncommit L013                 \u2190 Sin rama espec\u00edfica\n</code></pre>"},{"location":"es/commands/history/log/#casos-de-uso","title":"Casos de Uso","text":""},{"location":"es/commands/history/log/#auditoria","title":"Auditor\u00eda","text":"<pre><code># Qui\u00e9n cambi\u00f3 qu\u00e9?\n$ dbl log --author \"carlos@company.com\" --since \"2024-12-01\"\n\nL020 - Fix migration script (2024-12-15)\nL019 - Add payment processing (2024-12-10)\nL018 - Fix indexing strategy (2024-12-05)\n</code></pre>"},{"location":"es/commands/history/log/#debugging","title":"Debugging","text":"<pre><code># Cu\u00e1ndo se rompi\u00f3?\n$ dbl log --oneline | head -20\n\n# Capa reciente que podr\u00eda ser el problema\nL025 - Refactor user roles\n\n# Ver qu\u00e9 cambi\u00f3 en L025\n$ cat .dbl/layers/L025_*.sql\n</code></pre>"},{"location":"es/commands/history/log/#release-notes","title":"Release Notes","text":"<pre><code>#!/bin/bash\n# generate-release-notes.sh\n\nLAST_TAG=$(git describe --tags --abbrev=0)\nLAST_COMMIT=$(git rev-list -n 1 $LAST_TAG)\n\necho \"# Changes in this release\"\ndbl log --since \"$LAST_COMMIT\"\n</code></pre>"},{"location":"es/commands/history/log/#comparacion-de-ramas","title":"Comparaci\u00f3n de Ramas","text":"<pre><code># Diferencias entre ramas\n$ dbl log --branch main | wc -l\n42 cambios en main\n\n$ dbl log --branch staging | wc -l\n38 cambios en staging\n\n# staging necesita 4 capas de main\n</code></pre>"},{"location":"es/commands/history/log/#integracion-con-scripts","title":"Integraci\u00f3n con Scripts","text":""},{"location":"es/commands/history/log/#python","title":"Python","text":"<pre><code>import subprocess\nimport json\n\n# Obtener log\nresult = subprocess.run(['dbl', 'log', '--oneline'], \n                       capture_output=True, text=True)\n\nlayers = []\nfor line in result.stdout.strip().split('\\n'):\n    layer_id, message = line.split(' - ', 1)\n    layers.append({'id': layer_id, 'message': message})\n\nprint(f\"Total layers: {len(layers)}\")\n</code></pre>"},{"location":"es/commands/history/log/#bash","title":"Bash","text":"<pre><code>#!/bin/bash\n# get-last-author.sh\n\nLAST_AUTHOR=$(dbl log --oneline | head -1 | awk '{print $NF}')\necho \"Last change by: $LAST_AUTHOR\"\n</code></pre>"},{"location":"es/commands/history/log/#formatos-de-salida","title":"Formatos de Salida","text":""},{"location":"es/commands/history/log/#compacto-oneline","title":"Compacto (--oneline)","text":"<pre><code>L025 - Add webhook endpoints\nL024 - Fix user profile bug\nL023 - Optimize queries\n</code></pre>"},{"location":"es/commands/history/log/#detallado-default","title":"Detallado (default)","text":"<pre><code>commit L025\nAuthor: Ana Garc\u00eda &lt;ana@company.com&gt;\nDate:   2024-12-30 16:45:22 +0000\n\n    Add webhook endpoints\n\n    - POST /webhooks\n    - GET /webhooks/:id\n    - DELETE /webhooks/:id\n</code></pre>"},{"location":"es/commands/history/log/#solo-mensajes","title":"Solo mensajes","text":"<pre><code>$ dbl log --format=\"%s\"\n\nAdd webhook endpoints\nFix user profile bug\nOptimize queries\n</code></pre>"},{"location":"es/commands/history/log/#mejores-practicas-de-mensajes","title":"Mejores Pr\u00e1cticas de Mensajes","text":""},{"location":"es/commands/history/log/#mensajes-malos","title":"\u274c Mensajes Malos","text":"<pre><code>L025 - stuff\nL026 - fixes\nL027 - update\n</code></pre>"},{"location":"es/commands/history/log/#mensajes-buenos","title":"\u2705 Mensajes Buenos","text":"<pre><code>L025 - Add webhook notification system\n\nL026 - Fix user profile update query N+1 problem\n\nL027 - Optimize user dashboard query with materialized view\n</code></pre>"},{"location":"es/commands/history/log/#formato-estandar","title":"Formato Est\u00e1ndar","text":"<pre><code>&lt;tipo&gt;: &lt;descripci\u00f3n breve&gt;\n\n&lt;descripci\u00f3n detallada&gt;\n\n&lt;cambios&gt;\n- Agregar tabla X\n- Modificar columna Y\n- Crear \u00edndice Z\n</code></pre>"},{"location":"es/commands/history/log/#ejemplos-de-busqueda","title":"Ejemplos de B\u00fasqueda","text":""},{"location":"es/commands/history/log/#encontrar-feature","title":"Encontrar Feature","text":"<pre><code># D\u00f3nde est\u00e1 la feature de comentarios?\n$ dbl log | grep -i comment\n\nL012 - Add comments feature\nL008 - Create comments table\n</code></pre>"},{"location":"es/commands/history/log/#cronologia-de-feature","title":"Cronolog\u00eda de Feature","text":"<pre><code># Historia completa de una feature\n$ dbl log --oneline | grep -i \"payment\"\n\nL030 - Add webhook for payment confirmations\nL029 - Add payment method storage\nL028 - Add payment processing endpoint\nL027 - Create payments table\n</code></pre>"},{"location":"es/commands/history/log/#cambios-en-rango-de-fechas","title":"Cambios en Rango de Fechas","text":"<pre><code>$ dbl log --since \"2024-12-01\" --until \"2024-12-15\"\n\n# Todas las capas entre esas fechas\n</code></pre>"},{"location":"es/commands/history/log/#comparar-con-git","title":"Comparar con Git","text":"Aspecto Git Log DBL Log Qu\u00e9 Cambios en c\u00f3digo Cambios en esquema DB Historial Commits de c\u00f3digo Capas de DB Trazabilidad Por desarrollador Por qui\u00e9n, cu\u00e1ndo, qu\u00e9 Reproducibilidad Checkout a commit Reset a capa espec\u00edfica"},{"location":"es/commands/history/log/#proximos-pasos","title":"Pr\u00f3ximos Pasos","text":"<p>Despu\u00e9s de revisar log:</p> <ul> <li>Inspeccionar capa: <code>cat .dbl/layers/L015_*.sql</code></li> <li>Resetear a punto: <code>dbl reset</code> y luego crear desde ah\u00ed</li> <li>Comparar ramas: <code>dbl log --branch feature-xyz</code></li> <li>Ver cambios: <code>dbl diff</code> de cambios sin guardar</li> </ul>"},{"location":"es/commands/history/log/#ver-tambien","title":"Ver Tambi\u00e9n","text":"<ul> <li><code>dbl diff</code> - Ver cambios detallados</li> <li><code>dbl commit</code> - Crear nuevas capas</li> <li><code>dbl reset</code> - Reconstruir desde capas</li> <li><code>dbl branch</code> - Gestionar ramas</li> </ul>"},{"location":"es/commands/sandbox/apply/","title":"dbl sandbox apply","text":"<p>Aplicar cambios del sandbox a la base de datos principal.</p>"},{"location":"es/commands/sandbox/apply/#sinopsis","title":"Sinopsis","text":"<pre><code>dbl sandbox apply\n</code></pre>"},{"location":"es/commands/sandbox/apply/#descripcion","title":"Descripci\u00f3n","text":"<p>Aplica todos los cambios del sandbox a tu base de datos principal, haci\u00e9ndolos permanentes. Tambi\u00e9n limpia autom\u00e1ticamente la base de datos sandbox.</p>"},{"location":"es/commands/sandbox/apply/#que-hace","title":"Qu\u00e9 Hace","text":"<ol> <li>Valida estado del sandbox - Asegura que sandbox est\u00e9 activo y tenga commits</li> <li>Aplica capas - Ejecuta SQL de capas en base principal</li> <li>Actualiza estado - Marca capas como aplicadas</li> <li>Elimina sandbox - Borra base de datos temporal</li> <li>Limpia metadata - Elimina archivos de rastreo</li> </ol>"},{"location":"es/commands/sandbox/apply/#ejemplo-de-uso","title":"Ejemplo de Uso","text":"<pre><code># Flujo completo\ndbl sandbox start\n# Hacer cambios...\ndbl diff\ndbl commit -m \"Add user preferences\"\ndbl sandbox apply\n</code></pre> <p>Salida: <pre><code>Applying sandbox changes to main database...\n\u2713 Executing layer L005\n\u2713 Changes applied successfully\n\u2713 Sandbox database dropped\n\u2713 Sandbox metadata cleared\n\nYour main database (myapp) now includes all sandbox changes.\n</code></pre></p>"},{"location":"es/commands/sandbox/apply/#flujo-detallado","title":"Flujo Detallado","text":""},{"location":"es/commands/sandbox/apply/#paso-a-paso","title":"Paso a Paso","text":"<pre><code># 1. Crear sandbox\n$ dbl sandbox start\n\u2713 Sandbox created: myapp_sandbox\n\n# 2. Hacer cambios\n$ psql -d myapp_sandbox -c \"\nCREATE TABLE notifications (\n    id SERIAL PRIMARY KEY,\n    user_id INTEGER NOT NULL,\n    message TEXT,\n    read BOOLEAN DEFAULT false\n);\n\"\n\n# 3. Revisar cambios\n$ dbl diff\n+ CREATE TABLE notifications (...)\n\n# 4. Guardar\n$ dbl commit -m \"Add notifications feature\"\n\u2713 Layer L008 created\n\n# 5. Aplicar a principal\n$ dbl sandbox apply\n\u2713 Applied layer L008 to myapp\n\u2713 Sandbox cleaned up\n\n# 6. Verificar\n$ psql -d myapp -c \"\\dt\"\n         List of relations\n Schema |      Name       | Type  \n--------+-----------------+-------\n public | users           | table\n public | posts           | table\n public | notifications   | table  \u2190 \u00a1Nuevo!\n</code></pre>"},{"location":"es/commands/sandbox/apply/#caracteristicas-de-seguridad","title":"Caracter\u00edsticas de Seguridad","text":""},{"location":"es/commands/sandbox/apply/#verificaciones-previas","title":"Verificaciones Previas","text":"<p>DBL valida antes de aplicar:</p> <ul> <li>\u2705 Sandbox est\u00e1 activo</li> <li>\u2705 Hay commits para aplicar</li> <li>\u2705 Base principal es accesible</li> <li>\u2705 No hay cambios conflictivos</li> </ul>"},{"location":"es/commands/sandbox/apply/#solo-se-aplican-commits","title":"Solo Se Aplican Commits","text":"<p>Solo se aplican capas guardadas (commits):</p> <pre><code># Sandbox tiene cambios sin guardar\n$ dbl diff\n+ ALTER TABLE users ADD COLUMN email TEXT;\n\n$ dbl sandbox apply\nError: Uncommitted changes detected\nCommit your changes first with: dbl commit -m \"message\"\n\n# Despu\u00e9s de guardar\n$ dbl commit -m \"Add email column\"\n$ dbl sandbox apply\n\u2713 Applied successfully\n</code></pre>"},{"location":"es/commands/sandbox/apply/#ejemplo-completo","title":"Ejemplo Completo","text":""},{"location":"es/commands/sandbox/apply/#agregar-feature-de-comentarios","title":"Agregar Feature de Comentarios","text":"<pre><code># 1. Iniciar sandbox\n$ dbl sandbox start\n\u2713 Sandbox: myapp_sandbox\n\n# 2. Agregar tablas\n$ psql -d myapp_sandbox &lt;&lt; EOF\n-- Tabla de comentarios\nCREATE TABLE comments (\n    id SERIAL PRIMARY KEY,\n    post_id INTEGER REFERENCES posts(id) ON DELETE CASCADE,\n    user_id INTEGER NOT NULL,\n    content TEXT NOT NULL,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- \u00cdndices\nCREATE INDEX idx_comments_post ON comments(post_id);\nCREATE INDEX idx_comments_user ON comments(user_id);\nEOF\n\n# 3. Revisar\n$ dbl diff\n+ CREATE TABLE comments (...)\n+ CREATE INDEX idx_comments_post ...\n+ CREATE INDEX idx_comments_user ...\n\n# 4. Guardar\n$ dbl commit -m \"Add comments feature with indexes\"\n\u2713 Layer L012 created\n\n# 5. Aplicar a principal\n$ dbl sandbox apply\n\nApplying sandbox changes to main database (myapp)...\n  \u2192 Executing L012_add_comments_feature.sql\n  \u2192 Creating table comments\n  \u2192 Creating indexes\n\u2713 All changes applied successfully\n\nCleaning up sandbox...\n  \u2192 Dropping database myapp_sandbox\n  \u2192 Removing sandbox metadata\n\u2713 Sandbox cleaned up\n\nSummary:\n  Database: myapp\n  Layers applied: 1 (L012)\n  Tables added: 1 (comments)\n  Indexes added: 2\n</code></pre>"},{"location":"es/commands/sandbox/apply/#estado-de-la-base-de-datos","title":"Estado de la Base de Datos","text":""},{"location":"es/commands/sandbox/apply/#antes-y-despues","title":"Antes y Despu\u00e9s","text":"<pre><code>Antes:\n  Base Principal: myapp          (esquema antiguo)\n  Sandbox: myapp_sandbox         (esquema nuevo)\n\nDespu\u00e9s:\n  Base Principal: myapp          (esquema nuevo) \u2713\n  Sandbox: (eliminado)\n</code></pre>"},{"location":"es/commands/sandbox/apply/#archivos-actualizados","title":"Archivos Actualizados","text":"<pre><code>.dbl/\n\u251c\u2500\u2500 state.json          \u2190 Actualizado (no hay sandbox activo)\n\u251c\u2500\u2500 layers/\n\u2502   \u2514\u2500\u2500 L012_*.sql      \u2190 Aplicada a principal\n\u2514\u2500\u2500 sandbox.json        \u2190 Eliminado\n</code></pre>"},{"location":"es/commands/sandbox/apply/#notas-importantes","title":"Notas Importantes","text":"<p>Cambios Permanentes</p> <p>Despu\u00e9s de <code>sandbox apply</code>, los cambios est\u00e1n en tu base de datos principal. No hay deshacer excepto con backups.</p> <p>Posible Downtime</p> <p>Algunas operaciones pueden bloquear tablas brevemente. Planifica en horarios de bajo uso.</p> <p>Prueba Primero</p> <p>Usa <code>dbl reset</code> en ambiente de prueba para verificar que las capas se replayan correctamente.</p>"},{"location":"es/commands/sandbox/apply/#alternativa-de-rollback","title":"Alternativa de Rollback","text":"<p>Si no est\u00e1s listo para aplicar:</p> <pre><code># Descartar sandbox\ndbl sandbox rollback\n\n# Sandbox y cambios se eliminan\n# Base principal sin cambios\n</code></pre>"},{"location":"es/commands/sandbox/apply/#despliegue-en-produccion","title":"Despliegue en Producci\u00f3n","text":""},{"location":"es/commands/sandbox/apply/#aplicacion-segura-en-produccion","title":"Aplicaci\u00f3n Segura en Producci\u00f3n","text":"<pre><code># 1. Hacer backup primero\npg_dump myapp_prod &gt; backup_$(date +%Y%m%d).sql\n\n# 2. Probar en staging\ndbl --config staging.yaml sandbox apply\n\n# 3. Verificar que app funciona\n./run-tests.sh\n\n# 4. Aplicar a producci\u00f3n (en ventana de mantenimiento)\ndbl --config production.yaml sandbox apply\n\n# 5. Verificar\n./verify-schema.sh\n</code></pre>"},{"location":"es/commands/sandbox/apply/#despliegue-sin-downtime","title":"Despliegue sin Downtime","text":"<p>Usa patr\u00f3n expand-contract:</p> <pre><code># Semana 1: Expand (agregar columnas)\ndbl sandbox start\nALTER TABLE users ADD COLUMN email TEXT;\ndbl commit -m \"expand: Add email column\"\ndbl sandbox apply\n# Deploy app v1.1 (lee de ambas columnas)\n\n# Semana 2: Backfill\ndbl sandbox start\nUPDATE users SET email = username || '@example.com';\ndbl commit -m \"backfill: Populate email\"\ndbl sandbox apply\n\n# Semana 3: Contract (aplicar constraints)\ndbl sandbox start\nALTER TABLE users ALTER COLUMN email SET NOT NULL;\ndbl commit -m \"contract: Make email required\"\ndbl sandbox apply\n# Deploy app v1.2 (usa solo columna nueva)\n</code></pre>"},{"location":"es/commands/sandbox/apply/#manejo-de-errores","title":"Manejo de Errores","text":""},{"location":"es/commands/sandbox/apply/#cambios-conflictivos","title":"Cambios Conflictivos","text":"<p>Error: <pre><code>Error: Main database has conflicting changes\nThe following tables were modified outside of DBL:\n  - users (column added)\n</code></pre></p> <p>Soluci\u00f3n: 1. Revisar cambios en base principal 2. Decidir: fusionar o resetear 3. Si se fusionan, hacer commit manualmente 4. Si se resetean, usar <code>dbl reset</code></p>"},{"location":"es/commands/sandbox/apply/#conexion-perdida","title":"Conexi\u00f3n Perdida","text":"<p>Error: <pre><code>Error: Lost connection to main database\n</code></pre></p> <p>Soluci\u00f3n: - Sandbox permanece intacto - Arreglar conexi\u00f3n - Ejecutar <code>dbl sandbox apply</code> de nuevo - Cambios ya aplicados se omiten (idempotente)</p>"},{"location":"es/commands/sandbox/apply/#permisos-insuficientes","title":"Permisos Insuficientes","text":"<p>Error: <pre><code>Error: Permission denied\nUser 'dbl_user' cannot DROP TABLE\n</code></pre></p> <p>Soluci\u00f3n: <pre><code>-- Otorgar permisos\nALTER USER dbl_user WITH SUPERUSER;\n-- O grants espec\u00edficos\nGRANT ALL ON DATABASE myapp TO dbl_user;\n</code></pre></p>"},{"location":"es/commands/sandbox/apply/#consideraciones-de-rendimiento","title":"Consideraciones de Rendimiento","text":""},{"location":"es/commands/sandbox/apply/#bases-grandes","title":"Bases Grandes","text":"<p>Para bases &gt; 100GB:</p> <ul> <li>Tiempo: Apply puede tomar varios minutos</li> <li>Locks: Algunas operaciones bloquean tablas</li> <li>Monitoreo: Usar <code>pg_stat_activity</code> para progreso</li> </ul>"},{"location":"es/commands/sandbox/apply/#optimizar-apply","title":"Optimizar Apply","text":"<pre><code># Para migraciones de datos grandes\ndbl commit -m \"Add indexes\" --with-data\n\n# \u00cdndices creados DESPU\u00c9S de datos cargados (m\u00e1s r\u00e1pido)\n</code></pre>"},{"location":"es/commands/sandbox/apply/#integracion-cicd","title":"Integraci\u00f3n CI/CD","text":""},{"location":"es/commands/sandbox/apply/#despliegue-automatizado","title":"Despliegue Automatizado","text":"<pre><code># .github/workflows/deploy.yml\nname: Deploy Database Changes\n\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Apply sandbox\n        run: |\n          dbl sandbox start\n          # Run migrations\n          dbl reset\n          dbl sandbox apply\n\n      - name: Verify\n        run: ./verify-schema.sh\n</code></pre>"},{"location":"es/commands/sandbox/apply/#proximos-pasos","title":"Pr\u00f3ximos Pasos","text":"<p>Despu\u00e9s de aplicar:</p> <ul> <li>Verificar cambios: Revisar que base principal tenga esquema esperado</li> <li>Probar aplicaci\u00f3n: Asegurar que app funciona con nuevo esquema</li> <li>Monitorear logs: Buscar errores</li> <li>Actualizar documentaci\u00f3n: Documentar cambios de esquema</li> </ul>"},{"location":"es/commands/sandbox/apply/#ver-tambien","title":"Ver Tambi\u00e9n","text":"<ul> <li><code>dbl sandbox start</code> - Crear sandbox</li> <li><code>dbl sandbox rollback</code> - Descartar cambios</li> <li><code>dbl diff</code> - Revisar cambios</li> <li><code>dbl commit</code> - Guardar cambios</li> <li><code>dbl reset</code> - Reconstruir base de datos</li> </ul>"},{"location":"es/commands/sandbox/rollback/","title":"dbl sandbox rollback","text":"<p>Descartar todos los cambios del sandbox y eliminar el sandbox.</p>"},{"location":"es/commands/sandbox/rollback/#sinopsis","title":"Sinopsis","text":"<pre><code>dbl sandbox rollback\n</code></pre>"},{"location":"es/commands/sandbox/rollback/#descripcion","title":"Descripci\u00f3n","text":"<p>Elimina la base de datos sandbox y todos los cambios no guardados, dejando tu base de datos principal intacta. Es una forma segura de descartar cambios experimentales.</p>"},{"location":"es/commands/sandbox/rollback/#que-hace","title":"Qu\u00e9 Hace","text":"<ol> <li>Elimina sandbox - Remueve <code>{database}_sandbox</code></li> <li>Limpia metadata - Elimina archivos de rastreo</li> <li>Reinicia estado - Marca que no hay sandbox activo</li> </ol>"},{"location":"es/commands/sandbox/rollback/#ejemplo-de-uso","title":"Ejemplo de Uso","text":"<pre><code># Crear sandbox y hacer cambios\ndbl sandbox start\npsql -d myapp_sandbox -c \"CREATE TABLE test (id INT);\"\n\n# Decidir que no quieres estos cambios\ndbl sandbox rollback\n</code></pre> <p>Salida: <pre><code>Rolling back sandbox changes...\n\u2713 Dropped sandbox database (myapp_sandbox)\n\u2713 Cleared sandbox metadata\n\u2713 No active sandbox\n\nYour main database (myapp) remains unchanged.\n</code></pre></p>"},{"location":"es/commands/sandbox/rollback/#cuando-usar","title":"Cu\u00e1ndo Usar","text":""},{"location":"es/commands/sandbox/rollback/#usa-rollback-cuando","title":"\u2705 Usa Rollback Cuando:","text":"<ul> <li>Experimentas: Probaste algo que no funcion\u00f3</li> <li>Pruebas: Quer\u00edas ver el efecto de cambios</li> <li>Errores: Cometiste errores que quieres descartar</li> <li>Cambio de direcci\u00f3n: Decidiste un enfoque diferente</li> </ul>"},{"location":"es/commands/sandbox/rollback/#no-uses-cuando","title":"\u274c No Uses Cuando:","text":"<ul> <li>Quieres guardar cambios: Usa <code>dbl sandbox apply</code> en su lugar</li> <li>Parcialmente hecho: Guarda primero lo que funciona con commit</li> <li>Ya aplicado: No puedes rollback despu\u00e9s de <code>sandbox apply</code></li> </ul>"},{"location":"es/commands/sandbox/rollback/#ejemplos-completos","title":"Ejemplos Completos","text":""},{"location":"es/commands/sandbox/rollback/#experimento-fallido","title":"Experimento Fallido","text":"<pre><code># 1. Empezar a experimentar\n$ dbl sandbox start\n\u2713 Sandbox: myapp_sandbox\n\n# 2. Probar algo\n$ psql -d myapp_sandbox\nmyapp_sandbox=# DROP TABLE users CASCADE;\nDROP TABLE\nmyapp_sandbox=# -- \u00a1Oops, no quer\u00eda hacer eso!\n\n# 3. Rollback\n$ dbl sandbox rollback\n\u2713 Sandbox dropped\n\u2713 Base principal sin cambios\n\n# 4. Empezar fresco\n$ dbl sandbox start\n\u2713 New clean sandbox created\n</code></pre>"},{"location":"es/commands/sandbox/rollback/#multiples-rollbacks","title":"M\u00faltiples Rollbacks","text":"<pre><code># Probar enfoque 1\n$ dbl sandbox start\n# Hacer cambios...\n$ dbl diff\n# No me gusta\n$ dbl sandbox rollback\n\n# Probar enfoque 2\n$ dbl sandbox start\n# Hacer cambios diferentes...\n$ dbl diff\n# Tampoco me gusta\n$ dbl sandbox rollback\n\n# Probar enfoque 3\n$ dbl sandbox start\n# \u00a1Finalmente funcion\u00f3!\n$ dbl commit -m \"Final approach\"\n$ dbl sandbox apply\n</code></pre>"},{"location":"es/commands/sandbox/rollback/#guardar-algunos-descartar-otros","title":"Guardar Algunos, Descartar Otros","text":"<pre><code># Hacer varios cambios\n$ dbl sandbox start\n\n# Cambio 1: Bueno\n$ psql -d myapp_sandbox -c \"CREATE TABLE comments (...);\"\n$ dbl commit -m \"Add comments table\"\n\n# Cambio 2: Bueno\n$ psql -d myapp_sandbox -c \"CREATE INDEX idx_comments_post (...);\"\n$ dbl commit -m \"Add comments index\"\n\n# Cambio 3: Mala idea\n$ psql -d myapp_sandbox -c \"DROP TABLE users;\"\n# \u00a1No hacer commit de esto!\n\n# Rollback para descartar cambios no guardados\n$ dbl sandbox rollback\n\n# Los cambios anteriores est\u00e1n guardados en capas\n# Puedes aplicarlos despu\u00e9s en nuevo sandbox\n</code></pre>"},{"location":"es/commands/sandbox/rollback/#que-se-elimina","title":"Qu\u00e9 Se Elimina","text":""},{"location":"es/commands/sandbox/rollback/#eliminado","title":"Eliminado:","text":"<ul> <li>\u274c Sandbox database (<code>myapp_sandbox</code>)</li> <li>\u274c Cambios sin guardar</li> <li>\u274c Metadata del sandbox (<code>.dbl/sandbox.json</code>)</li> </ul>"},{"location":"es/commands/sandbox/rollback/#preservado","title":"Preservado:","text":"<ul> <li>\u2705 Base principal (sin cambios)</li> <li>\u2705 Capas guardadas (<code>.dbl/layers/</code>)</li> <li>\u2705 Historial de ramas</li> <li>\u2705 Todo trabajo anterior</li> </ul>"},{"location":"es/commands/sandbox/rollback/#comparacion-con-apply","title":"Comparaci\u00f3n con Apply","text":"Aspecto Rollback Apply Sandbox DB Eliminada Eliminada Cambios Descartados Aplicados a principal Base Principal Sin cambios Actualizada Usar cuando No quiero cambios Quiero cambios"},{"location":"es/commands/sandbox/rollback/#caracteristicas-de-seguridad","title":"Caracter\u00edsticas de Seguridad","text":""},{"location":"es/commands/sandbox/rollback/#confirmacion","title":"Confirmaci\u00f3n","text":"<p>Por defecto, DBL puede pedir confirmaci\u00f3n:</p> <pre><code>$ dbl sandbox rollback\nWarning: This will discard all sandbox changes.\nAre you sure? (y/n): y\n\u2713 Sandbox rolled back\n</code></pre>"},{"location":"es/commands/sandbox/rollback/#sin-deshacer","title":"Sin Deshacer","text":"<p>Eliminaci\u00f3n Permanente</p> <p>Despu\u00e9s de rollback, cambios del sandbox se pierden permanentemente. No hay deshacer.</p> <p>Guardar Primero</p> <p>Si tienes dudas, guarda cambios con commit antes de rollback. Siempre puedes crear nuevo sandbox sin aplicar esos commits.</p>"},{"location":"es/commands/sandbox/rollback/#patrones-de-workflow","title":"Patrones de Workflow","text":""},{"location":"es/commands/sandbox/rollback/#experimento-rapido","title":"Experimento R\u00e1pido","text":"<pre><code># Prueba r\u00e1pida\ndbl sandbox start\n# Probar algo...\ndbl sandbox rollback  # Descartar\n</code></pre>"},{"location":"es/commands/sandbox/rollback/#desarrollo-iterativo","title":"Desarrollo Iterativo","text":"<pre><code># Loop hasta estar satisfecho\nwhile true; do\n    dbl sandbox start\n    # Hacer cambios...\n    dbl diff\n    read -p \"\u00bfGuardar? (y/n): \" keep\n    if [ \"$keep\" = \"y\" ]; then\n        dbl commit -m \"Cambios\"\n        dbl sandbox apply\n        break\n    else\n        dbl sandbox rollback\n    fi\ndone\n</code></pre>"},{"location":"es/commands/sandbox/rollback/#exploracion-de-features","title":"Exploraci\u00f3n de Features","text":"<pre><code># Probar feature en sandbox\ndbl branch feature-xyz\ndbl checkout feature-xyz\ndbl sandbox start\n\n# Explorar implementaci\u00f3n\n# ... hacer cambios ...\n\n# No est\u00e1 listo\ndbl sandbox rollback\n\n# M\u00e1s tarde, intentar de nuevo\ndbl sandbox start\n# ... mejor implementaci\u00f3n ...\ndbl commit -m \"Feature XYZ\"\ndbl sandbox apply\n</code></pre>"},{"location":"es/commands/sandbox/rollback/#manejo-de-errores","title":"Manejo de Errores","text":""},{"location":"es/commands/sandbox/rollback/#sin-sandbox-activo","title":"Sin Sandbox Activo","text":"<p>Error: <pre><code>Error: No active sandbox found\n</code></pre></p> <p>Soluci\u00f3n: - No hay nada que rollback - Estado ya est\u00e1 limpio</p>"},{"location":"es/commands/sandbox/rollback/#sandbox-ya-eliminado","title":"Sandbox ya Eliminado","text":"<p>Error: <pre><code>Error: Sandbox database not found\n</code></pre></p> <p>Soluci\u00f3n: <pre><code># Limpiar metadata\nrm .dbl/sandbox.json\n</code></pre></p>"},{"location":"es/commands/sandbox/rollback/#problemas-de-permisos","title":"Problemas de Permisos","text":"<p>Error: <pre><code>Error: Permission denied to drop database\n</code></pre></p> <p>Soluci\u00f3n: <pre><code>-- Otorgar permiso de drop\nALTER USER myuser WITH CREATEDB;\n</code></pre></p>"},{"location":"es/commands/sandbox/rollback/#notas-importantes","title":"Notas Importantes","text":"<p>Cambios sin Guardar Perdidos</p> <p>Solo se pierden cambios sin guardar. Las capas guardadas est\u00e1n seguras.</p> <p>Base Principal Segura</p> <p>Tu base principal nunca se ve afectada por rollback.</p> <p>Sin Limpieza Manual</p> <p>DBL limpia autom\u00e1ticamente todos los artefactos del sandbox.</p>"},{"location":"es/commands/sandbox/rollback/#despues-de-rollback","title":"Despu\u00e9s de Rollback","text":""},{"location":"es/commands/sandbox/rollback/#verificar-estado","title":"Verificar Estado","text":"<pre><code>$ dbl sandbox status\nNo active sandbox\n</code></pre>"},{"location":"es/commands/sandbox/rollback/#empezar-de-nuevo","title":"Empezar de Nuevo","text":"<pre><code>$ dbl sandbox start\n\u2713 New sandbox created\n</code></pre>"},{"location":"es/commands/sandbox/rollback/#revisar-capas-guardadas","title":"Revisar Capas Guardadas","text":"<pre><code># Los cambios guardados est\u00e1n seguros\n$ dbl log\n* L005 - Add comments feature\n* L004 - Add indexes\n...\n</code></pre>"},{"location":"es/commands/sandbox/rollback/#integracion-cicd","title":"Integraci\u00f3n CI/CD","text":""},{"location":"es/commands/sandbox/rollback/#auto-rollback-en-fallo","title":"Auto-rollback en Fallo","text":"<pre><code># .github/workflows/test.yml\nname: Test Migrations\n\non: [pull_request]\n\njobs:\n  test:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Test migrations\n        run: |\n          dbl sandbox start\n          dbl reset || dbl sandbox rollback\n\n      - name: Cleanup on failure\n        if: failure()\n        run: dbl sandbox rollback\n</code></pre>"},{"location":"es/commands/sandbox/rollback/#script-de-limpieza","title":"Script de Limpieza","text":"<pre><code>#!/bin/bash\n# cleanup.sh\n\n# Siempre rollback al final\ntrap \"dbl sandbox rollback 2&gt;/dev/null\" EXIT\n\n# Ejecutar tests\ndbl sandbox start\n./run-migrations.sh\n./run-tests.sh\n</code></pre>"},{"location":"es/commands/sandbox/rollback/#comparacion-con-reset","title":"Comparaci\u00f3n con Reset","text":"Comando Prop\u00f3sito Alcance <code>rollback</code> Descartar sandbox Solo sandbox <code>reset</code> Reconstruir desde capas Base principal <pre><code># Rollback: descartar cambios del sandbox\ndbl sandbox rollback\n\n# Reset: reconstruir base principal desde capas\ndbl reset\n</code></pre>"},{"location":"es/commands/sandbox/rollback/#mejores-practicas","title":"Mejores Pr\u00e1cticas","text":"<ol> <li>Usa rollback libremente - No tengas miedo de descartar experimentos</li> <li>Guarda lo bueno - Commit antes de descartar el resto</li> <li>Usa ramas - A\u00edsla experimentos en ramas de feature</li> <li>Documenta por qu\u00e9 - Anota por qu\u00e9 hiciste rollback para el equipo</li> </ol>"},{"location":"es/commands/sandbox/rollback/#proximos-pasos","title":"Pr\u00f3ximos Pasos","text":"<p>Despu\u00e9s de rollback:</p> <ul> <li>Crear nuevo sandbox e intentar de nuevo</li> <li>Revisar capas guardadas</li> <li>Cambiar ramas para probar enfoque diferente</li> <li>Resetear base para probar replay de capas</li> </ul>"},{"location":"es/commands/sandbox/rollback/#ver-tambien","title":"Ver Tambi\u00e9n","text":"<ul> <li><code>dbl sandbox start</code> - Crear sandbox</li> <li><code>dbl sandbox apply</code> - Aplicar cambios</li> <li><code>dbl sandbox status</code> - Ver estado del sandbox</li> <li><code>dbl commit</code> - Guardar cambios antes de rollback</li> </ul>"},{"location":"es/commands/sandbox/start/","title":"dbl sandbox start","text":"<p>Crear un sandbox temporal para desarrollo seguro.</p>"},{"location":"es/commands/sandbox/start/#sinopsis","title":"Sinopsis","text":"<pre><code>dbl sandbox start\n</code></pre>"},{"location":"es/commands/sandbox/start/#descripcion","title":"Descripci\u00f3n","text":"<p>Crea una copia temporal de tu base de datos donde puedes experimentar libremente sin afectar la base principal. El sandbox es una base de datos completamente funcional con el mismo esquema que tu base principal.</p>"},{"location":"es/commands/sandbox/start/#que-hace","title":"Qu\u00e9 Hace","text":"<ol> <li>Copia esquema: Duplica estructura de la base principal</li> <li>Crea base sandbox: Genera <code>{database}_sandbox</code></li> <li>Rastrea estado: Marca sandbox como activo</li> <li>Preserva original: Base principal permanece intacta</li> </ol>"},{"location":"es/commands/sandbox/start/#ejemplo-de-uso","title":"Ejemplo de Uso","text":"<pre><code>dbl sandbox start\n</code></pre> <p>Salida: <pre><code>Creating sandbox for database 'myapp'...\n\u2713 Copied schema from myapp\n\u2713 Sandbox database created: myapp_sandbox\n\u2713 Sandbox is now active\n\nYou can now make changes safely in the sandbox.\nConnection: myapp_sandbox\n</code></pre></p>"},{"location":"es/commands/sandbox/start/#usar-el-sandbox","title":"Usar el Sandbox","text":""},{"location":"es/commands/sandbox/start/#conectar-al-sandbox","title":"Conectar al Sandbox","text":"<p>El sandbox es una base de datos real que puedes usar con cualquier herramienta:</p> PostgreSQLMySQL <pre><code># psql\npsql -d myapp_sandbox\n\n# Aplicaci\u00f3n\nDATABASE_URL=postgresql://user:pass@localhost/myapp_sandbox\n</code></pre> <pre><code># mysql\nmysql -u user -p myapp_sandbox\n\n# Aplicaci\u00f3n\nDATABASE_URL=mysql://user:pass@localhost/myapp_sandbox\n</code></pre>"},{"location":"es/commands/sandbox/start/#hacer-cambios","title":"Hacer Cambios","text":"<pre><code>-- Agregar nueva tabla\nCREATE TABLE notifications (\n    id SERIAL PRIMARY KEY,\n    user_id INTEGER REFERENCES users(id),\n    message TEXT NOT NULL,\n    read BOOLEAN DEFAULT false,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Agregar \u00edndice\nCREATE INDEX idx_notifications_user ON notifications(user_id);\n\n-- Modificar tabla existente\nALTER TABLE users ADD COLUMN last_login TIMESTAMP;\n</code></pre>"},{"location":"es/commands/sandbox/start/#ejemplo-completo","title":"Ejemplo Completo","text":""},{"location":"es/commands/sandbox/start/#agregar-sistema-de-notificaciones","title":"Agregar Sistema de Notificaciones","text":"<pre><code># 1. Crear sandbox\n$ dbl sandbox start\n\u2713 Sandbox: myapp_sandbox\n\n# 2. Conectar y hacer cambios\n$ psql -d myapp_sandbox &lt;&lt; EOF\n-- Tabla de notificaciones\nCREATE TABLE notifications (\n    id SERIAL PRIMARY KEY,\n    user_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,\n    type VARCHAR(50) NOT NULL,\n    title VARCHAR(200) NOT NULL,\n    message TEXT,\n    read BOOLEAN DEFAULT false,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- \u00cdndices para rendimiento\nCREATE INDEX idx_notifications_user ON notifications(user_id);\nCREATE INDEX idx_notifications_unread ON notifications(user_id, read) \nWHERE read = false;\n\n-- Tabla de preferencias de notificaci\u00f3n\nCREATE TABLE notification_preferences (\n    user_id INTEGER PRIMARY KEY REFERENCES users(id) ON DELETE CASCADE,\n    email_enabled BOOLEAN DEFAULT true,\n    push_enabled BOOLEAN DEFAULT true,\n    sms_enabled BOOLEAN DEFAULT false\n);\nEOF\n\n# 3. Verificar cambios\n$ dbl diff\n+ CREATE TABLE notifications (...)\n+ CREATE TABLE notification_preferences (...)\n+ CREATE INDEX idx_notifications_user ...\n\n# 4. Probar con tu aplicaci\u00f3n\n$ DATABASE=myapp_sandbox npm test\n\n# 5. Si funciona, guardar\n$ dbl commit -m \"Add notification system\"\n\u2713 Layer L008 created\n\n# 6. Aplicar a principal\n$ dbl sandbox apply\n\u2713 Applied to myapp\n</code></pre>"},{"location":"es/commands/sandbox/start/#caracteristicas-del-sandbox","title":"Caracter\u00edsticas del Sandbox","text":""},{"location":"es/commands/sandbox/start/#aislamiento-completo","title":"Aislamiento Completo","text":"<pre><code>Base Principal (myapp)     Sandbox (myapp_sandbox)\n\u251c\u2500\u2500 users                  \u251c\u2500\u2500 users (copia)\n\u251c\u2500\u2500 posts                  \u251c\u2500\u2500 posts (copia)\n\u2514\u2500\u2500 comments               \u251c\u2500\u2500 comments (copia)\n                          \u2514\u2500\u2500 notifications (\u00a1NUEVO!)\n\nCambios en sandbox \u2192 No afectan principal\n</code></pre>"},{"location":"es/commands/sandbox/start/#multiples-cambios","title":"M\u00faltiples Cambios","text":"<p>Puedes hacer m\u00faltiples commits en un sandbox:</p> <pre><code># Sandbox activo\ndbl sandbox start\n\n# Cambio 1\npsql -d myapp_sandbox -c \"CREATE TABLE tags (...);\"\ndbl commit -m \"Add tags table\"\n\n# Cambio 2\npsql -d myapp_sandbox -c \"CREATE TABLE post_tags (...);\"\ndbl commit -m \"Add post-tag relationship\"\n\n# Cambio 3\npsql -d myapp_sandbox -c \"CREATE INDEX idx_post_tags (...);\"\ndbl commit -m \"Add indexes for tags\"\n\n# Aplicar todos los cambios\ndbl sandbox apply\n</code></pre>"},{"location":"es/commands/sandbox/start/#casos-de-uso","title":"Casos de Uso","text":""},{"location":"es/commands/sandbox/start/#desarrollo-de-feature","title":"Desarrollo de Feature","text":"<pre><code># Nueva feature: sistema de comentarios\ndbl sandbox start\n\n# Implementar tablas\npsql -d myapp_sandbox &lt;&lt; EOF\nCREATE TABLE comments (...);\nCREATE TABLE comment_votes (...);\nEOF\n\n# Probar con aplicaci\u00f3n\nnpm test\n\n# Si funciona, guardar\ndbl commit -m \"Add comment system\"\ndbl sandbox apply\n</code></pre>"},{"location":"es/commands/sandbox/start/#experimentacion","title":"Experimentaci\u00f3n","text":"<pre><code># Probar un nuevo \u00edndice\ndbl sandbox start\npsql -d myapp_sandbox -c \"CREATE INDEX idx_new ON users(email);\"\n\n# Medir rendimiento\npsql -d myapp_sandbox -c \"EXPLAIN ANALYZE SELECT * FROM users WHERE email = 'test@example.com';\"\n\n# Si mejora, guardar\ndbl commit -m \"Add email index for performance\"\ndbl sandbox apply\n\n# Si no, descartar\ndbl sandbox rollback\n</code></pre>"},{"location":"es/commands/sandbox/start/#refactorizacion","title":"Refactorizaci\u00f3n","text":"<pre><code># Renombrar columnas\ndbl sandbox start\n\npsql -d myapp_sandbox &lt;&lt; EOF\nALTER TABLE users RENAME COLUMN name TO full_name;\nALTER TABLE posts RENAME COLUMN body TO content;\nEOF\n\n# Actualizar aplicaci\u00f3n para usar nuevos nombres\n# Probar...\n\n# Si todo funciona\ndbl commit -m \"Refactor: rename columns for clarity\"\ndbl sandbox apply\n</code></pre>"},{"location":"es/commands/sandbox/start/#estado-del-sandbox","title":"Estado del Sandbox","text":""},{"location":"es/commands/sandbox/start/#verificar-sandbox-activo","title":"Verificar Sandbox Activo","text":"<pre><code>dbl sandbox status\n</code></pre> <p>Salida: <pre><code>Active Sandbox: myapp_sandbox\nBase Database: myapp\nCreated: 2024-12-30 10:23:15\n\nUncommitted Changes:\n  + 2 tables added\n  + 3 indexes added\n\nStatus: Ready to commit\n</code></pre></p>"},{"location":"es/commands/sandbox/start/#informacion-del-sandbox","title":"Informaci\u00f3n del Sandbox","text":"<pre><code># Ver base de datos sandbox\npsql -l | grep sandbox\n\n# o en MySQL\nmysql -e \"SHOW DATABASES LIKE '%sandbox%';\"\n</code></pre>"},{"location":"es/commands/sandbox/start/#notas-importantes","title":"Notas Importantes","text":"<p>Un Sandbox a la Vez</p> <p>Solo puedes tener un sandbox activo por base de datos.</p> <p>Prueba Libremente</p> <p>El sandbox es desechable. Experimenta sin miedo.</p> <p>Datos No Copiados</p> <p>Solo se copia el esquema, no los datos. Esto hace que sea r\u00e1pido.</p>"},{"location":"es/commands/sandbox/start/#limitaciones","title":"Limitaciones","text":""},{"location":"es/commands/sandbox/start/#solo-esquema","title":"Solo Esquema","text":"<pre><code># Sandbox copia:\n\u2713 Tablas\n\u2713 Columnas\n\u2713 \u00cdndices\n\u2713 Constraints\n\u2713 Views\n\u2713 Funciones\n\u2713 Triggers\n\n# Sandbox NO copia:\n\u2717 Datos de filas\n\u2717 Secuencias (valores se resetean)\n\u2717 Permisos espec\u00edficos de usuarios\n</code></pre>"},{"location":"es/commands/sandbox/start/#solucion-seed-data","title":"Soluci\u00f3n: Seed Data","text":"<pre><code># Despu\u00e9s de crear sandbox\ndbl sandbox start\n\n# Cargar datos de prueba\npsql -d myapp_sandbox -f test/fixtures/seed_data.sql\n</code></pre>"},{"location":"es/commands/sandbox/start/#errores-comunes","title":"Errores Comunes","text":""},{"location":"es/commands/sandbox/start/#sandbox-already-exists","title":"\"Sandbox already exists\"","text":"<pre><code># Ya tienes un sandbox activo\n$ dbl sandbox start\nError: Sandbox 'myapp_sandbox' already exists\n\n# Soluciones:\n# 1. Aplicar sandbox existente\ndbl sandbox apply\n\n# 2. O descartarlo\ndbl sandbox rollback\n\n# 3. Luego crear nuevo\ndbl sandbox start\n</code></pre>"},{"location":"es/commands/sandbox/start/#database-connection-failed","title":"\"Database connection failed\"","text":"<pre><code># Verificar conexi\u00f3n\npsql -d myapp  # o mysql\n\n# Revisar dbl.yaml\ncat dbl.yaml\n</code></pre>"},{"location":"es/commands/sandbox/start/#permission-denied","title":"\"Permission denied\"","text":"<pre><code>-- PostgreSQL: Otorgar permisos\nALTER USER myuser WITH CREATEDB;\n\n-- MySQL: Otorgar permisos\nGRANT ALL PRIVILEGES ON *.* TO 'myuser'@'localhost';\n</code></pre>"},{"location":"es/commands/sandbox/start/#integracion-con-herramientas","title":"Integraci\u00f3n con Herramientas","text":""},{"location":"es/commands/sandbox/start/#con-orms","title":"Con ORMs","text":"<pre><code># Django settings.py\nDATABASES = {\n    'default': {\n        'ENGINE': 'django.db.backends.postgresql',\n        'NAME': os.getenv('DB_NAME', 'myapp_sandbox'),\n        # ...\n    }\n}\n</code></pre> <pre><code>// Node.js / Sequelize\nconst sequelize = new Sequelize(\n  process.env.DB_NAME || 'myapp_sandbox',\n  // ...\n);\n</code></pre>"},{"location":"es/commands/sandbox/start/#con-testing","title":"Con Testing","text":"<pre><code>#!/bin/bash\n# test-migrations.sh\n\n# Crear sandbox para tests\ndbl sandbox start\n\n# Ejecutar migraciones\ndbl reset\n\n# Correr tests\nnpm test\n\n# Limpiar\ndbl sandbox rollback\n</code></pre>"},{"location":"es/commands/sandbox/start/#en-cicd","title":"En CI/CD","text":"<pre><code># .github/workflows/test.yml\n- name: Test database changes\n  run: |\n    dbl sandbox start\n    dbl reset\n    npm test\n    dbl sandbox rollback\n</code></pre>"},{"location":"es/commands/sandbox/start/#siguientes-pasos","title":"Siguientes Pasos","text":"<p>Despu\u00e9s de crear un sandbox:</p> <ol> <li>Ver cambios - <code>dbl diff</code></li> <li>Guardar cambios - <code>dbl commit</code></li> <li>Aplicar a principal - <code>dbl sandbox apply</code></li> <li>Descartar cambios - <code>dbl sandbox rollback</code></li> </ol>"},{"location":"es/commands/sandbox/start/#ver-tambien","title":"Ver Tambi\u00e9n","text":"<ul> <li><code>dbl sandbox status</code> - Estado del sandbox</li> <li><code>dbl sandbox apply</code> - Aplicar cambios</li> <li><code>dbl sandbox rollback</code> - Descartar cambios</li> <li><code>dbl diff</code> - Ver diferencias</li> <li>Mejores Pr\u00e1cticas - Patrones de uso</li> </ul>"},{"location":"es/commands/sandbox/status/","title":"dbl sandbox status","text":"<p>Revisar el estado actual del sandbox.</p>"},{"location":"es/commands/sandbox/status/#sinopsis","title":"Sinopsis","text":"<pre><code>dbl sandbox status\n</code></pre>"},{"location":"es/commands/sandbox/status/#descripcion","title":"Descripci\u00f3n","text":"<p>Muestra informaci\u00f3n del sandbox activo, incluyendo cambios sin guardar, capas pendientes, y detalles de la base sandbox.</p>"},{"location":"es/commands/sandbox/status/#ejemplo-de-uso","title":"Ejemplo de Uso","text":"<pre><code>dbl sandbox status\n</code></pre> <p>Salida: <pre><code>Active Sandbox: myapp_sandbox\nBase Database: myapp\nCreated: 2024-12-30 10:23:15\nBranch: feature-auth\n\nUncommitted Changes:\n  + 1 table added (user_sessions)\n  + 2 columns added\n  ~ 1 table modified\n\nCommitted Layers (not yet applied):\n  L012 - Add user preferences (2024-12-30 10:45:22)\n  L013 - Add session tracking (2024-12-30 11:02:05)\n\nStatus: Ready to apply (2 layers pending)\n\nNext steps:\n  - Review changes: dbl diff\n  - Commit changes: dbl commit -m \"message\"\n  - Apply to main: dbl sandbox apply\n  - Discard sandbox: dbl sandbox rollback\n</code></pre></p>"},{"location":"es/commands/sandbox/status/#secciones-de-salida","title":"Secciones de Salida","text":""},{"location":"es/commands/sandbox/status/#informacion-del-sandbox","title":"Informaci\u00f3n del Sandbox","text":"<pre><code>Active Sandbox: myapp_sandbox\nBase Database: myapp\nCreated: 2024-12-30 10:23:15\nBranch: feature-auth\n</code></pre> <p>Muestra: - Nombre del sandbox: Nombre de la BD temporal - Base original: BD original - Creado: Cu\u00e1ndo se cre\u00f3 el sandbox - Rama: Rama actual de DBL</p>"},{"location":"es/commands/sandbox/status/#cambios-sin-guardar","title":"Cambios Sin Guardar","text":"<pre><code>Uncommitted Changes:\n  + 3 tables added\n  + 5 columns added\n  ~ 2 tables modified\n  - 1 table dropped\n</code></pre> <p>Resumen de diff antes de hacer commit.</p>"},{"location":"es/commands/sandbox/status/#capas-guardadas","title":"Capas Guardadas","text":"<pre><code>Committed Layers (not yet applied):\n  L015 - Add notifications (2024-12-30 14:32:11)\n  L016 - Add indexes (2024-12-30 14:35:28)\n</code></pre> <p>Capas creadas pero no aplicadas a base principal.</p>"},{"location":"es/commands/sandbox/status/#resumen-de-estado","title":"Resumen de Estado","text":"<pre><code>Status: Ready to apply (2 layers pending)\n</code></pre> <p>Estados posibles: - <code>Clean</code> - Sin cambios - <code>Uncommitted changes</code> - Cambios sin guardar - <code>Ready to apply</code> - Commits listos para base principal - <code>Empty sandbox</code> - Sin cambios hechos</p>"},{"location":"es/commands/sandbox/status/#cuando-no-hay-sandbox","title":"Cuando No Hay Sandbox","text":"<pre><code>$ dbl sandbox status\nNo active sandbox\n\nYour main database: myapp\nLast applied layer: L014\nCurrent branch: main\n\nTo start a sandbox: dbl sandbox start\n</code></pre>"},{"location":"es/commands/sandbox/status/#ejemplos-completos","title":"Ejemplos Completos","text":""},{"location":"es/commands/sandbox/status/#durante-desarrollo","title":"Durante Desarrollo","text":"<pre><code># Iniciar sandbox\n$ dbl sandbox start\n\u2713 Sandbox: myapp_sandbox\n\n# Revisar estado (vac\u00edo)\n$ dbl sandbox status\nActive Sandbox: myapp_sandbox\nStatus: Empty sandbox (no changes)\n\n# Hacer cambios\n$ psql -d myapp_sandbox -c \"CREATE TABLE comments (id SERIAL);\"\n\n# Revisar estado (sin guardar)\n$ dbl sandbox status\nActive Sandbox: myapp_sandbox\nUncommitted Changes:\n  + 1 table added (comments)\nStatus: Uncommitted changes\n\n# Guardar\n$ dbl commit -m \"Add comments\"\n\n# Revisar estado (listo)\n$ dbl sandbox status\nActive Sandbox: myapp_sandbox\nCommitted Layers (not yet applied):\n  L008 - Add comments (2024-12-30 15:12:33)\nStatus: Ready to apply (1 layer pending)\n\n# Aplicar\n$ dbl sandbox apply\n\n# Revisar estado (no hay sandbox)\n$ dbl sandbox status\nNo active sandbox\n</code></pre>"},{"location":"es/commands/sandbox/status/#multiples-commits","title":"M\u00faltiples Commits","text":"<pre><code>$ dbl sandbox status\n\nActive Sandbox: blog_sandbox\nBase Database: blog\n\nUncommitted Changes:\n  + 1 table added (comments)\n  ~ 1 table modified (posts)\n\nCommitted Layers (not yet applied):\n  L020 - Add user profiles (2024-12-30 09:15:33)\n  L021 - Add social login (2024-12-30 10:22:41)\n  L022 - Add rate limiting (2024-12-30 11:45:19)\n\nStatus: Ready to apply (3 layers pending)\nUncommitted: 2 changes\n\nNext steps:\n  1. Commit remaining changes: dbl commit -m \"Add comments\"\n  2. Apply all layers: dbl sandbox apply\n  3. Or rollback everything: dbl sandbox rollback\n</code></pre>"},{"location":"es/commands/sandbox/status/#casos-de-uso","title":"Casos de Uso","text":""},{"location":"es/commands/sandbox/status/#antes-de-commit","title":"Antes de Commit","text":"<pre><code># Revisar qu\u00e9 necesita guardarse\n$ dbl sandbox status\nUncommitted Changes:\n  + 3 tables added\n\n$ dbl diff  # Ver detalles\n$ dbl commit -m \"Add feature X\"\n</code></pre>"},{"location":"es/commands/sandbox/status/#antes-de-aplicar","title":"Antes de Aplicar","text":"<pre><code># Revisar qu\u00e9 se aplicar\u00e1\n$ dbl sandbox status\nCommitted Layers (not yet applied):\n  L015 - Add notifications\n  L016 - Add webhooks\n\n# Revisar cada capa\n$ cat .dbl/layers/L015_*.sql\n$ cat .dbl/layers/L016_*.sql\n\n# Aplicar\n$ dbl sandbox apply\n</code></pre>"},{"location":"es/commands/sandbox/status/#verificaciones-en-cicd","title":"Verificaciones en CI/CD","text":"<pre><code># Verificar que sandbox est\u00e1 limpio antes de fusionar\n$ dbl sandbox status\nif [ \"$?\" -ne 0 ]; then\n    echo \"Sandbox has uncommitted changes!\"\n    exit 1\nfi\n</code></pre>"},{"location":"es/commands/sandbox/status/#coordinacion-de-equipo","title":"Coordinaci\u00f3n de Equipo","text":"<pre><code># Compartir estado con equipo\n$ dbl sandbox status &gt; sandbox-status.txt\n$ cat sandbox-status.txt\n\nActive Sandbox: myapp_sandbox\nCommitted Layers (not yet applied):\n  L030 - Add payment system (hace 3 horas)\n  L031 - Add webhooks (hace 1 hora)\n\n# El equipo sabe qu\u00e9 se est\u00e1 desarrollando\n</code></pre>"},{"location":"es/commands/sandbox/status/#indicadores-de-estado","title":"Indicadores de Estado","text":""},{"location":"es/commands/sandbox/status/#estado-limpio","title":"Estado Limpio","text":"<p><pre><code>Status: Clean\n</code></pre> - Sin cambios sin guardar - Sin capas pendientes - Seguro cerrar sandbox o cambiar ramas</p>"},{"location":"es/commands/sandbox/status/#trabajo-sin-guardar","title":"Trabajo Sin Guardar","text":"<p><pre><code>Status: Uncommitted changes\n</code></pre> - Cambios no guardados - Deber\u00edas hacer commit o descartar antes de aplicar</p>"},{"location":"es/commands/sandbox/status/#listo-para-aplicar","title":"Listo para Aplicar","text":"<p><pre><code>Status: Ready to apply (N layers pending)\n</code></pre> - Tiene capas guardadas - Puede aplicar a base principal - Puede tener cambios sin guardar tambi\u00e9n</p>"},{"location":"es/commands/sandbox/status/#estado-mixto","title":"Estado Mixto","text":"<p><pre><code>Status: Ready to apply (2 layers pending)\nUncommitted: 1 table added\n</code></pre> - Tiene cambios guardados y sin guardar - Puede aplicar capas guardadas - Cambios sin guardar permanecen en sandbox</p>"},{"location":"es/commands/sandbox/status/#ejemplos-de-integracion","title":"Ejemplos de Integraci\u00f3n","text":""},{"location":"es/commands/sandbox/status/#git-hook","title":"Git Hook","text":"<pre><code>#!/bin/bash\n# .git/hooks/pre-push\n\n# Asegurar que sandbox est\u00e1 aplicado antes de push\nSTATUS=$(dbl sandbox status)\n\nif echo \"$STATUS\" | grep -q \"Active Sandbox\"; then\n    echo \"Error: Active sandbox detected\"\n    echo \"Apply or rollback sandbox before pushing\"\n    exit 1\nfi\n</code></pre>"},{"location":"es/commands/sandbox/status/#script-de-monitoreo","title":"Script de Monitoreo","text":"<pre><code>#!/bin/bash\n# monitor-sandbox.sh\n\nwhile true; do\n    clear\n    echo \"=== Sandbox Status ===\"\n    dbl sandbox status\n    echo \"\"\n    echo \"Press Ctrl+C to exit\"\n    sleep 5\ndone\n</code></pre>"},{"location":"es/commands/sandbox/status/#estado-api","title":"Estado API","text":"<pre><code># get_sandbox_status.py\nimport subprocess\nimport json\n\nresult = subprocess.run(['dbl', 'sandbox', 'status'], \n                       capture_output=True, text=True)\n\nif result.returncode == 0:\n    print(f\"Status: {result.stdout}\")\nelse:\n    print(\"No active sandbox\")\n</code></pre>"},{"location":"es/commands/sandbox/status/#notas-importantes","title":"Notas Importantes","text":"<p>Solo Lectura</p> <p>El comando status solo lee estado, nunca modifica nada.</p> <p>Verifica Frecuentemente</p> <p>Ejecuta <code>dbl sandbox status</code> frecuentemente durante desarrollo para rastrear progreso.</p> <p>Metadata vs Realidad</p> <p>Status muestra la vista de DBL. Si algo parece mal, verifica manualmente con herramientas DB.</p>"},{"location":"es/commands/sandbox/status/#ver-tambien","title":"Ver Tambi\u00e9n","text":"<ul> <li><code>dbl diff</code> - Ver cambios detallados</li> <li><code>dbl commit</code> - Guardar cambios</li> <li><code>dbl sandbox apply</code> - Aplicar sandbox</li> <li><code>dbl sandbox rollback</code> - Descartar sandbox</li> <li><code>dbl log</code> - Ver historial de capas</li> </ul>"},{"location":"es/commands/setup/init/","title":"dbl init","text":"<p>Inicializa un proyecto DBL en el directorio actual.</p>"},{"location":"es/commands/setup/init/#sinopsis","title":"Sinopsis","text":"<pre><code>dbl init\n</code></pre>"},{"location":"es/commands/setup/init/#descripcion","title":"Descripci\u00f3n","text":"<p>El comando <code>init</code> configura DBL en tu proyecto creando los archivos de configuraci\u00f3n necesarios y la estructura de directorios. Este es el primer comando que debes ejecutar al comenzar a usar DBL con una base de datos.</p>"},{"location":"es/commands/setup/init/#que-hace","title":"Qu\u00e9 Hace","text":"<ol> <li>Crea <code>dbl.yaml</code>: El archivo de configuraci\u00f3n principal que contiene los detalles de conexi\u00f3n a la base de datos y configuraciones</li> <li>Crea el directorio <code>.dbl/</code>: Espacio de trabajo interno de DBL para almacenar:</li> <li><code>layers/</code>: Migraciones SQL con control de versiones</li> <li><code>manifest.json</code>: Metadatos de ramas y capas</li> <li><code>state.json</code>: Seguimiento del estado actual de la base de datos</li> <li><code>snapshot.sql</code>: Volcado base de datos de referencia</li> <li>Inicializa la rama <code>master</code>: Crea la rama predeterminada en el manifest</li> </ol>"},{"location":"es/commands/setup/init/#ejemplo-de-uso","title":"Ejemplo de Uso","text":"<pre><code># Navega a tu proyecto\ncd mi-proyecto\n\n# Inicializa DBL\ndbl init\n\n# Salida:\n# \u2713 Archivo de configuraci\u00f3n dbl.yaml creado\n# \u2713 Estructura de directorio .dbl creada\n# \u2713 Rama master inicializada\n</code></pre>"},{"location":"es/commands/setup/init/#que-hacer-despues-de-init","title":"Qu\u00e9 Hacer Despu\u00e9s de Init","text":"<p>Despu\u00e9s de ejecutar <code>init</code>, necesitas:</p> <ol> <li> <p>Editar <code>dbl.yaml</code> con las credenciales de tu base de datos:    <pre><code>engine: postgres  # o mysql\nhost: localhost\nport: 5432\nuser: miusuario\npassword: micontrase\u00f1a\ndatabase: mibasededatos\n</code></pre></p> </li> <li> <p>Importar tu base de datos (opcional):    <pre><code>dbl import snapshot.sql\n</code></pre></p> </li> <li> <p>Comenzar a trabajar con sandboxes:    <pre><code>dbl sandbox start\n</code></pre></p> </li> </ol>"},{"location":"es/commands/setup/init/#archivo-de-configuracion-dblyaml","title":"Archivo de Configuraci\u00f3n (dbl.yaml)","text":"<p>El <code>dbl.yaml</code> generado contiene:</p> <pre><code>engine: postgres  # Motor de base de datos (postgres o mysql)\n\n# Detalles de conexi\u00f3n\nhost: localhost\nport: 5432\nuser: tu_usuario\npassword: tu_contrase\u00f1a\ndatabase: tu_basededatos\n\n# Opcional: Soporte para Docker\n# container_name: mi_contenedor_postgres\n\n# Opcional: Filtrado de tablas\nignore_tables: []   # Tablas a excluir del seguimiento\ntrack_tables: []    # Solo rastrear estas tablas (si se establece)\n\n# Opcional: Pol\u00edticas de seguridad\npolicies:\n  allow_data_loss: false  # Prevenir operaciones destructivas\n  require_sandbox: true   # Forzar uso de sandbox\n\n# Opcional: Reglas de validaci\u00f3n\nvalidate:\n  strict: false              # Tratar advertencias como errores\n  allow_orphaned: false      # Permitir backfill sin expand\n  require_comments: false    # Requerir comentarios para fase contract\n  detect_type_changes: true  # Advertir sobre cambios de tipo de columna\n</code></pre>"},{"location":"es/commands/setup/init/#estructura-de-directorios","title":"Estructura de Directorios","text":"<p>Despu\u00e9s de la inicializaci\u00f3n:</p> <pre><code>mi-proyecto/\n\u251c\u2500\u2500 dbl.yaml              # Archivo de configuraci\u00f3n\n\u251c\u2500\u2500 .dbl/                 # Espacio de trabajo DBL (a\u00f1adir a .gitignore)\n\u2502   \u251c\u2500\u2500 layers/           # Capas de migraci\u00f3n\n\u2502   \u2502   \u2514\u2500\u2500 manifest.json # Metadatos de ramas y capas\n\u2502   \u251c\u2500\u2500 snapshot.sql      # L\u00ednea base de la base de datos\n\u2502   \u251c\u2500\u2500 state.json        # Estado actual\n\u2502   \u2514\u2500\u2500 sandbox.json      # Metadatos del sandbox (cuando est\u00e1 activo)\n\u2514\u2500\u2500 .gitignore            # (recomendado) A\u00f1adir .dbl/ aqu\u00ed\n</code></pre>"},{"location":"es/commands/setup/init/#notas-importantes","title":"Notas Importantes","text":"<p>Seguridad</p> <p>El archivo <code>dbl.yaml</code> contiene credenciales de base de datos. Nunca lo subas al control de versiones si contiene informaci\u00f3n sensible.</p> <p>Control de Versiones</p> <p>A\u00f1ade <code>.dbl/</code> a tu <code>.gitignore</code>: <pre><code>echo \".dbl/\" &gt;&gt; .gitignore\n</code></pre></p> <p>Solo rastrea las capas de migraci\u00f3n por separado si es necesario para la colaboraci\u00f3n en equipo.</p> <p>Soporte Docker</p> <p>Si usas Docker, descomenta y establece <code>container_name</code> en <code>dbl.yaml</code> para ejecutar comandos dentro del contenedor.</p>"},{"location":"es/commands/setup/init/#problemas-comunes","title":"Problemas Comunes","text":""},{"location":"es/commands/setup/init/#ya-inicializado","title":"Ya Inicializado","text":"<p>Si DBL ya est\u00e1 inicializado: <pre><code>Error: dbl.yaml ya existe\n</code></pre></p> <p>Soluci\u00f3n: Elimina el <code>dbl.yaml</code> existente y el directorio <code>.dbl/</code> si deseas reinicializar: <pre><code>rm dbl.yaml\nrm -rf .dbl/\ndbl init\n</code></pre></p>"},{"location":"es/commands/setup/init/#permiso-denegado","title":"Permiso Denegado","text":"<p>Si obtienes errores de permisos: <pre><code>Error: Permiso denegado al crear .dbl/\n</code></pre></p> <p>Soluci\u00f3n: Aseg\u00farate de tener permisos de escritura en el directorio actual o ejecuta con los permisos apropiados.</p>"},{"location":"es/commands/setup/init/#proximos-pasos","title":"Pr\u00f3ximos Pasos","text":"<p>Despu\u00e9s de la inicializaci\u00f3n:</p> <ol> <li>Configura tu conexi\u00f3n de base de datos</li> <li>Crea tu primer sandbox</li> <li>Haz tu primera migraci\u00f3n</li> </ol>"},{"location":"es/commands/setup/init/#ver-tambien","title":"Ver Tambi\u00e9n","text":"<ul> <li>Gu\u00eda de Configuraci\u00f3n</li> <li>Tutorial de Inicio R\u00e1pido</li> </ul>"},{"location":"es/commands/setup/update/","title":"dbl update","text":"<p>Actualizar DBL a la \u00faltima versi\u00f3n.</p>"},{"location":"es/commands/setup/update/#sinopsis","title":"Sinopsis","text":"<pre><code>dbl update\ndbl update --version VERSION\ndbl update --force\ndbl update --check\n</code></pre>"},{"location":"es/commands/setup/update/#descripcion","title":"Descripci\u00f3n","text":"<p>Descarga e instala la \u00faltima versi\u00f3n de DBL. Verifica GitHub para nuevas versiones y actualiza autom\u00e1ticamente si est\u00e1 disponible.</p>"},{"location":"es/commands/setup/update/#ejemplo-de-uso","title":"Ejemplo de Uso","text":"<pre><code>dbl update\n</code></pre> <p>Salida: <pre><code>Checking for updates...\nCurrent version: 2.1.0\nLatest version: 2.2.0\nNew version available!\n\nDownloading DBL 2.2.0...\n\u2713 Downloaded successfully\nInstalling...\n\u2713 Installation complete\n\nUpdated successfully!\nDBL version 2.2.0\n\nRun 'dbl help' for available commands.\n</code></pre></p>"},{"location":"es/commands/setup/update/#opciones","title":"Opciones","text":""},{"location":"es/commands/setup/update/#-check","title":"<code>--check</code>","text":"<p>Solo verificar actualizaciones sin instalar:</p> <pre><code>$ dbl update --check\n\nCurrent version: 2.1.0\nLatest version: 2.2.0\n\u2713 New version available\n</code></pre>"},{"location":"es/commands/setup/update/#-version-version","title":"<code>--version VERSION</code>","text":"<p>Actualizar a versi\u00f3n espec\u00edfica:</p> <pre><code>$ dbl update --version 2.2.0\n# Instala versi\u00f3n 2.2.0 espec\u00edficamente\n</code></pre>"},{"location":"es/commands/setup/update/#-force","title":"<code>--force</code>","text":"<p>Forzar actualizaci\u00f3n incluso si versi\u00f3n es igual:</p> <pre><code>$ dbl update --force\n# Reinstala versi\u00f3n actual\n</code></pre>"},{"location":"es/commands/setup/update/#ejemplos-completos","title":"Ejemplos Completos","text":""},{"location":"es/commands/setup/update/#actualizacion-automatica","title":"Actualizaci\u00f3n Autom\u00e1tica","text":"<pre><code>$ dbl update\n\nChecking for updates...\n\u2713 New version: 2.2.0\nDownloading...\n\u2713 Installed successfully\n\u2713 DBL 2.2.0 ready\n</code></pre>"},{"location":"es/commands/setup/update/#verificar-y-actualizar-interactivo","title":"Verificar y Actualizar Interactivo","text":"<pre><code>$ dbl update --check\n\nCurrent version: 2.1.0\nLatest version: 2.2.0\n\nUpdate now? [y/n]: y\n\nDownloading...\n\u2713 Installation complete\n</code></pre>"},{"location":"es/commands/setup/update/#actualizar-a-version-especifica","title":"Actualizar a Versi\u00f3n Espec\u00edfica","text":"<pre><code>$ dbl update --version 2.1.5\n\nDownloading DBL 2.1.5...\n\u2713 Downloaded\nInstalling...\n\u2713 Installed: DBL 2.1.5\n</code></pre>"},{"location":"es/commands/setup/update/#volver-a-version-anterior","title":"Volver a Versi\u00f3n Anterior","text":"<pre><code># Actualizar a versi\u00f3n espec\u00edfica anterior\n$ dbl update --version 2.0.0\n\nDownloading DBL 2.0.0...\n\u2713 Installation complete\n</code></pre>"},{"location":"es/commands/setup/update/#proceso-de-actualizacion","title":"Proceso de Actualizaci\u00f3n","text":""},{"location":"es/commands/setup/update/#paso-a-paso","title":"Paso a Paso","text":"<pre><code>1. Verificar conexi\u00f3n internet\n2. Consultar GitHub API para \u00faltima versi\u00f3n\n3. Comparar versiones\n4. Si hay actualizaci\u00f3n disponible:\n   a. Descargar archivo\n   b. Instalar con pip\n   c. Verificar instalaci\u00f3n\n   d. Mostrar cambios\n</code></pre>"},{"location":"es/commands/setup/update/#verificacion-post-actualizacion","title":"Verificaci\u00f3n Post-Actualizaci\u00f3n","text":"<pre><code>$ dbl update\n... actualizaci\u00f3n completa ...\n\n$ dbl version\nDBL version 2.2.0 \u2713\n\n$ dbl help\n... muestra ayuda ...\n</code></pre>"},{"location":"es/commands/setup/update/#usar-en-scripts","title":"Usar en Scripts","text":""},{"location":"es/commands/setup/update/#script-de-actualizacion-automatica","title":"Script de Actualizaci\u00f3n Autom\u00e1tica","text":"<pre><code>#!/bin/bash\n# auto-update.sh\n\n# Actualizar DBL si hay versi\u00f3n nueva\ndbl update --check | grep -q \"available\" &amp;&amp; {\n    echo \"Updating DBL...\"\n    dbl update\n    echo \"\u2713 Updated\"\n} || {\n    echo \"Already up to date\"\n}\n</code></pre>"},{"location":"es/commands/setup/update/#github-actions","title":"GitHub Actions","text":"<pre><code>name: Keep DBL Updated\n\non:\n  schedule:\n    - cron: '0 0 * * *'  # Daily\n\njobs:\n  update:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Check for updates\n        run: dbl update --check\n\n      - name: Update if available\n        run: dbl update\n</code></pre>"},{"location":"es/commands/setup/update/#cicd-integration","title":"CI/CD Integration","text":"<pre><code># .github/workflows/test.yml\nname: Test with Latest DBL\n\njobs:\n  test:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Update DBL\n        run: dbl update --force\n\n      - name: Run tests\n        run: pytest tests/\n</code></pre>"},{"location":"es/commands/setup/update/#cambios-en-nuevas-versiones","title":"Cambios en Nuevas Versiones","text":""},{"location":"es/commands/setup/update/#v220-latest","title":"v2.2.0 (Latest)","text":"<pre><code>$ dbl update\n\nUpdated features:\n  \u2713 Improved performance\n  \u2713 New sandbox features\n  \u2713 Better error messages\n  \u2713 PostgreSQL 15 support\n\nBreaking changes:\n  - Cambiar configuraci\u00f3n de X a Y\n  - Ver docs/upgrade-2.2.md\n</code></pre>"},{"location":"es/commands/setup/update/#v210","title":"v2.1.0","text":"<pre><code>\u2713 MySQL 8.0 support\n\u2713 Auto-dependency installation\n\u2713 New validation engine\n</code></pre>"},{"location":"es/commands/setup/update/#v200","title":"v2.0.0","text":"<pre><code>\u2713 Major rewrite\n\u2713 Ramas de feature (branching)\n\u2713 Mejor rendimiento\n</code></pre>"},{"location":"es/commands/setup/update/#politica-de-actualizacion","title":"Pol\u00edtica de Actualizaci\u00f3n","text":""},{"location":"es/commands/setup/update/#versioning","title":"Versioning","text":"<p>DBL usa Semantic Versioning:</p> <pre><code>2.1.3\n\u2502 \u2502 \u2514\u2500\u2500 Patch (bug fixes)\n\u2502 \u2514\u2500\u2500\u2500\u2500 Minor (new features)\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500 Major (breaking changes)\n</code></pre>"},{"location":"es/commands/setup/update/#recomendaciones","title":"Recomendaciones","text":"<pre><code># Patch updates: Siempre instalar\ndbl update  # 2.1.2 \u2192 2.1.3\n\n# Minor updates: Generalmente seguro\ndbl update  # 2.1.0 \u2192 2.2.0\n\n# Major updates: Revisar cambios primero\ndbl update --check  # Leer notas de actualizaci\u00f3n\n# Luego decidir actualizar\n</code></pre>"},{"location":"es/commands/setup/update/#troubleshooting","title":"Troubleshooting","text":""},{"location":"es/commands/setup/update/#fallo-la-descarga","title":"Fall\u00f3 la Descarga","text":"<p>Error: <pre><code>Error: Failed to download\nNetwork connection error\n</code></pre></p> <p>Soluci\u00f3n: <pre><code># Reintentar\ndbl update\n\n# O instalar manualmente\npip install --upgrade dbl\n</code></pre></p>"},{"location":"es/commands/setup/update/#permisos-insuficientes","title":"Permisos Insuficientes","text":"<p>Error: <pre><code>Error: Permission denied\nCannot install to /usr/local/lib\n</code></pre></p> <p>Soluci\u00f3n: <pre><code># Actualizar con permisos\nsudo dbl update\n\n# O usar virtualenv\nsource venv/bin/activate\ndbl update\n</code></pre></p>"},{"location":"es/commands/setup/update/#version-corrupta","title":"Versi\u00f3n Corrupta","text":"<p>Error: <pre><code>Error: Installation failed\nDBL check failed\n</code></pre></p> <p>Soluci\u00f3n: <pre><code># Desinstalar y reinstalar\npip uninstall dbl\npip install dbl\n\n# Verificar\ndbl version\n</code></pre></p>"},{"location":"es/commands/setup/update/#ya-actualizada","title":"Ya Actualizada","text":"<p>Output: <pre><code>Current version: 2.2.0\nLatest version: 2.2.0\n\u2713 Already up to date\n</code></pre></p> <p>No hay nada que hacer.</p>"},{"location":"es/commands/setup/update/#dependencias-automaticas","title":"Dependencias Autom\u00e1ticas","text":"<p>DBL autom\u00e1ticamente verifica e instala dependencias:</p> <pre><code>$ dbl update\n\nChecking dependencies...\n  PyYAML 6.0 \u2713\n  pydantic 1.10 \u2713\n  psycopg2 2.9 \u2713\n  mysql-connector-python 8.0 \u2713\n\n\u2713 All dependencies satisfied\n</code></pre> <p>Si falta algo:</p> <pre><code>\u2717 psycopg2 not found\nInstalling missing dependencies...\n\u2713 psycopg2 installed\n</code></pre>"},{"location":"es/commands/setup/update/#actualizacion-en-produccion","title":"Actualizaci\u00f3n en Producci\u00f3n","text":""},{"location":"es/commands/setup/update/#despliegue-seguro","title":"Despliegue Seguro","text":"<pre><code>#!/bin/bash\n# deploy-dbl-update.sh\n\n# 1. Verificar que versi\u00f3n est\u00e1 disponible\ndbl update --check\n\n# 2. Probar en staging\ndbl update --version 2.2.0\n\n# 3. Ejecutar tests\ndbl reset\npytest tests/\n\n# 4. Si todo OK, actualizar producci\u00f3n\nssh production 'dbl update --version 2.2.0'\n\n# 5. Verificar\nssh production 'dbl version'\n</code></pre>"},{"location":"es/commands/setup/update/#rollback","title":"Rollback","text":"<pre><code># Si algo sale mal, volver a versi\u00f3n anterior\ndbl update --version 2.1.0\n\n# Verificar\ndbl version\n</code></pre>"},{"location":"es/commands/setup/update/#monitoreo-de-actualizaciones","title":"Monitoreo de Actualizaciones","text":""},{"location":"es/commands/setup/update/#verificacion-regular","title":"Verificaci\u00f3n Regular","text":"<pre><code># Cron job para verificar diariamente\n0 9 * * * dbl update --check &gt;&gt; /tmp/dbl-updates.log\n</code></pre>"},{"location":"es/commands/setup/update/#notificaciones","title":"Notificaciones","text":"<pre><code>#!/bin/bash\n# notify-updates.sh\n\nif dbl update --check | grep -q \"available\"; then\n    echo \"DBL update available\" | mail -s \"DBL Update\" admin@company.com\nfi\n</code></pre>"},{"location":"es/commands/setup/update/#ver-tambien","title":"Ver Tambi\u00e9n","text":"<ul> <li><code>dbl version</code> - Ver versi\u00f3n actual</li> <li><code>dbl init</code> - Inicializar proyecto</li> <li><code>dbl help</code> - Ver ayuda</li> </ul>"},{"location":"es/commands/setup/validate/","title":"dbl validate","text":"<p>Verificar que el esquema de la base de datos es v\u00e1lido y consistente con las capas.</p>"},{"location":"es/commands/setup/validate/#sinopsis","title":"Sinopsis","text":"<pre><code>dbl validate\ndbl validate --check-layers\ndbl validate --check-schema\ndbl validate --fix\n</code></pre>"},{"location":"es/commands/setup/validate/#descripcion","title":"Descripci\u00f3n","text":"<p>Valida la integridad de tu base de datos y las capas de DBL. Verifica que:</p> <ul> <li>Todas las capas se pueden ejecutar correctamente</li> <li>Esquema est\u00e1 sincronizado con capas</li> <li>No hay inconsistencias</li> <li>Integridad referencial es correcta</li> </ul>"},{"location":"es/commands/setup/validate/#ejemplo-de-uso","title":"Ejemplo de Uso","text":"<pre><code>dbl validate\n</code></pre> <p>Salida: <pre><code>Validating database...\n\nLayers:\n  \u2713 All 15 layers are valid\n  \u2713 Layers can be replayed\n\nSchema:\n  \u2713 42 tables found\n  \u2713 28 indexes found\n  \u2713 12 constraints valid\n  \u2713 No orphaned objects\n\nConsistency:\n  \u2713 Schema matches layers\n  \u2713 Referential integrity OK\n  \u2713 All columns properly typed\n\n\u2713 Database validation complete (2.3s)\n</code></pre></p>"},{"location":"es/commands/setup/validate/#opciones","title":"Opciones","text":""},{"location":"es/commands/setup/validate/#-check-layers","title":"<code>--check-layers</code>","text":"<p>Solo validar capas:</p> <pre><code>$ dbl validate --check-layers\n\nChecking layers...\n  \u2713 L001_initial_schema.sql - OK\n  \u2713 L002_add_users.sql - OK\n  \u2713 L003_add_posts.sql - OK\n  ...\n\u2713 All layers valid\n</code></pre>"},{"location":"es/commands/setup/validate/#-check-schema","title":"<code>--check-schema</code>","text":"<p>Solo validar esquema:</p> <pre><code>$ dbl validate --check-schema\n\nChecking schema...\n  \u2713 All tables reachable\n  \u2713 All indexes valid\n  \u2713 No broken constraints\n  \u2713 Referential integrity OK\n</code></pre>"},{"location":"es/commands/setup/validate/#-fix","title":"<code>--fix</code>","text":"<p>Intentar arreglar problemas encontrados:</p> <pre><code>$ dbl validate --fix\n\nFound 3 issues:\n  \u26a0 Missing index on users.email\n  \u26a0 Unused table: old_data\n  \u26a0 Invalid constraint: fk_users_posts\n\nAttempting fixes...\n  \u2713 Created index idx_users_email\n  \u26a0 Old_data not removed (manual review needed)\n  \u2713 Recreated constraint\n</code></pre>"},{"location":"es/commands/setup/validate/#ejemplos-completos","title":"Ejemplos Completos","text":""},{"location":"es/commands/setup/validate/#validacion-basica","title":"Validaci\u00f3n B\u00e1sica","text":"<pre><code>$ dbl validate\n\n\u2713 Database valid\n  Layers: 12\n  Tables: 35\n  Indexes: 18\n</code></pre>"},{"location":"es/commands/setup/validate/#validacion-detallada","title":"Validaci\u00f3n Detallada","text":"<pre><code>$ dbl validate --verbose\n\nValidating layers...\n  L001_initial_schema.sql\n    - 5 tables\n    - 2 indexes\n    \u2713 OK\n\n  L002_add_users.sql\n    - 1 table (users)\n    - 2 indexes\n    - 3 constraints\n    \u2713 OK\n\n  ... (12 capas m\u00e1s) ...\n\nSchema validation...\n  Tables:\n    \u2713 users (35 rows)\n    \u2713 posts (142 rows)\n    \u2713 comments (892 rows)\n    ...\n\n  Constraints:\n    \u2713 fk_posts_users\n    \u2713 fk_comments_posts\n    \u2713 fk_comments_users\n    ...\n\n\u2713 All valid\n</code></pre>"},{"location":"es/commands/setup/validate/#validaciones-realizadas","title":"Validaciones Realizadas","text":""},{"location":"es/commands/setup/validate/#validacion-de-capas","title":"Validaci\u00f3n de Capas","text":"<pre><code>\u2713 Todas las capas existen\n\u2713 Sintaxis SQL es correcta\n\u2713 Capas se pueden ejecutar\n\u2713 No hay duplicados\n\u2713 Nombrado correctamente\n</code></pre>"},{"location":"es/commands/setup/validate/#validacion-de-esquema","title":"Validaci\u00f3n de Esquema","text":"<pre><code>\u2713 Todas las tablas accesibles\n\u2713 Todas las columnas tipadas\n\u2713 \u00cdndices son v\u00e1lidos\n\u2713 Constraints son v\u00e1lidos\n\u2713 Integridad referencial OK\n</code></pre>"},{"location":"es/commands/setup/validate/#validacion-de-consistencia","title":"Validaci\u00f3n de Consistencia","text":"<pre><code>\u2713 Esquema coincide con capas\n\u2713 No hay objetos hu\u00e9rfanos\n\u2713 No hay conflictos de nombres\n\u2713 Permisos correctos\n</code></pre>"},{"location":"es/commands/setup/validate/#casos-de-uso","title":"Casos de Uso","text":""},{"location":"es/commands/setup/validate/#despues-de-migrations","title":"Despu\u00e9s de Migrations","text":"<pre><code># Ejecutar migraciones\ndbl reset\n\n# Validar que todo est\u00e1 bien\n$ dbl validate\n\u2713 Database valid\n</code></pre>"},{"location":"es/commands/setup/validate/#antes-de-deploy","title":"Antes de Deploy","text":"<pre><code>#!/bin/bash\n# pre-deploy-check.sh\n\n# Validar antes de desplegar\nif dbl validate --check-layers; then\n    echo \"\u2713 Layers valid, safe to deploy\"\n    dbl sandbox apply\nelse\n    echo \"\u2717 Layers have issues\"\n    exit 1\nfi\n</code></pre>"},{"location":"es/commands/setup/validate/#debugging-de-problemas","title":"Debugging de Problemas","text":"<pre><code># Algo est\u00e1 mal?\n$ dbl validate\n\n\u2717 Database validation failed\n\nIssues found:\n  \u26a0 Layer L008 uses undefined column\n  \u26a0 Table users has no primary key\n  \u26a0 Missing index on posts.user_id\n\n# Arreglar\n$ dbl validate --fix\n</code></pre>"},{"location":"es/commands/setup/validate/#cicd-validation","title":"CI/CD Validation","text":"<pre><code># .github/workflows/validate.yml\nname: Validate Database\n\non: [push]\n\njobs:\n  validate:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Run validation\n        run: dbl validate --check-layers\n\n      - name: Check schema consistency\n        run: dbl validate --check-schema\n</code></pre>"},{"location":"es/commands/setup/validate/#problemas-comunes","title":"Problemas Comunes","text":""},{"location":"es/commands/setup/validate/#capas-con-errores","title":"Capas Con Errores","text":"<p>Error: <pre><code>\u2717 Layer L015 has syntax error\n  Line 12: Unexpected token\n  ... CREATE TABLE users (\n       ^\n</code></pre></p> <p>Soluci\u00f3n: <pre><code># Revisar y arreglar SQL\n$ vim .dbl/layers/L015_*.sql\n\n# Revalidar\n$ dbl validate\n</code></pre></p>"},{"location":"es/commands/setup/validate/#esquema-desincronizado","title":"Esquema Desincronizado","text":"<p>Error: <pre><code>\u2717 Schema doesn't match layers\n  Expected table 'comments' from L008\n  Not found in actual schema\n</code></pre></p> <p>Soluci\u00f3n: <pre><code># Reconstruir desde capas\n$ dbl reset\n\n# Revalidar\n$ dbl validate\n</code></pre></p>"},{"location":"es/commands/setup/validate/#integridad-referencial-rota","title":"Integridad Referencial Rota","text":"<p>Error: <pre><code>\u2717 Referential integrity violation\n  posts.user_id references non-existent user\n  Orphaned rows: 42\n</code></pre></p> <p>Soluci\u00f3n: <pre><code># Encontrar y limpiar datos hu\u00e9rfanos\n$ psql myapp -c \"\n  DELETE FROM posts \n  WHERE user_id NOT IN (SELECT id FROM users);\n\"\n\n# Revalidar\n$ dbl validate\n</code></pre></p>"},{"location":"es/commands/setup/validate/#indices-faltantes","title":"\u00cdndices Faltantes","text":"<p>Error: <pre><code>\u26a0 Missing index on users.email\n  Suggested: CREATE INDEX idx_users_email ON users(email)\n</code></pre></p> <p>Soluci\u00f3n: <pre><code># Crear en sandbox\n$ dbl sandbox start\n$ psql -d myapp_sandbox -c \"CREATE INDEX idx_users_email ON users(email);\"\n$ dbl commit -m \"Add index on users.email\"\n$ dbl sandbox apply\n\n# Revalidar\n$ dbl validate\n</code></pre></p>"},{"location":"es/commands/setup/validate/#reparacion-automatica","title":"Reparaci\u00f3n Autom\u00e1tica","text":""},{"location":"es/commands/setup/validate/#con-fix","title":"Con --fix","text":"<pre><code>$ dbl validate --fix\n\nAttempting to fix issues:\n  [1/3] Creating missing index idx_users_email\n    \u2713 Created\n\n  [2/3] Removing orphaned table old_users\n    \u2713 Removed\n\n  [3/3] Rebuilding constraint fk_posts_users\n    \u2713 Rebuilt\n\n\u2713 Fixed 3 issues\n</code></pre>"},{"location":"es/commands/setup/validate/#reparacion-manual","title":"Reparaci\u00f3n Manual","text":"<pre><code># 1. Identificar problema\n$ dbl validate\n\u2717 Issue: ...\n\n# 2. Investigar\n$ dbl diff\n$ cat .dbl/layers/L015_*.sql\n\n# 3. Arreglar\n$ dbl sandbox start\n$ # ... hacer cambios ...\n$ dbl commit -m \"Fix validation issue\"\n$ dbl sandbox apply\n\n# 4. Revalidar\n$ dbl validate\n\u2713 All valid\n</code></pre>"},{"location":"es/commands/setup/validate/#integracion-en-desarrollo","title":"Integraci\u00f3n en Desarrollo","text":""},{"location":"es/commands/setup/validate/#pre-commit-hook","title":"Pre-commit Hook","text":"<pre><code>#!/bin/bash\n# .git/hooks/pre-commit\n\n# Validar antes de commit\nif ! dbl validate --check-layers; then\n    echo \"Database validation failed\"\n    echo \"Fix issues before committing\"\n    exit 1\nfi\n</code></pre>"},{"location":"es/commands/setup/validate/#script-de-deployment","title":"Script de Deployment","text":"<pre><code>#!/bin/bash\n# deploy.sh\n\necho \"Validating database schema...\"\nif dbl validate; then\n    echo \"\u2713 Validation passed\"\n    dbl sandbox apply\nelse\n    echo \"\u2717 Validation failed\"\n    exit 1\nfi\n</code></pre>"},{"location":"es/commands/setup/validate/#reportes-de-validacion","title":"Reportes de Validaci\u00f3n","text":""},{"location":"es/commands/setup/validate/#generar-reporte","title":"Generar Reporte","text":"<pre><code>$ dbl validate --verbose &gt; validation-report.txt\n$ cat validation-report.txt\n\n\u2713 Layer validation: PASSED\n\u2713 Schema validation: PASSED\n\u2713 Consistency check: PASSED\n\u2713 Integrity check: PASSED\n</code></pre>"},{"location":"es/commands/setup/validate/#programa-monitor","title":"Programa Monitor","text":"<pre><code>#!/bin/bash\n# monitor-validation.sh\n\nTIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')\nSTATUS=$(dbl validate &amp;&amp; echo \"PASS\" || echo \"FAIL\")\n\necho \"[$TIMESTAMP] Validation: $STATUS\" &gt;&gt; validation.log\n</code></pre>"},{"location":"es/commands/setup/validate/#mejores-practicas","title":"Mejores Pr\u00e1cticas","text":"<ol> <li>Validar regularmente: Ejecutar despu\u00e9s de cambios importantes</li> <li>Pre-deployment: Siempre validar antes de desplegar</li> <li>CI/CD: Incluir en pipeline de tests</li> <li>Arreglar r\u00e1pido: No ignorar advertencias</li> <li>Documentar: Anotar por qu\u00e9 cambios fueron necesarios</li> </ol>"},{"location":"es/commands/setup/validate/#ver-tambien","title":"Ver Tambi\u00e9n","text":"<ul> <li><code>dbl reset</code> - Reconstruir desde capas</li> <li><code>dbl sandbox start</code> - Crear sandbox limpio</li> <li><code>dbl diff</code> - Ver cambios</li> <li><code>dbl log</code> - Ver historial</li> </ul>"},{"location":"es/commands/setup/version/","title":"dbl version","text":"<p>Mostrar la versi\u00f3n de DBL instalada y verificar actualizaciones disponibles.</p>"},{"location":"es/commands/setup/version/#sinopsis","title":"Sinopsis","text":"<pre><code>dbl version\ndbl version --check\ndbl version --verbose\n</code></pre>"},{"location":"es/commands/setup/version/#descripcion","title":"Descripci\u00f3n","text":"<p>Muestra la versi\u00f3n actual de DBL instalada en tu sistema. Tambi\u00e9n puede verificar si hay versiones m\u00e1s nuevas disponibles.</p>"},{"location":"es/commands/setup/version/#ejemplo-de-uso","title":"Ejemplo de Uso","text":"<pre><code>dbl version\n</code></pre> <p>Salida: <pre><code>DBL version 2.1.0\nPython 3.9.13\nPostgreSQL driver: psycopg2 2.9.5\nMySQL driver: mysql-connector-python 8.0.33\n</code></pre></p>"},{"location":"es/commands/setup/version/#opciones","title":"Opciones","text":""},{"location":"es/commands/setup/version/#-check","title":"<code>--check</code>","text":"<p>Verificar si hay actualizaciones disponibles:</p> <pre><code>$ dbl version --check\n\nDBL version 2.1.0\nLatest version: 2.2.0\n\u2713 New version available!\n\nTo update: dbl update\n</code></pre>"},{"location":"es/commands/setup/version/#-verbose","title":"<code>--verbose</code>","text":"<p>Informaci\u00f3n detallada:</p> <pre><code>$ dbl version --verbose\n\nDBL version 2.1.0\nInstalled: /usr/local/lib/python3.9/site-packages/dbl\nPython version: 3.9.13\nPython location: /usr/local/bin/python3.9\n\nDatabase Drivers:\n  PostgreSQL: psycopg2 2.9.5 \u2713\n  MySQL: mysql-connector-python 8.0.33 \u2713\n\nConfiguration:\n  Home: ~/.dbl\n  Config file: ~/.dbl/config.yaml\n  Default engine: postgres\n</code></pre>"},{"location":"es/commands/setup/version/#ejemplos-completos","title":"Ejemplos Completos","text":""},{"location":"es/commands/setup/version/#verificar-instalacion","title":"Verificar Instalaci\u00f3n","text":"<pre><code>$ dbl version\nDBL version 2.1.0\n\n# Instalado correctamente\n</code></pre>"},{"location":"es/commands/setup/version/#verificar-actualizaciones","title":"Verificar Actualizaciones","text":"<pre><code>$ dbl version --check\nDBL version 2.1.0\nLatest version: 2.2.0\n\u2713 New version available!\n\n# Usar dbl update para instalar\n</code></pre>"},{"location":"es/commands/setup/version/#informacion-detallada","title":"Informaci\u00f3n Detallada","text":"<pre><code>$ dbl version --verbose\n\nDBL version 2.1.0\nInstalled at: /opt/homebrew/lib/python3.9/site-packages/dbl/\n\nPython:\n  Version: 3.9.13\n  Location: /opt/homebrew/bin/python3.9\n\nDrivers:\n  PostgreSQL: psycopg2 2.9.5 \u2713\n  MySQL: mysql-connector-python 8.0.33 \u2713\n\nDependencies:\n  PyYAML: 6.0 \u2713\n  pydantic: 1.10.2 \u2713\n</code></pre>"},{"location":"es/commands/setup/version/#casos-de-uso","title":"Casos de Uso","text":""},{"location":"es/commands/setup/version/#cicd-pipelines","title":"CI/CD Pipelines","text":"<pre><code>#!/bin/bash\n# verify-dbl.sh\n\n# Verificar que DBL est\u00e1 instalado\ndbl version || {\n    echo \"DBL not installed!\"\n    exit 1\n}\n\n# Verificar versi\u00f3n m\u00ednima\nCURRENT=$(dbl version | grep -oP '(?&lt;=version )\\d+\\.\\d+\\.\\d+')\nREQUIRED=\"2.0.0\"\n\nif [ $(printf '%s\\n' \"$REQUIRED\" \"$CURRENT\" | sort -V | head -n1) = \"$REQUIRED\" ]; then\n    echo \"\u2713 DBL version OK ($CURRENT &gt;= $REQUIRED)\"\nelse\n    echo \"\u2717 DBL too old ($CURRENT &lt; $REQUIRED)\"\n    exit 1\nfi\n</code></pre>"},{"location":"es/commands/setup/version/#script-de-onboarding","title":"Script de Onboarding","text":"<pre><code>#!/bin/bash\n# setup-dev-env.sh\n\necho \"Verifying DBL installation...\"\ndbl version --verbose\n\necho \"\"\necho \"Checking for updates...\"\ndbl version --check\n\necho \"\"\nread -p \"Update now? (y/n): \" -n 1 -r\necho\nif [[ $REPLY =~ ^[Yy]$ ]]; then\n    dbl update\nfi\n</code></pre>"},{"location":"es/commands/setup/version/#comparacion-entre-ambientes","title":"Comparaci\u00f3n entre Ambientes","text":"<pre><code>echo \"=== Development ===\"\ndbl version\n\necho \"\"\necho \"=== Staging ===\"\nssh staging \"dbl version\"\n\necho \"\"\necho \"=== Production ===\"\nssh production \"dbl version\"\n</code></pre>"},{"location":"es/commands/setup/version/#integracion-con-scripts","title":"Integraci\u00f3n con Scripts","text":""},{"location":"es/commands/setup/version/#python","title":"Python","text":"<pre><code>import subprocess\n\n# Obtener versi\u00f3n\nresult = subprocess.run(['dbl', 'version'], \n                       capture_output=True, text=True)\nprint(result.stdout)\n\n# Verificar si necesita actualizaci\u00f3n\nresult = subprocess.run(['dbl', 'version', '--check'],\n                       capture_output=True, text=True)\nif 'New version available' in result.stdout:\n    print(\"Update available!\")\n</code></pre>"},{"location":"es/commands/setup/version/#shell","title":"Shell","text":"<pre><code>#!/bin/bash\n# check-version.sh\n\nVERSION=$(dbl version | grep -oP '(?&lt;=version )\\d+\\.\\d+\\.\\d+')\necho \"DBL version: $VERSION\"\n\n# Parsear versi\u00f3n\nMAJOR=$(echo $VERSION | cut -d. -f1)\nMINOR=$(echo $VERSION | cut -d. -f2)\n\necho \"Major: $MAJOR, Minor: $MINOR\"\n</code></pre>"},{"location":"es/commands/setup/version/#salida-por-version","title":"Salida por Versi\u00f3n","text":""},{"location":"es/commands/setup/version/#v2x-actual","title":"V2.x (Actual)","text":"<pre><code>DBL version 2.1.0\nPython 3.9.13\nPostgreSQL driver: psycopg2 2.9.5\nMySQL driver: mysql-connector-python 8.0.33\n</code></pre>"},{"location":"es/commands/setup/version/#v1x-legacy","title":"V1.x (Legacy)","text":"<pre><code>DBL version 1.5.2\nPython 3.7.10\n</code></pre>"},{"location":"es/commands/setup/version/#relacionado","title":"Relacionado","text":""},{"location":"es/commands/setup/version/#actualizacion","title":"Actualizaci\u00f3n","text":"<pre><code># Ver versiones disponibles\ndbl version --check\n\n# Actualizar a \u00faltima\ndbl update\n\n# Actualizar a versi\u00f3n espec\u00edfica\ndbl update --version 2.2.0\n</code></pre>"},{"location":"es/commands/setup/version/#informacion-de-sistema","title":"Informaci\u00f3n de Sistema","text":"<pre><code>$ python3 --version\nPython 3.9.13\n\n$ psql --version\npsql (PostgreSQL) 13.8\n\n$ mysql --version\nmysql Ver 8.0.33\n</code></pre>"},{"location":"es/commands/setup/version/#notas-importantes","title":"Notas Importantes","text":"<p>Sin Conexi\u00f3n</p> <p><code>dbl version</code> funciona sin conexi\u00f3n. <code>dbl version --check</code> requiere internet.</p> <p>Actualizaci\u00f3n Regular</p> <p>Mantener DBL actualizado para nuevas features y seguridad. Ejecutar <code>dbl version --check</code> regularmente.</p>"},{"location":"es/commands/setup/version/#troubleshooting","title":"Troubleshooting","text":""},{"location":"es/commands/setup/version/#comando-no-encontrado","title":"Comando No Encontrado","text":"<pre><code>Error: command not found: dbl\n</code></pre> <p>Soluci\u00f3n: <pre><code># Reinstalar DBL\npip install --upgrade dbl\n\n# O si se instal\u00f3 con otra herramienta\nbrew upgrade dbl  # macOS\n</code></pre></p>"},{"location":"es/commands/setup/version/#version-antigua","title":"Versi\u00f3n Antigua","text":"<p>Si tienes versi\u00f3n vieja:</p> <pre><code>$ dbl version\nDBL version 1.5.2\n\n# Actualizar\n$ pip install --upgrade dbl\n$ dbl version\nDBL version 2.1.0\n</code></pre>"},{"location":"es/commands/setup/version/#ver-tambien","title":"Ver Tambi\u00e9n","text":"<ul> <li><code>dbl update</code> - Actualizar DBL</li> <li><code>dbl init</code> - Inicializar nuevo proyecto</li> <li><code>dbl help</code> - Ver ayuda</li> </ul>"},{"location":"es/getting-started/first-migration/","title":"Tu Primera Migraci\u00f3n","text":"<p>Tutorial completo para crear tu primera migraci\u00f3n real con DBL.</p>"},{"location":"es/getting-started/first-migration/#escenario","title":"Escenario","text":"<p>Est\u00e1s construyendo un blog y necesitas: - Sistema de usuarios - Publicaciones (posts) - Comentarios - Sistema de etiquetas (tags)</p> <p>Crearemos estas tablas paso a paso usando DBL.</p>"},{"location":"es/getting-started/first-migration/#prerrequisitos","title":"Prerrequisitos","text":"<ul> <li>DBL instalado e inicializado</li> <li>Base de datos creada</li> <li>Archivo <code>dbl.yaml</code> configurado</li> </ul> <p>Si a\u00fan no lo has hecho:</p> <pre><code># Crear base de datos\ncreatedb blog_db\n\n# Configurar DBL\ncat &gt; dbl.yaml &lt;&lt; EOF\ndatabase:\n  name: blog_db\n  engine: postgres\n  host: localhost\n  port: 5432\n  user: tu_usuario\n  password: \\${DB_PASSWORD}\nEOF\n\n# Inicializar\ndbl init\n</code></pre>"},{"location":"es/getting-started/first-migration/#paso-1-crear-tabla-de-usuarios","title":"Paso 1: Crear Tabla de Usuarios","text":""},{"location":"es/getting-started/first-migration/#iniciar-sandbox","title":"Iniciar Sandbox","text":"<pre><code>dbl sandbox start\n</code></pre> <p>Salida: <pre><code>\u2713 Sandbox created: blog_db_sandbox\n</code></pre></p>"},{"location":"es/getting-started/first-migration/#disenar-la-tabla","title":"Dise\u00f1ar la Tabla","text":"<p>Crea <code>migrations/001_users.sql</code> (solo para referencia):</p> <pre><code>CREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    username VARCHAR(50) UNIQUE NOT NULL,\n    email VARCHAR(255) UNIQUE NOT NULL,\n    password_hash VARCHAR(255) NOT NULL,\n    first_name VARCHAR(100),\n    last_name VARCHAR(100),\n    bio TEXT,\n    avatar_url VARCHAR(500),\n    is_active BOOLEAN DEFAULT true,\n    is_admin BOOLEAN DEFAULT false,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- \u00cdndices para b\u00fasquedas comunes\nCREATE INDEX idx_users_username ON users(username);\nCREATE INDEX idx_users_email ON users(email);\nCREATE INDEX idx_users_active ON users(is_active);\n\n-- Trigger para actualizar updated_at\nCREATE OR REPLACE FUNCTION update_updated_at_column()\nRETURNS TRIGGER AS $$\nBEGIN\n    NEW.updated_at = CURRENT_TIMESTAMP;\n    RETURN NEW;\nEND;\n$$ language 'plpgsql';\n\nCREATE TRIGGER update_users_updated_at \n    BEFORE UPDATE ON users\n    FOR EACH ROW\n    EXECUTE FUNCTION update_updated_at_column();\n</code></pre>"},{"location":"es/getting-started/first-migration/#ejecutar-en-sandbox","title":"Ejecutar en Sandbox","text":"<pre><code>psql -d blog_db_sandbox -f migrations/001_users.sql\n</code></pre>"},{"location":"es/getting-started/first-migration/#verificar-cambios","title":"Verificar Cambios","text":"<pre><code>dbl diff\n</code></pre> <p>Salida: <pre><code>+ CREATE TABLE users (\n+     id SERIAL PRIMARY KEY,\n+     username VARCHAR(50) UNIQUE NOT NULL,\n+     email VARCHAR(255) UNIQUE NOT NULL,\n+     ...\n+ );\n\n+ CREATE INDEX idx_users_username ON users(username);\n+ CREATE INDEX idx_users_email ON users(email);\n+ CREATE INDEX idx_users_active ON users(is_active);\n\n+ CREATE FUNCTION update_updated_at_column() ...\n+ CREATE TRIGGER update_users_updated_at ...\n\nSummary:\n  + 1 table added (users)\n  + 5 indexes added\n  + 1 function added\n  + 1 trigger added\n</code></pre></p>"},{"location":"es/getting-started/first-migration/#guardar-como-capa","title":"Guardar como Capa","text":"<pre><code>dbl commit -m \"Add users table with authentication fields\"\n</code></pre> <p>Salida: <pre><code>\u2713 Layer L001 created: Add users table with authentication fields\n\u2713 Layer saved to .dbl/layers/L001_add_users_table.sql\n</code></pre></p>"},{"location":"es/getting-started/first-migration/#paso-2-crear-tabla-de-posts","title":"Paso 2: Crear Tabla de Posts","text":""},{"location":"es/getting-started/first-migration/#disenar-posts","title":"Dise\u00f1ar Posts","text":"<pre><code>-- migrations/002_posts.sql\nCREATE TABLE posts (\n    id SERIAL PRIMARY KEY,\n    author_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,\n    title VARCHAR(200) NOT NULL,\n    slug VARCHAR(200) UNIQUE NOT NULL,\n    content TEXT NOT NULL,\n    excerpt TEXT,\n    featured_image VARCHAR(500),\n    status VARCHAR(20) DEFAULT 'draft' \n        CHECK (status IN ('draft', 'published', 'archived')),\n    published_at TIMESTAMP,\n    view_count INTEGER DEFAULT 0,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- \u00cdndices para rendimiento\nCREATE INDEX idx_posts_author ON posts(author_id);\nCREATE INDEX idx_posts_slug ON posts(slug);\nCREATE INDEX idx_posts_status ON posts(status);\nCREATE INDEX idx_posts_published ON posts(published_at);\n\n-- Trigger para updated_at\nCREATE TRIGGER update_posts_updated_at \n    BEFORE UPDATE ON posts\n    FOR EACH ROW\n    EXECUTE FUNCTION update_updated_at_column();\n</code></pre>"},{"location":"es/getting-started/first-migration/#aplicar-en-sandbox","title":"Aplicar en Sandbox","text":"<pre><code>psql -d blog_db_sandbox -f migrations/002_posts.sql\n</code></pre>"},{"location":"es/getting-started/first-migration/#ver-y-guardar","title":"Ver y Guardar","text":"<pre><code>dbl diff\ndbl commit -m \"Add posts table with status and publishing features\"\n</code></pre>"},{"location":"es/getting-started/first-migration/#paso-3-crear-tabla-de-comentarios","title":"Paso 3: Crear Tabla de Comentarios","text":""},{"location":"es/getting-started/first-migration/#disenar-comentarios","title":"Dise\u00f1ar Comentarios","text":"<pre><code>-- migrations/003_comments.sql\nCREATE TABLE comments (\n    id SERIAL PRIMARY KEY,\n    post_id INTEGER NOT NULL REFERENCES posts(id) ON DELETE CASCADE,\n    author_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,\n    parent_id INTEGER REFERENCES comments(id) ON DELETE CASCADE,\n    content TEXT NOT NULL,\n    is_approved BOOLEAN DEFAULT false,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- \u00cdndices\nCREATE INDEX idx_comments_post ON comments(post_id);\nCREATE INDEX idx_comments_author ON comments(author_id);\nCREATE INDEX idx_comments_parent ON comments(parent_id);\nCREATE INDEX idx_comments_approved ON comments(is_approved);\n\n-- Trigger\nCREATE TRIGGER update_comments_updated_at \n    BEFORE UPDATE ON comments\n    FOR EACH ROW\n    EXECUTE FUNCTION update_updated_at_column();\n</code></pre>"},{"location":"es/getting-started/first-migration/#aplicar","title":"Aplicar","text":"<pre><code>psql -d blog_db_sandbox -f migrations/003_comments.sql\ndbl commit -m \"Add comments table with nested comment support\"\n</code></pre>"},{"location":"es/getting-started/first-migration/#paso-4-sistema-de-etiquetas","title":"Paso 4: Sistema de Etiquetas","text":""},{"location":"es/getting-started/first-migration/#disenar-tags-y-relacion","title":"Dise\u00f1ar Tags y Relaci\u00f3n","text":"<pre><code>-- migrations/004_tags.sql\n\n-- Tabla de etiquetas\nCREATE TABLE tags (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(50) UNIQUE NOT NULL,\n    slug VARCHAR(50) UNIQUE NOT NULL,\n    description TEXT,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Relaci\u00f3n muchos-a-muchos entre posts y tags\nCREATE TABLE post_tags (\n    post_id INTEGER NOT NULL REFERENCES posts(id) ON DELETE CASCADE,\n    tag_id INTEGER NOT NULL REFERENCES tags(id) ON DELETE CASCADE,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    PRIMARY KEY (post_id, tag_id)\n);\n\n-- \u00cdndices\nCREATE INDEX idx_tags_name ON tags(name);\nCREATE INDEX idx_tags_slug ON tags(slug);\nCREATE INDEX idx_post_tags_post ON post_tags(post_id);\nCREATE INDEX idx_post_tags_tag ON post_tags(tag_id);\n</code></pre>"},{"location":"es/getting-started/first-migration/#aplicar_1","title":"Aplicar","text":"<pre><code>psql -d blog_db_sandbox -f migrations/004_tags.sql\ndbl commit -m \"Add tags system with many-to-many relationship\"\n</code></pre>"},{"location":"es/getting-started/first-migration/#paso-5-revisar-historial","title":"Paso 5: Revisar Historial","text":"<pre><code>dbl log\n</code></pre> <p>Salida: <pre><code>* L004 - Add tags system with many-to-many relationship\n  Date: 2024-12-30 11:05:22\n\n* L003 - Add comments table with nested comment support\n  Date: 2024-12-30 11:00:15\n\n* L002 - Add posts table with status and publishing features\n  Date: 2024-12-30 10:55:33\n\n* L001 - Add users table with authentication fields\n  Date: 2024-12-30 10:50:11\n</code></pre></p>"},{"location":"es/getting-started/first-migration/#paso-6-aplicar-todo-a-la-base-principal","title":"Paso 6: Aplicar Todo a la Base Principal","text":"<pre><code>dbl sandbox apply\n</code></pre> <p>Salida: <pre><code>Applying sandbox changes to main database (blog_db)...\n  \u2192 Executing L001\n  \u2192 Executing L002\n  \u2192 Executing L003\n  \u2192 Executing L004\n\u2713 All changes applied successfully\n\nSummary:\n  Database: blog_db\n  Layers applied: 4\n  Tables added: 6 (users, posts, comments, tags, post_tags)\n  Indexes added: 15\n  Functions added: 1\n  Triggers added: 3\n</code></pre></p>"},{"location":"es/getting-started/first-migration/#paso-7-verificar-el-resultado","title":"Paso 7: Verificar el Resultado","text":"<pre><code>psql -d blog_db -c \"\\dt\"\n</code></pre> <p>Salida: <pre><code>             List of relations\n Schema |    Name    | Type  |  Owner\n--------+------------+-------+---------\n public | comments   | table | dbuser\n public | post_tags  | table | dbuser\n public | posts      | table | dbuser\n public | tags       | table | dbuser\n public | users      | table | dbuser\n</code></pre></p>"},{"location":"es/getting-started/first-migration/#paso-8-probar-con-datos","title":"Paso 8: Probar con Datos","text":""},{"location":"es/getting-started/first-migration/#insertar-datos-de-prueba","title":"Insertar Datos de Prueba","text":"<pre><code>-- Crear un usuario\nINSERT INTO users (username, email, password_hash, first_name, last_name)\nVALUES ('johndoe', 'john@example.com', 'hashed_password', 'John', 'Doe')\nRETURNING id;\n\n-- Crear un post (usa el ID del usuario)\nINSERT INTO posts (author_id, title, slug, content, status, published_at)\nVALUES (1, 'Mi Primer Post', 'mi-primer-post', \n        'Este es el contenido de mi primer post.', \n        'published', CURRENT_TIMESTAMP)\nRETURNING id;\n\n-- Crear tags\nINSERT INTO tags (name, slug) VALUES \n    ('Tutorial', 'tutorial'),\n    ('DBL', 'dbl'),\n    ('PostgreSQL', 'postgresql');\n\n-- Asociar tags al post\nINSERT INTO post_tags (post_id, tag_id) VALUES (1, 1), (1, 2), (1, 3);\n\n-- Agregar comentario\nINSERT INTO comments (post_id, author_id, content, is_approved)\nVALUES (1, 1, '\u00a1Gran post!', true);\n</code></pre>"},{"location":"es/getting-started/first-migration/#ejecutar","title":"Ejecutar","text":"<pre><code>psql -d blog_db &lt;&lt; EOF\n-- Insertar todos los datos de prueba aqu\u00ed\nEOF\n</code></pre>"},{"location":"es/getting-started/first-migration/#consultar-datos","title":"Consultar Datos","text":"<pre><code>-- Ver posts con autor y cantidad de comentarios\nSELECT \n    p.title,\n    u.username as author,\n    COUNT(c.id) as comment_count,\n    p.published_at\nFROM posts p\nJOIN users u ON p.author_id = u.id\nLEFT JOIN comments c ON p.id = c.post_id\nGROUP BY p.id, u.username\nORDER BY p.published_at DESC;\n</code></pre>"},{"location":"es/getting-started/first-migration/#paso-9-agregar-mejora-nueva-capa","title":"Paso 9: Agregar Mejora (Nueva Capa)","text":"<p>Agreguemos una tabla de \"me gusta\" para posts:</p> <pre><code># Nuevo sandbox\ndbl sandbox start\n\n# Crear likes table\npsql -d blog_db_sandbox &lt;&lt; EOF\nCREATE TABLE post_likes (\n    id SERIAL PRIMARY KEY,\n    post_id INTEGER NOT NULL REFERENCES posts(id) ON DELETE CASCADE,\n    user_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    UNIQUE(post_id, user_id)\n);\n\nCREATE INDEX idx_post_likes_post ON post_likes(post_id);\nCREATE INDEX idx_post_likes_user ON post_likes(user_id);\nEOF\n\n# Ver cambios\ndbl diff\n\n# Commit\ndbl commit -m \"Add post likes functionality\"\n\n# Apply\ndbl sandbox apply\n</code></pre>"},{"location":"es/getting-started/first-migration/#paso-10-verificar-integridad","title":"Paso 10: Verificar Integridad","text":"<pre><code>dbl validate\n</code></pre> <p>Salida: <pre><code>Validating DBL repository...\n\n\u2713 Configuration (dbl.yaml)\n\u2713 State file (.dbl/state.json)\n\u2713 Layer files (5 layers)\n\u2713 SQL syntax\n\u2713 Database schema\n\u2713 Foreign key relationships\n\nAll checks passed! Repository is healthy.\n</code></pre></p>"},{"location":"es/getting-started/first-migration/#estructura-final","title":"Estructura Final","text":"<pre><code>blog_db\n\u251c\u2500\u2500 users (usuarios)\n\u251c\u2500\u2500 posts (publicaciones)\n\u2502   \u2514\u2500\u2500 author_id \u2192 users.id\n\u251c\u2500\u2500 comments (comentarios)\n\u2502   \u251c\u2500\u2500 post_id \u2192 posts.id\n\u2502   \u251c\u2500\u2500 author_id \u2192 users.id\n\u2502   \u2514\u2500\u2500 parent_id \u2192 comments.id (comentarios anidados)\n\u251c\u2500\u2500 tags (etiquetas)\n\u251c\u2500\u2500 post_tags (relaci\u00f3n posts-tags)\n\u2502   \u251c\u2500\u2500 post_id \u2192 posts.id\n\u2502   \u2514\u2500\u2500 tag_id \u2192 tags.id\n\u2514\u2500\u2500 post_likes (me gusta)\n    \u251c\u2500\u2500 post_id \u2192 posts.id\n    \u2514\u2500\u2500 user_id \u2192 users.id\n</code></pre>"},{"location":"es/getting-started/first-migration/#reconstruir-desde-cero","title":"Reconstruir desde Cero","text":"<p>Puedes reconstruir toda la base de datos desde las capas:</p> <pre><code># Reconstruir\ndbl reset\n\n# Verifica que todo se cre\u00f3 correctamente\npsql -d blog_db -c \"\\dt\"\n</code></pre> <p>DBL reproduce todas las capas: <pre><code>Dropping database blog_db...\nCreating database blog_db...\nReplaying layers:\n  \u2192 L001 \u2713\n  \u2192 L002 \u2713\n  \u2192 L003 \u2713\n  \u2192 L004 \u2713\n  \u2192 L005 \u2713\n\n\u2713 Reset complete\n</code></pre></p>"},{"location":"es/getting-started/first-migration/#lecciones-aprendidas","title":"Lecciones Aprendidas","text":""},{"location":"es/getting-started/first-migration/#buenas-practicas-aplicadas","title":"\u2705 Buenas Pr\u00e1cticas Aplicadas","text":"<ol> <li>\u00cdndices apropiados: Creamos \u00edndices en claves for\u00e1neas y campos de b\u00fasqueda</li> <li>Constraints: Usamos CHECK constraints para validar datos</li> <li>Cascadas: ON DELETE CASCADE para mantener integridad referencial</li> <li>Triggers: Actualizaci\u00f3n autom\u00e1tica de timestamps</li> <li>Commits descriptivos: Mensajes claros de cada capa</li> </ol>"},{"location":"es/getting-started/first-migration/#estructura-de-capas","title":"\ud83d\udcdd Estructura de Capas","text":"<pre><code>.dbl/layers/\n\u251c\u2500\u2500 L001_add_users_table.sql\n\u251c\u2500\u2500 L002_add_posts_table.sql\n\u251c\u2500\u2500 L003_add_comments_table.sql\n\u251c\u2500\u2500 L004_add_tags_system.sql\n\u2514\u2500\u2500 L005_add_post_likes.sql\n</code></pre>"},{"location":"es/getting-started/first-migration/#flujo-de-trabajo","title":"\ud83d\udd04 Flujo de Trabajo","text":"<pre><code>sandbox start \u2192 cambios \u2192 diff \u2192 commit \u2192 apply\n     \u2193           \u2193         \u2193       \u2193        \u2193\n   seguro    experimenta  revisa guarda  aplica\n</code></pre>"},{"location":"es/getting-started/first-migration/#trabajo-en-equipo","title":"Trabajo en Equipo","text":"<p>Comparte con tu equipo:</p> <pre><code># Guardar en Git\ngit add .dbl/ dbl.yaml\ngit commit -m \"Initial blog database schema\"\ngit push\n\n# Tu equipo puede aplicar\ngit pull\ndbl reset  # Recrea desde capas\n</code></pre>"},{"location":"es/getting-started/first-migration/#proximos-pasos","title":"Pr\u00f3ximos Pasos","text":"<p>Has completado tu primera migraci\u00f3n real. Ahora:</p> <ol> <li>Aprende m\u00e1s comandos</li> <li>Usa branches para desarrollo paralelo</li> <li>Mejores pr\u00e1cticas para proyectos grandes</li> <li>CI/CD para automatizaci\u00f3n</li> </ol>"},{"location":"es/getting-started/first-migration/#ver-tambien","title":"Ver Tambi\u00e9n","text":"<ul> <li>Inicio R\u00e1pido</li> <li>Comandos de Sandbox</li> <li>Gu\u00eda de Configuraci\u00f3n</li> <li>Mejores Pr\u00e1cticas</li> </ul>"},{"location":"es/getting-started/installation/","title":"Instalaci\u00f3n","text":"<p>Gu\u00eda para instalar DBL en tu sistema.</p>"},{"location":"es/getting-started/installation/#requisitos-previos","title":"Requisitos Previos","text":"<ul> <li>Python 3.7 o superior</li> <li>pip (gestor de paquetes de Python)</li> <li>PostgreSQL 9.6+ o MySQL 5.7+</li> <li>Git (recomendado)</li> </ul>"},{"location":"es/getting-started/installation/#instalacion-rapida","title":"Instalaci\u00f3n R\u00e1pida","text":"<pre><code>pip install git+https://github.com/alann-estrada-KSH/dbl-sandbox.git\n</code></pre>"},{"location":"es/getting-started/installation/#verificar-instalacion","title":"Verificar Instalaci\u00f3n","text":"<pre><code>dbl version\n</code></pre> <p>Salida esperada: <pre><code>DBL (Database Layering) v0.0.1-alpha\nRepository: https://github.com/alann-estrada-KSH/dbl-sandbox\n</code></pre></p>"},{"location":"es/getting-started/installation/#metodos-de-instalacion","title":"M\u00e9todos de Instalaci\u00f3n","text":""},{"location":"es/getting-started/installation/#desde-github-recomendado","title":"Desde GitHub (Recomendado)","text":"<pre><code># \u00daltima versi\u00f3n\npip install git+https://github.com/alann-estrada-KSH/dbl-sandbox.git\n\n# Versi\u00f3n espec\u00edfica (cuando est\u00e9 disponible)\npip install git+https://github.com/alann-estrada-KSH/dbl-sandbox.git@v0.1.0\n</code></pre>"},{"location":"es/getting-started/installation/#instalacion-de-usuario","title":"Instalaci\u00f3n de Usuario","text":"<p>Si no tienes permisos de administrador:</p> <pre><code>pip install --user git+https://github.com/alann-estrada-KSH/dbl-sandbox.git\n</code></pre> <p>Luego agrega al PATH:</p> <pre><code># Linux/macOS (agregar a ~/.bashrc o ~/.zshrc)\nexport PATH=\"$HOME/.local/bin:$PATH\"\n\n# Windows (ejecutar en PowerShell como Admin)\n$env:Path += \";$env:LOCALAPPDATA\\Programs\\Python\\Python3X\\Scripts\"\n</code></pre>"},{"location":"es/getting-started/installation/#instalacion-en-entorno-virtual","title":"Instalaci\u00f3n en Entorno Virtual","text":"<pre><code># Crear entorno virtual\npython -m venv dbl-env\n\n# Activar entorno\n# Linux/macOS:\nsource dbl-env/bin/activate\n# Windows:\ndbl-env\\Scripts\\activate\n\n# Instalar DBL\npip install git+https://github.com/alann-estrada-KSH/dbl-sandbox.git\n\n# Verificar\ndbl version\n</code></pre>"},{"location":"es/getting-started/installation/#instalacion-de-base-de-datos","title":"Instalaci\u00f3n de Base de Datos","text":""},{"location":"es/getting-started/installation/#postgresql","title":"PostgreSQL","text":""},{"location":"es/getting-started/installation/#ubuntudebian","title":"Ubuntu/Debian","text":"<pre><code>sudo apt update\nsudo apt install postgresql postgresql-contrib\nsudo systemctl start postgresql\n</code></pre>"},{"location":"es/getting-started/installation/#macos","title":"macOS","text":"<pre><code>brew install postgresql\nbrew services start postgresql\n</code></pre>"},{"location":"es/getting-started/installation/#windows","title":"Windows","text":"<p>Descarga el instalador desde postgresql.org</p>"},{"location":"es/getting-started/installation/#verificar","title":"Verificar","text":"<pre><code>psql --version\n</code></pre>"},{"location":"es/getting-started/installation/#mysql","title":"MySQL","text":""},{"location":"es/getting-started/installation/#ubuntudebian_1","title":"Ubuntu/Debian","text":"<pre><code>sudo apt update\nsudo apt install mysql-server\nsudo systemctl start mysql\n</code></pre>"},{"location":"es/getting-started/installation/#macos_1","title":"macOS","text":"<pre><code>brew install mysql\nbrew services start mysql\n</code></pre>"},{"location":"es/getting-started/installation/#windows_1","title":"Windows","text":"<p>Descarga el instalador desde mysql.com</p>"},{"location":"es/getting-started/installation/#verificar_1","title":"Verificar","text":"<pre><code>mysql --version\n</code></pre>"},{"location":"es/getting-started/installation/#configuracion-inicial-de-base-de-datos","title":"Configuraci\u00f3n Inicial de Base de Datos","text":""},{"location":"es/getting-started/installation/#postgresql_1","title":"PostgreSQL","text":"<pre><code># Cambiar a usuario postgres\nsudo -u postgres psql\n\n# Crear usuario y base de datos\nCREATE USER dbuser WITH PASSWORD 'tu_password';\nCREATE DATABASE myapp OWNER dbuser;\nGRANT ALL PRIVILEGES ON DATABASE myapp TO dbuser;\n\n# Salir\n\\q\n</code></pre>"},{"location":"es/getting-started/installation/#mysql_1","title":"MySQL","text":"<pre><code># Conectar como root\nsudo mysql\n\n# Crear usuario y base de datos\nCREATE USER 'dbuser'@'localhost' IDENTIFIED BY 'tu_password';\nCREATE DATABASE myapp;\nGRANT ALL PRIVILEGES ON myapp.* TO 'dbuser'@'localhost';\nFLUSH PRIVILEGES;\n\n# Salir\nEXIT;\n</code></pre>"},{"location":"es/getting-started/installation/#verificar-conexion","title":"Verificar Conexi\u00f3n","text":""},{"location":"es/getting-started/installation/#postgresql_2","title":"PostgreSQL","text":"<pre><code>psql -h localhost -U dbuser -d myapp\n</code></pre>"},{"location":"es/getting-started/installation/#mysql_2","title":"MySQL","text":"<pre><code>mysql -h localhost -u dbuser -p myapp\n</code></pre>"},{"location":"es/getting-started/installation/#actualizar-dbl","title":"Actualizar DBL","text":"<pre><code># M\u00e9todo autom\u00e1tico\ndbl update\n\n# O manualmente\npip install --upgrade git+https://github.com/alann-estrada-KSH/dbl-sandbox.git\n</code></pre>"},{"location":"es/getting-started/installation/#desinstalar","title":"Desinstalar","text":"<pre><code>pip uninstall dbl\n</code></pre>"},{"location":"es/getting-started/installation/#instalacion-para-desarrollo","title":"Instalaci\u00f3n para Desarrollo","text":"<p>Si quieres contribuir a DBL:</p> <pre><code># Clonar repositorio\ngit clone https://github.com/alann-estrada-KSH/dbl-sandbox.git\ncd dbl-sandbox\n\n# Crear entorno virtual\npython -m venv venv\nsource venv/bin/activate  # Linux/macOS\n# o\nvenv\\Scripts\\activate  # Windows\n\n# Instalar en modo desarrollo\npip install -e .\n\n# Instalar dependencias de desarrollo\npip install -r requirements-dev.txt\n</code></pre>"},{"location":"es/getting-started/installation/#instalacion-con-docker","title":"Instalaci\u00f3n con Docker","text":""},{"location":"es/getting-started/installation/#dockerfile","title":"Dockerfile","text":"<pre><code>FROM python:3.11-slim\n\n# Instalar dependencias del sistema\nRUN apt-get update &amp;&amp; apt-get install -y \\\n    postgresql-client \\\n    git \\\n    &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n# Instalar DBL\nRUN pip install git+https://github.com/alann-estrada-KSH/dbl-sandbox.git\n\n# Verificar instalaci\u00f3n\nRUN dbl version\n\nWORKDIR /app\nCMD [\"dbl\"]\n</code></pre>"},{"location":"es/getting-started/installation/#docker-compose","title":"Docker Compose","text":"<pre><code>version: '3.8'\n\nservices:\n  postgres:\n    image: postgres:14\n    environment:\n      POSTGRES_USER: dbuser\n      POSTGRES_PASSWORD: dbpass\n      POSTGRES_DB: myapp\n    ports:\n      - \"5432:5432\"\n    volumes:\n      - postgres_data:/var/lib/postgresql/data\n\n  dbl:\n    build: .\n    depends_on:\n      - postgres\n    environment:\n      DB_HOST: postgres\n      DB_USER: dbuser\n      DB_PASSWORD: dbpass\n      DB_NAME: myapp\n    volumes:\n      - .:/app\n\nvolumes:\n  postgres_data:\n</code></pre>"},{"location":"es/getting-started/installation/#integracion-cicd","title":"Integraci\u00f3n CI/CD","text":""},{"location":"es/getting-started/installation/#github-actions","title":"GitHub Actions","text":"<pre><code>name: DBL Tests\n\non: [push, pull_request]\n\njobs:\n  test:\n    runs-on: ubuntu-latest\n\n    services:\n      postgres:\n        image: postgres:14\n        env:\n          POSTGRES_USER: postgres\n          POSTGRES_PASSWORD: postgres\n          POSTGRES_DB: testdb\n        options: &gt;-\n          --health-cmd pg_isready\n          --health-interval 10s\n          --health-timeout 5s\n          --health-retries 5\n        ports:\n          - 5432:5432\n\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Set up Python\n        uses: actions/setup-python@v4\n        with:\n          python-version: '3.11'\n\n      - name: Install DBL\n        run: |\n          pip install git+https://github.com/alann-estrada-KSH/dbl-sandbox.git\n\n      - name: Verify installation\n        run: dbl version\n\n      - name: Run tests\n        run: |\n          dbl init\n          dbl reset\n</code></pre>"},{"location":"es/getting-started/installation/#gitlab-ci","title":"GitLab CI","text":"<pre><code>stages:\n  - test\n\ntest_dbl:\n  stage: test\n  image: python:3.11\n\n  services:\n    - postgres:14\n\n  variables:\n    POSTGRES_USER: postgres\n    POSTGRES_PASSWORD: postgres\n    POSTGRES_DB: testdb\n\n  before_script:\n    - pip install git+https://github.com/alann-estrada-KSH/dbl-sandbox.git\n    - dbl version\n\n  script:\n    - dbl init\n    - dbl reset\n</code></pre>"},{"location":"es/getting-started/installation/#solucion-de-problemas","title":"Soluci\u00f3n de Problemas","text":""},{"location":"es/getting-started/installation/#comando-dbl-no-encontrado","title":"Comando <code>dbl</code> no encontrado","text":"<pre><code># Verificar instalaci\u00f3n\npip list | grep dbl\n\n# Agregar al PATH\nexport PATH=\"$HOME/.local/bin:$PATH\"\n\n# O usar como m\u00f3dulo\npython -m dbl version\n</code></pre>"},{"location":"es/getting-started/installation/#error-de-permisos","title":"Error de permisos","text":"<pre><code># Instalar como usuario\npip install --user git+https://github.com/...\n\n# O usar sudo (Linux/macOS)\nsudo pip install git+https://github.com/...\n</code></pre>"},{"location":"es/getting-started/installation/#falta-pyyaml","title":"Falta PyYAML","text":"<pre><code># Instalar manualmente\npip install PyYAML\n\n# O usar actualizaci\u00f3n de DBL\ndbl update\n</code></pre>"},{"location":"es/getting-started/installation/#error-de-conexion-a-base-de-datos","title":"Error de conexi\u00f3n a base de datos","text":"<ol> <li>Verificar que la base de datos est\u00e9 corriendo</li> <li>Revisar credenciales en <code>dbl.yaml</code></li> <li>Probar conexi\u00f3n manualmente con <code>psql</code> o <code>mysql</code></li> </ol>"},{"location":"es/getting-started/installation/#proximos-pasos","title":"Pr\u00f3ximos Pasos","text":"<p>Despu\u00e9s de instalar DBL:</p> <ol> <li>Inicio R\u00e1pido - Tutorial de 10 minutos</li> <li>Tu Primera Migraci\u00f3n - Ejemplo pr\u00e1ctico</li> <li>Configuraci\u00f3n - Configurar DBL</li> </ol>"},{"location":"es/getting-started/installation/#ver-tambien","title":"Ver Tambi\u00e9n","text":"<ul> <li>Inicio R\u00e1pido</li> <li>Gu\u00eda de Configuraci\u00f3n</li> <li>Preguntas Frecuentes</li> <li>Soluci\u00f3n de Problemas</li> </ul>"},{"location":"es/getting-started/quick-start/","title":"Inicio R\u00e1pido","text":"<p>Aprende los fundamentos de DBL en 10 minutos.</p>"},{"location":"es/getting-started/quick-start/#prerrequisitos","title":"Prerrequisitos","text":"<ul> <li>DBL instalado (Gu\u00eda de Instalaci\u00f3n)</li> <li>Base de datos PostgreSQL o MySQL corriendo</li> <li>Conocimientos b\u00e1sicos de SQL</li> </ul>"},{"location":"es/getting-started/quick-start/#paso-1-crear-una-base-de-datos","title":"Paso 1: Crear una Base de Datos","text":"<pre><code># PostgreSQL\ncreatedb myapp\n\n# MySQL\nmysql -u root -e \"CREATE DATABASE myapp;\"\n</code></pre>"},{"location":"es/getting-started/quick-start/#paso-2-configurar-dbl","title":"Paso 2: Configurar DBL","text":"<p>Crea <code>dbl.yaml</code> en tu proyecto:</p> <pre><code>database:\n  name: myapp\n  engine: postgres  # o 'mysql'\n  host: localhost\n  port: 5432        # o 3306 para MySQL\n  user: tu_usuario\n  password: ${DB_PASSWORD}\n</code></pre> <p>Exporta tu contrase\u00f1a:</p> <pre><code>export DB_PASSWORD=\"tu_password\"\n</code></pre>"},{"location":"es/getting-started/quick-start/#paso-3-inicializar-dbl","title":"Paso 3: Inicializar DBL","text":"<pre><code>dbl init\n</code></pre> <p>Salida: <pre><code>Initializing DBL for database 'myapp'...\n\u2713 Configuration validated\n\u2713 Database connection successful\n\u2713 DBL initialized\n\nYour database is ready for version control!\n</code></pre></p>"},{"location":"es/getting-started/quick-start/#paso-4-crear-un-sandbox","title":"Paso 4: Crear un Sandbox","text":"<p>Un sandbox es una copia temporal de tu base de datos donde puedes experimentar sin riesgos.</p> <pre><code>dbl sandbox start\n</code></pre> <p>Salida: <pre><code>Creating sandbox for 'myapp'...\n\u2713 Sandbox database created: myapp_sandbox\n\u2713 Sandbox is active\n\nYou can now make changes in the sandbox.\n</code></pre></p>"},{"location":"es/getting-started/quick-start/#paso-5-hacer-cambios","title":"Paso 5: Hacer Cambios","text":"<p>Crea una tabla en el sandbox:</p> PostgreSQLMySQL <pre><code>psql -d myapp_sandbox -c \"\nCREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    username VARCHAR(50) UNIQUE NOT NULL,\n    email VARCHAR(255) UNIQUE NOT NULL,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\"\n</code></pre> <pre><code>mysql -u tu_usuario -p myapp_sandbox -e \"\nCREATE TABLE users (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    username VARCHAR(50) UNIQUE NOT NULL,\n    email VARCHAR(255) UNIQUE NOT NULL,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n) ENGINE=InnoDB;\n\"\n</code></pre>"},{"location":"es/getting-started/quick-start/#paso-6-ver-los-cambios","title":"Paso 6: Ver los Cambios","text":"<pre><code>dbl diff\n</code></pre> <p>Salida: <pre><code>-- Changes in sandbox (not yet committed)\n\n+ CREATE TABLE users (\n+     id SERIAL PRIMARY KEY,\n+     username VARCHAR(50) UNIQUE NOT NULL,\n+     email VARCHAR(255) UNIQUE NOT NULL,\n+     created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n+ );\n\nSummary:\n  + 1 table added (users)\n  + 2 indexes added (users_pkey, users_username_key)\n  + 1 constraint added\n</code></pre></p>"},{"location":"es/getting-started/quick-start/#paso-7-guardar-los-cambios","title":"Paso 7: Guardar los Cambios","text":"<p>Guarda los cambios como una \"capa\" (layer):</p> <pre><code>dbl commit -m \"Add users table\"\n</code></pre> <p>Salida: <pre><code>Creating layer from sandbox changes...\n\u2713 Layer L001 created: Add users table\n\u2713 Layer saved to .dbl/layers/L001_add_users_table.sql\n\nYour changes are now committed.\n</code></pre></p>"},{"location":"es/getting-started/quick-start/#paso-8-aplicar-al-proyecto-principal","title":"Paso 8: Aplicar al Proyecto Principal","text":"<p>Aplica los cambios a tu base de datos principal:</p> <pre><code>dbl sandbox apply\n</code></pre> <p>Salida: <pre><code>Applying sandbox changes to main database...\n  \u2192 Executing layer L001\n\u2713 Changes applied successfully\n\u2713 Sandbox database dropped\n\u2713 Sandbox metadata cleared\n\nYour main database (myapp) now includes all sandbox changes.\n</code></pre></p>"},{"location":"es/getting-started/quick-start/#felicitaciones","title":"\u00a1Felicitaciones! \ud83c\udf89","text":"<p>Has completado tu primera migraci\u00f3n con DBL. Ahora sabes c\u00f3mo:</p> <ul> <li>\u2705 Inicializar DBL en un proyecto</li> <li>\u2705 Crear un sandbox para cambios seguros</li> <li>\u2705 Ver diferencias entre sandbox y principal</li> <li>\u2705 Guardar cambios como capas</li> <li>\u2705 Aplicar cambios al proyecto principal</li> </ul>"},{"location":"es/getting-started/quick-start/#flujo-de-trabajo-completo","title":"Flujo de Trabajo Completo","text":"<p>Resumen del flujo que acabas de usar:</p> <pre><code># 1. Inicializar\ndbl init\n\n# 2. Crear sandbox\ndbl sandbox start\n\n# 3. Hacer cambios en sandbox\npsql -d myapp_sandbox  # o mysql\n\n# 4. Ver cambios\ndbl diff\n\n# 5. Guardar cambios\ndbl commit -m \"Descripci\u00f3n\"\n\n# 6. Aplicar a principal\ndbl sandbox apply\n</code></pre>"},{"location":"es/getting-started/quick-start/#verificar-el-resultado","title":"Verificar el Resultado","text":"<pre><code># Verificar que la tabla existe en la base principal\npsql -d myapp -c \"\\dt\"\n# o\nmysql -u tu_usuario -p myapp -e \"SHOW TABLES;\"\n</code></pre> <p>Salida: <pre><code>         List of relations\n Schema |  Name  | Type  | Owner\n--------+--------+-------+-------\n public | users  | table | dbuser\n</code></pre></p>"},{"location":"es/getting-started/quick-start/#ver-historial","title":"Ver Historial","text":"<pre><code>dbl log\n</code></pre> <p>Salida: <pre><code>* L001 - Add users table\n  Date: 2024-12-30 10:15:33\n  Branch: main\n\n  Created users table with basic fields for authentication.\n</code></pre></p>"},{"location":"es/getting-started/quick-start/#experimentar-con-cambios","title":"Experimentar con Cambios","text":"<p>Puedes probar cambios sin afectar la base principal:</p> <pre><code># Crear otro sandbox\ndbl sandbox start\n\n# Probar algo\npsql -d myapp_sandbox -c \"\nALTER TABLE users ADD COLUMN last_login TIMESTAMP;\n\"\n\n# Ver cambios\ndbl diff\n\n# Si no te gusta, descarta todo\ndbl sandbox rollback\n\n# El sandbox se elimina, la base principal no se toca\n</code></pre>"},{"location":"es/getting-started/quick-start/#conceptos-clave","title":"Conceptos Clave","text":""},{"location":"es/getting-started/quick-start/#sandbox","title":"Sandbox","text":"<ul> <li>Copia temporal de tu base de datos</li> <li>Lugar seguro para experimentar</li> <li>Puedes aplicar o descartar cambios</li> </ul>"},{"location":"es/getting-started/quick-start/#capas-layers","title":"Capas (Layers)","text":"<ul> <li>Cambios guardados en archivos SQL</li> <li>Numeradas secuencialmente (L001, L002, ...)</li> <li>Se pueden reproducir en cualquier orden</li> </ul>"},{"location":"es/getting-started/quick-start/#estados","title":"Estados","text":"<pre><code>Main DB \u2500\u2500&gt; Sandbox \u2500\u2500&gt; Commit \u2500\u2500&gt; Apply \u2500\u2500&gt; Main DB actualizada\n(estable)   (temporal)  (guardar)  (aplicar)  (con cambios)\n</code></pre>"},{"location":"es/getting-started/quick-start/#comandos-esenciales","title":"Comandos Esenciales","text":"Comando Prop\u00f3sito <code>dbl init</code> Inicializar DBL <code>dbl sandbox start</code> Crear sandbox <code>dbl diff</code> Ver cambios <code>dbl commit -m \"msg\"</code> Guardar cambios <code>dbl sandbox apply</code> Aplicar a principal <code>dbl sandbox rollback</code> Descartar sandbox <code>dbl log</code> Ver historial <code>dbl reset</code> Reconstruir desde capas"},{"location":"es/getting-started/quick-start/#ejemplo-agregar-mas-tablas","title":"Ejemplo: Agregar M\u00e1s Tablas","text":"<p>Ahora que entiendes el flujo, agrega m\u00e1s tablas:</p> <pre><code># Sandbox\ndbl sandbox start\n\n# Posts table\npsql -d myapp_sandbox &lt;&lt; EOF\nCREATE TABLE posts (\n    id SERIAL PRIMARY KEY,\n    user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,\n    title VARCHAR(200) NOT NULL,\n    content TEXT,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE INDEX idx_posts_user_id ON posts(user_id);\nEOF\n\n# Commit\ndbl commit -m \"Add posts table with user relationship\"\n\n# Apply\ndbl sandbox apply\n\n# Verificar historial\ndbl log\n</code></pre> <p>Salida de <code>dbl log</code>: <pre><code>* L002 - Add posts table with user relationship\n  Date: 2024-12-30 10:25:11\n\n* L001 - Add users table\n  Date: 2024-12-30 10:15:33\n</code></pre></p>"},{"location":"es/getting-started/quick-start/#trabajar-en-equipo","title":"Trabajar en Equipo","text":"<p>Comparte tus cambios con el equipo:</p> <pre><code># Guardar capas en Git\ngit add .dbl/\ngit commit -m \"Database: Add users and posts tables\"\ngit push\n\n# Tu equipo puede aplicar los cambios\ngit pull\ndbl reset  # Reconstruye desde las capas\n</code></pre>"},{"location":"es/getting-started/quick-start/#solucion-rapida-de-problemas","title":"Soluci\u00f3n R\u00e1pida de Problemas","text":""},{"location":"es/getting-started/quick-start/#no-active-sandbox","title":"\"No active sandbox\"","text":"<pre><code># Necesitas crear un sandbox primero\ndbl sandbox start\n</code></pre>"},{"location":"es/getting-started/quick-start/#uncommitted-changes-detected","title":"\"Uncommitted changes detected\"","text":"<pre><code># Guarda los cambios primero\ndbl commit -m \"Descripci\u00f3n de cambios\"\n</code></pre>"},{"location":"es/getting-started/quick-start/#error-de-conexion","title":"Error de conexi\u00f3n","text":"<pre><code># Verifica la conexi\u00f3n\npsql -d myapp  # o mysql\n\n# Revisa dbl.yaml\ncat dbl.yaml\n</code></pre>"},{"location":"es/getting-started/quick-start/#proximos-pasos","title":"Pr\u00f3ximos Pasos","text":"<p>Ahora que dominas lo b\u00e1sico:</p> <ol> <li>Tu Primera Migraci\u00f3n - Ejemplo m\u00e1s detallado</li> <li>Comandos - Referencia completa</li> <li>Mejores Pr\u00e1cticas - Patrones recomendados</li> <li>Configuraci\u00f3n - Opciones avanzadas</li> </ol>"},{"location":"es/getting-started/quick-start/#ver-tambien","title":"Ver Tambi\u00e9n","text":"<ul> <li>Instalaci\u00f3n</li> <li>Comandos de Sandbox</li> <li>FAQ</li> </ul>"},{"location":"es/guide/best-practices/","title":"Mejores Pr\u00e1cticas","text":"<p>Patrones y recomendaciones para usar DBL efectivamente en equipos y proyectos.</p>"},{"location":"es/guide/best-practices/#estrategia-de-ramas","title":"Estrategia de Ramas","text":""},{"location":"es/guide/best-practices/#flujo-git-like","title":"Flujo Git-like","text":"<p>Usa patr\u00f3n similar a Git Flow:</p> <pre><code>main (producci\u00f3n)\n  \u251c\u2500 develop (siguiente release)\n  \u2502   \u251c\u2500 feature/auth\n  \u2502   \u251c\u2500 feature/payments\n  \u2502   \u2514\u2500 feature/notifications\n  \u2514\u2500 hotfix/urgent-bug\n</code></pre>"},{"location":"es/guide/best-practices/#nombrado-de-ramas","title":"Nombrado de Ramas","text":"<pre><code># \u2705 Buenos nombres\ndbl branch create feature/user-auth\ndbl branch create feature/payment-integration\ndbl branch create bugfix/null-pointer-error\ndbl branch create hotfix/security-patch\n\n# \u274c Malos nombres\ndbl branch create work\ndbl branch create test\ndbl branch create stuff\n</code></pre>"},{"location":"es/guide/best-practices/#gestion-de-commits","title":"Gesti\u00f3n de Commits","text":""},{"location":"es/guide/best-practices/#commits-atomicos","title":"Commits At\u00f3micos","text":"<p>Cada commit debe ser una unidad l\u00f3gica de cambio:</p> <pre><code># \u2705 Bien: Commit por cambio l\u00f3gico\ndbl commit -m \"Add user authentication table\"\ndbl commit -m \"Add session management tables\"\ndbl commit -m \"Add password reset functionality\"\n\n# \u274c Mal: Todo en un commit\ndbl commit -m \"Add auth, payments, notifications\"\n</code></pre>"},{"location":"es/guide/best-practices/#mensajes-de-commit-claros","title":"Mensajes de Commit Claros","text":"<pre><code># \u2705 Bueno\ndbl commit -m \"Add email verification for user registration\"\n\n# \u2705 Tambi\u00e9n bueno (con descripci\u00f3n)\ndbl commit -m \"Implement two-factor authentication\"\ndbl commit -m \"\nAdd TOTP-based 2FA support\n\n- Create totp_secrets table\n- Add verification endpoint\n- Add backup codes generation\n\"\n\n# \u274c Malo\ndbl commit -m \"stuff\"\ndbl commit -m \"fix\"\n</code></pre>"},{"location":"es/guide/best-practices/#seguridad-en-la-base-de-datos","title":"Seguridad en la Base de Datos","text":""},{"location":"es/guide/best-practices/#capas-separadas-por-sensibilidad","title":"Capas Separadas por Sensibilidad","text":"<pre><code># Crear capas separadas para datos sensibles\ndbl sandbox start\n\n# Capa 1: Estructuras\nCREATE TABLE users (...);\ndbl commit -m \"Create user table structure\"\n\n# Capa 2: Datos de prueba (NO sensibles)\nINSERT INTO users VALUES (...);\ndbl commit -m \"Add test users\"\n\n# Capa 3: \u00cdndices de rendimiento\nCREATE INDEX idx_users_email ON users(email);\ndbl commit -m \"Add performance indexes\"\n</code></pre>"},{"location":"es/guide/best-practices/#nunca-commitear-datos-sensibles","title":"Nunca Commitear Datos Sensibles","text":"<pre><code># \u274c NUNCA hacer esto\nINSERT INTO users VALUES ('admin', 'password123');\ndbl commit -m \"Add admin user\"\n\n# \u2705 Usar variables o archivos externos\nINSERT INTO users VALUES (?, ?);  -- Par\u00e1metros\ndbl commit -m \"Create user schema\"\n</code></pre>"},{"location":"es/guide/best-practices/#rendimiento","title":"Rendimiento","text":""},{"location":"es/guide/best-practices/#optimizar-migraciones-grandes","title":"Optimizar Migraciones Grandes","text":"<p>Para cambios que afectan muchos datos:</p> <pre><code># Usar patr\u00f3n expand-contract\n# Semana 1: Expand (agregar)\ndbl sandbox start\nALTER TABLE users ADD COLUMN email TEXT;\ndbl commit -m \"Expand: Add email column\"\ndbl sandbox apply\n\n# Semana 2: Backfill (llenar datos)\ndbl sandbox start\nUPDATE users SET email = username || '@example.com';\ndbl commit -m \"Backfill: Populate email\"\ndbl sandbox apply\n\n# Semana 3: Contract (aplicar constraints)\ndbl sandbox start\nALTER TABLE users ALTER COLUMN email SET NOT NULL;\ndbl commit -m \"Contract: Require email\"\ndbl sandbox apply\n</code></pre>"},{"location":"es/guide/best-practices/#indices-selectivos","title":"\u00cdndices Selectivos","text":"<pre><code>-- \u2705 Bueno: \u00cdndices en columnas frecuentemente consultadas\nCREATE INDEX idx_users_email ON users(email);\nCREATE INDEX idx_posts_author ON posts(author_id);\n\n-- \u274c Malo: \u00cdndices innecesarios\nCREATE INDEX idx_users_name_created ON users(name, created_at);\n</code></pre>"},{"location":"es/guide/best-practices/#testing","title":"Testing","text":""},{"location":"es/guide/best-practices/#validar-capas-regularmente","title":"Validar Capas Regularmente","text":"<pre><code>#!/bin/bash\n# validate-schema.sh\n\n# Recrear base de datos desde capas\ndbl reset\n\n# Ejecutar tests\npytest tests/database/\n\n# Verificar integridad\ndbl validate --check-schema\n</code></pre>"},{"location":"es/guide/best-practices/#pruebas-de-migracion","title":"Pruebas de Migraci\u00f3n","text":"<pre><code># Crear ambiente de test\ndbl --config test.yaml sandbox start\n\n# Aplicar cambios\ndbl --config test.yaml reset\n\n# Ejecutar tests\npytest tests/migrations/\n\n# Verificar rollback (para MySQL)\ndbl --config test.yaml sandbox rollback\n</code></pre>"},{"location":"es/guide/best-practices/#colaboracion-en-equipo","title":"Colaboraci\u00f3n en Equipo","text":""},{"location":"es/guide/best-practices/#code-review-de-cambios","title":"Code Review de Cambios","text":"<pre><code># Developer abre PR con cambios\n$ dbl log feature/auth\n\n* L025 Add OAuth2 integration\n* L024 Add password reset\n* L023 Create user sessions table\n\n# Reviewer examina cada capa\n$ cat .dbl/layers/L025_*.sql\n# Verificar SQL, performance, seguridad\n\n# Approbar o pedir cambios\n</code></pre>"},{"location":"es/guide/best-practices/#sincronizacion-entre-ramas","title":"Sincronizaci\u00f3n Entre Ramas","text":"<pre><code># Tu rama est\u00e1 atr\u00e1s de main\n$ dbl log main | wc -l\n$ dbl log feature/auth | wc -l\n\n# Actualizar feature desde main\n$ dbl checkout main\n$ dbl pull origin main\n$ dbl checkout feature/auth\n$ dbl merge main\n\n# Ahora feature/auth incluye cambios de main\n</code></pre>"},{"location":"es/guide/best-practices/#resolver-conflictos","title":"Resolver Conflictos","text":"<pre><code># Intentar fusionar\n$ dbl merge feature-payments\nError: Merge conflict\n  Layer L020 modified in both branches\n\n# Resolver manualmente\n$ vim .dbl/layers/L020_*.sql\n# Arreglar conflicto\n\n# Marcar como resuelto\n$ dbl merge --continue\n</code></pre>"},{"location":"es/guide/best-practices/#cicd-integration","title":"CI/CD Integration","text":""},{"location":"es/guide/best-practices/#pipeline-de-validacion","title":"Pipeline de Validaci\u00f3n","text":"<pre><code># .github/workflows/db-validation.yml\nname: Validate Database Changes\n\non:\n  pull_request:\n    paths:\n      - '.dbl/layers/**'\n\njobs:\n  validate:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Checkout code\n        uses: actions/checkout@v3\n\n      - name: Install DBL\n        run: pip install dbl\n\n      - name: Validate layers\n        run: dbl validate --check-layers\n\n      - name: Test schema reset\n        run: dbl reset\n\n      - name: Run tests\n        run: pytest tests/database/\n</code></pre>"},{"location":"es/guide/best-practices/#despliegue-progresivo","title":"Despliegue Progresivo","text":"<pre><code>#!/bin/bash\n# deploy-progressive.sh\n\nLAYERS=$(dbl log --since \"$LAST_DEPLOY\" --oneline)\nCOUNT=$(echo \"$LAYERS\" | wc -l)\n\necho \"Deploying $COUNT layers...\"\n\n# Desplegar a staging primero\ndbl --env staging sandbox apply\n\n# Esperar a validaci\u00f3n\nread -p \"Proceed to production? [y/n]: \" -n 1\n\nif [[ $REPLY =~ ^[Yy]$ ]]; then\n    dbl --env production sandbox apply\nfi\n</code></pre>"},{"location":"es/guide/best-practices/#mantenimiento","title":"Mantenimiento","text":""},{"location":"es/guide/best-practices/#limpiar-ramas-antiguas","title":"Limpiar Ramas Antiguas","text":"<pre><code># Listar ramas\n$ dbl branch --list\n\n# Eliminar ramas mergeadas\n$ dbl branch delete feature/old-auth\n$ dbl branch delete bugfix/resolved-issue\n</code></pre>"},{"location":"es/guide/best-practices/#archivar-cambios","title":"Archivar Cambios","text":"<pre><code># Backup de rama antes de eliminar\n$ git checkout feature/old-feature\n$ git bundle create feature-old.bundle\n$ dbl branch delete feature/old-feature\n</code></pre>"},{"location":"es/guide/best-practices/#documentacion","title":"Documentaci\u00f3n","text":""},{"location":"es/guide/best-practices/#documentar-cambios-de-esquema","title":"Documentar Cambios de Esquema","text":"<pre><code># Crear documento para cada feature\n$ cat &gt; SCHEMA_CHANGES.md &lt;&lt; EOF\n## Feature: OAuth2 Authentication (v2.2.0)\n\n### Cambios de esquema:\n- L025: Tabla oAuth_providers\n- L026: Tabla user_oauth_tokens\n- L027: \u00cdndices para b\u00fasqueda r\u00e1pida\n\n### Cambios de datos:\n- Migraci\u00f3n de passwords (L024)\n\n### Breaking changes:\n- Columna password_hash requerida\n\n### Testing:\n- Ver tests/auth/test_oauth.py\n\n### Rollback:\n- dbl reset --to L024\nEOF\n</code></pre>"},{"location":"es/guide/best-practices/#readme-para-database","title":"README para Database","text":"<pre><code># Database Schema\n\n## Estructura\n\nLa base de datos consta de X tablas principales:\n- users: Informaci\u00f3n de usuarios\n- posts: Art\u00edculos publicados\n- comments: Comentarios en posts\n\n## Cambios Recientes\n\nVer [CHANGELOG.md](../CHANGELOG.md)\n\n## Actualizar Schema\n\n```bash\ndbl sandbox start\ndbl reset\n</code></pre>"},{"location":"es/guide/best-practices/#validar","title":"Validar","text":"<p><pre><code>dbl validate\n</code></pre> <pre><code>## Monitoreo\n\n### Alertas de Cambios\n\n```bash\n#!/bin/bash\n# monitor-schema.sh\n\nLAST_LAYER=$(dbl log --oneline | head -1)\nLAST_FILE=\"/tmp/dbl_last_layer\"\n\nif [ -f \"$LAST_FILE\" ]; then\n    PREVIOUS=$(cat \"$LAST_FILE\")\n    if [ \"$LAST_LAYER\" != \"$PREVIOUS\" ]; then\n        echo \"Schema changed: $LAST_LAYER\" | \\\n        mail -s \"DBL Alert\" team@company.com\n    fi\nfi\n\necho \"$LAST_LAYER\" &gt; \"$LAST_FILE\"\n</code></pre></p>"},{"location":"es/guide/best-practices/#performance-tracking","title":"Performance Tracking","text":"<pre><code>#!/bin/bash\n# track-performance.sh\n\necho \"Layer,Duration\" &gt; migration-times.csv\n\nfor layer in .dbl/layers/*.sql; do\n    START=$(date +%s%N)\n    dbl reset\n    END=$(date +%s%N)\n\n    DURATION=$(( (END - START) / 1000000 ))\n    LAYER=$(basename \"$layer\")\n\n    echo \"$LAYER,$DURATION\" &gt;&gt; migration-times.csv\ndone\n</code></pre>"},{"location":"es/guide/best-practices/#anti-patrones-a-evitar","title":"Anti-patrones a Evitar","text":""},{"location":"es/guide/best-practices/#no-hagas-esto","title":"\u274c No Hagas Esto","text":"<pre><code># Cambios ad-hoc sin capas\n$ psql myapp -c \"ALTER TABLE users DROP COLUMN email;\"\n\n# Datos hardcodeados\nINSERT INTO config VALUES ('api_key', 'secret123');\n\n# Commits demasiado grandes\ndbl commit -m \"Everything: add 50 features\"\n\n# Sin validaci\u00f3n\n# ... cambios sin probar ...\n$ dbl sandbox apply\n\n# Sin backups\ndbl reset  # Sin backup previo\n\n# Ramas sin sincronizar\n$ dbl checkout old-branch\n# (hace semanas sin actualizar)\n</code></pre>"},{"location":"es/guide/best-practices/#proximos-pasos","title":"Pr\u00f3ximos Pasos","text":"<ul> <li>Ramas - Gesti\u00f3n de ramas</li> <li>Configuraci\u00f3n - Setups avanzados</li> <li>Architecture - C\u00f3mo funciona DBL</li> </ul>"},{"location":"es/guide/configuration/","title":"Configuraci\u00f3n","text":"<p>Gu\u00eda completa de configuraci\u00f3n de DBL a trav\u00e9s del archivo <code>dbl.yaml</code>.</p>"},{"location":"es/guide/configuration/#archivo-de-configuracion","title":"Archivo de Configuraci\u00f3n","text":"<p>DBL usa <code>dbl.yaml</code> para toda su configuraci\u00f3n. Este archivo debe estar en la ra\u00edz de tu proyecto.</p>"},{"location":"es/guide/configuration/#configuracion-minima","title":"Configuraci\u00f3n M\u00ednima","text":"<pre><code>database:\n  name: myapp\n  engine: postgres  # o 'mysql'\n  host: localhost\n  port: 5432       # o 3306 para MySQL\n  user: dbuser\n  password: ${DB_PASSWORD}\n</code></pre>"},{"location":"es/guide/configuration/#configuracion-completa","title":"Configuraci\u00f3n Completa","text":"<pre><code># Configuraci\u00f3n de base de datos\ndatabase:\n  name: myapp\n  engine: postgres\n  host: localhost\n  port: 5432\n  user: dbuser\n  password: ${DB_PASSWORD}\n\n  # Opciones del motor\n  options:\n    sslmode: require\n    connect_timeout: 10\n    application_name: dbl\n\n# Configuraci\u00f3n de DBL\ndbl:\n  # Directorio para layers\n  layers_dir: .dbl/layers\n\n  # Rama por defecto\n  default_branch: main\n\n  # Prefijo para sandbox\n  sandbox_prefix: sandbox_\n\n  # Validaci\u00f3n\n  validation:\n    strict: false\n    check_syntax: true\n\n# Logging\nlogging:\n  level: info  # debug, info, warning, error\n  file: .dbl/dbl.log\n</code></pre>"},{"location":"es/guide/configuration/#configuracion-de-base-de-datos","title":"Configuraci\u00f3n de Base de Datos","text":""},{"location":"es/guide/configuration/#campos-requeridos","title":"Campos Requeridos","text":"Campo Descripci\u00f3n Ejemplo <code>name</code> Nombre de la base de datos <code>myapp</code> <code>engine</code> Motor de BD <code>postgres</code>, <code>mysql</code> <code>host</code> Host de la BD <code>localhost</code> <code>port</code> Puerto <code>5432</code>, <code>3306</code> <code>user</code> Usuario de BD <code>dbuser</code> <code>password</code> Contrase\u00f1a <code>${DB_PASSWORD}</code>"},{"location":"es/guide/configuration/#variables-de-entorno","title":"Variables de Entorno","text":"<p>Usa variables de entorno para credenciales sensibles:</p> <pre><code>database:\n  name: ${DB_NAME}\n  user: ${DB_USER}\n  password: ${DB_PASSWORD}\n  host: ${DB_HOST:-localhost}  # valor por defecto\n  port: ${DB_PORT:-5432}\n</code></pre> <pre><code># Exportar variables\nexport DB_NAME=myapp\nexport DB_USER=dbuser\nexport DB_PASSWORD=secreto\n</code></pre>"},{"location":"es/guide/configuration/#postgresql","title":"PostgreSQL","text":"<pre><code>database:\n  name: myapp\n  engine: postgres\n  host: localhost\n  port: 5432\n  user: postgres\n  password: ${DB_PASSWORD}\n\n  # Opciones espec\u00edficas de PostgreSQL\n  options:\n    sslmode: require\n    sslrootcert: /path/to/ca.crt\n    connect_timeout: 10\n    application_name: dbl\n\n    # Pool de conexiones\n    pool_size: 10\n    max_overflow: 20\n</code></pre>"},{"location":"es/guide/configuration/#mysql","title":"MySQL","text":"<pre><code>database:\n  name: myapp\n  engine: mysql\n  host: localhost\n  port: 3306\n  user: root\n  password: ${DB_PASSWORD}\n\n  # Opciones espec\u00edficas de MySQL\n  options:\n    charset: utf8mb4\n    ssl_ca: /path/to/ca.pem\n    connect_timeout: 10\n\n    # Pool de conexiones\n    pool_size: 10\n    pool_recycle: 3600\n</code></pre>"},{"location":"es/guide/configuration/#configuracion-por-entorno","title":"Configuraci\u00f3n por Entorno","text":""},{"location":"es/guide/configuration/#desarrollo","title":"Desarrollo","text":"<pre><code># dbl.dev.yaml\ndatabase:\n  name: myapp_dev\n  host: localhost\n  user: dev_user\n  password: ${DEV_PASSWORD}\n\ndbl:\n  validation:\n    strict: false\n\nlogging:\n  level: debug\n</code></pre>"},{"location":"es/guide/configuration/#staging","title":"Staging","text":"<pre><code># dbl.staging.yaml\ndatabase:\n  name: myapp_staging\n  host: staging-db.example.com\n  user: staging_user\n  password: ${STAGING_PASSWORD}\n\n  options:\n    sslmode: require\n\ndbl:\n  validation:\n    strict: true\n\nlogging:\n  level: info\n</code></pre>"},{"location":"es/guide/configuration/#produccion","title":"Producci\u00f3n","text":"<pre><code># dbl.production.yaml\ndatabase:\n  name: myapp_production\n  host: prod-db.example.com\n  user: prod_user\n  password: ${PROD_PASSWORD}\n\n  options:\n    sslmode: require\n    connect_timeout: 30\n\ndbl:\n  validation:\n    strict: true\n    check_syntax: true\n\nlogging:\n  level: warning\n  file: /var/log/dbl/production.log\n</code></pre>"},{"location":"es/guide/configuration/#usar-configuracion-especifica","title":"Usar Configuraci\u00f3n Espec\u00edfica","text":"<pre><code># Desarrollo (por defecto: dbl.yaml)\ndbl sandbox start\n\n# Staging\ndbl --config dbl.staging.yaml sandbox start\n\n# Producci\u00f3n\ndbl --config dbl.production.yaml sandbox apply\n</code></pre>"},{"location":"es/guide/configuration/#configuracion-de-dbl","title":"Configuraci\u00f3n de DBL","text":""},{"location":"es/guide/configuration/#directorios","title":"Directorios","text":"<pre><code>dbl:\n  # Directorio base\n  base_dir: .dbl\n\n  # Subdirectorios\n  layers_dir: .dbl/layers\n  branches_dir: .dbl/branches\n  temp_dir: .dbl/temp\n</code></pre>"},{"location":"es/guide/configuration/#ramas","title":"Ramas","text":"<pre><code>dbl:\n  # Rama por defecto\n  default_branch: main\n\n  # Prefijo para ramas de feature\n  feature_prefix: feature/\n\n  # Prefijo para hotfixes\n  hotfix_prefix: hotfix/\n</code></pre>"},{"location":"es/guide/configuration/#sandbox","title":"Sandbox","text":"<pre><code>dbl:\n  # Prefijo de nombre para sandboxes\n  sandbox_prefix: sandbox_\n\n  # Sufijo de nombre\n  sandbox_suffix: _dev\n\n  # Resultado: myapp_sandbox_dev\n</code></pre>"},{"location":"es/guide/configuration/#validacion","title":"Validaci\u00f3n","text":"<pre><code>dbl:\n  validation:\n    # Modo estricto\n    strict: false\n\n    # Validar sintaxis SQL\n    check_syntax: true\n\n    # Validar nombres de tablas\n    table_naming: snake_case  # snake_case, camelCase\n\n    # Validar nombres de columnas\n    column_naming: snake_case\n\n    # Requerir comentarios\n    require_comments: false\n</code></pre>"},{"location":"es/guide/configuration/#logging","title":"Logging","text":""},{"location":"es/guide/configuration/#configuracion-de-logs","title":"Configuraci\u00f3n de Logs","text":"<pre><code>logging:\n  # Nivel: debug, info, warning, error\n  level: info\n\n  # Archivo de log\n  file: .dbl/dbl.log\n\n  # Formato\n  format: \"[{timestamp}] {level}: {message}\"\n\n  # Rotaci\u00f3n\n  rotation:\n    max_size: 10485760  # 10MB\n    backup_count: 5\n</code></pre>"},{"location":"es/guide/configuration/#niveles-de-log","title":"Niveles de Log","text":"Nivel Descripci\u00f3n Uso <code>debug</code> Informaci\u00f3n detallada Desarrollo <code>info</code> Informaci\u00f3n general Producci\u00f3n <code>warning</code> Advertencias Producci\u00f3n <code>error</code> Solo errores Producci\u00f3n cr\u00edtica"},{"location":"es/guide/configuration/#configuracion-avanzada","title":"Configuraci\u00f3n Avanzada","text":""},{"location":"es/guide/configuration/#hooks-futuro","title":"Hooks (Futuro)","text":"<pre><code>hooks:\n  # Antes de commit\n  pre_commit:\n    - validate_naming\n    - check_migrations\n\n  # Despu\u00e9s de apply\n  post_apply:\n    - notify_team\n    - update_docs\n</code></pre>"},{"location":"es/guide/configuration/#plantillas","title":"Plantillas","text":"<pre><code>templates:\n  # Plantilla de layer\n  layer_header: |\n    -- Layer: {layer_id}\n    -- Message: {message}\n    -- Date: {date}\n    -- Author: {author}\n\n  # Plantilla de commit\n  commit_message: |\n    Database: {message}\n\n    Layer: {layer_id}\n    Tables: {tables}\n</code></pre>"},{"location":"es/guide/configuration/#exclusiones","title":"Exclusiones","text":"<pre><code>dbl:\n  # Ignorar tablas\n  ignore_tables:\n    - django_migrations\n    - django_session\n    - _temp_*\n\n  # Ignorar esquemas\n  ignore_schemas:\n    - information_schema\n    - pg_catalog\n</code></pre>"},{"location":"es/guide/configuration/#configuracion-de-testing","title":"Configuraci\u00f3n de Testing","text":"<pre><code># dbl.test.yaml\ndatabase:\n  name: myapp_test\n  host: localhost\n  user: test_user\n  password: test_password\n\ndbl:\n  # Limpiar despu\u00e9s de tests\n  auto_cleanup: true\n\n  # Seed data\n  seed_data: tests/fixtures/seed.sql\n</code></pre>"},{"location":"es/guide/configuration/#multiples-bases-de-datos","title":"M\u00faltiples Bases de Datos","text":"<pre><code># Configuraci\u00f3n principal\ndatabase:\n  name: myapp\n  # ... config ...\n\n# Bases adicionales\ndatabases:\n  analytics:\n    name: myapp_analytics\n    host: analytics-db.example.com\n    # ... config ...\n\n  cache:\n    name: myapp_cache\n    engine: mysql\n    # ... config ...\n</code></pre> <pre><code># Usar base espec\u00edfica\ndbl --database analytics sandbox start\n</code></pre>"},{"location":"es/guide/configuration/#variables-y-secretos","title":"Variables y Secretos","text":""},{"location":"es/guide/configuration/#archivo-env","title":"Archivo .env","text":"<pre><code># .env\nDB_HOST=localhost\nDB_PORT=5432\nDB_NAME=myapp\nDB_USER=dbuser\nDB_PASSWORD=secreto\n</code></pre> <pre><code># dbl.yaml\ndatabase:\n  name: ${DB_NAME}\n  host: ${DB_HOST}\n  port: ${DB_PORT}\n  user: ${DB_USER}\n  password: ${DB_PASSWORD}\n</code></pre>"},{"location":"es/guide/configuration/#gestores-de-secretos","title":"Gestores de Secretos","text":""},{"location":"es/guide/configuration/#aws-secrets-manager","title":"AWS Secrets Manager","text":"<pre><code>database:\n  password: ${AWS_SECRET:myapp/db/password}\n</code></pre>"},{"location":"es/guide/configuration/#hashicorp-vault","title":"HashiCorp Vault","text":"<pre><code>database:\n  password: ${VAULT:secret/myapp/db#password}\n</code></pre>"},{"location":"es/guide/configuration/#validacion-de-configuracion","title":"Validaci\u00f3n de Configuraci\u00f3n","text":"<pre><code># Validar configuraci\u00f3n\ndbl validate --config\n\n# Ver configuraci\u00f3n actual\ndbl config show\n\n# Probar conexi\u00f3n\ndbl config test\n</code></pre>"},{"location":"es/guide/configuration/#mejores-practicas","title":"Mejores Pr\u00e1cticas","text":""},{"location":"es/guide/configuration/#1-no-commitear-contrasenas","title":"1. No Commitear Contrase\u00f1as","text":"<pre><code># \u2705 Correcto\npassword: ${DB_PASSWORD}\n\n# \u274c Incorrecto\npassword: mi_password_secreta\n</code></pre>"},{"location":"es/guide/configuration/#2-usar-archivos-por-entorno","title":"2. Usar Archivos por Entorno","text":"<pre><code>project/\n\u251c\u2500\u2500 dbl.yaml           # Desarrollo\n\u251c\u2500\u2500 dbl.staging.yaml   # Staging\n\u2514\u2500\u2500 dbl.production.yaml # Producci\u00f3n\n</code></pre>"},{"location":"es/guide/configuration/#3-versionado-en-git","title":"3. Versionado en Git","text":"<pre><code># .gitignore\ndbl.yaml           # No commitear desarrollo\ndbl.*.local.yaml   # Configuraciones locales\n.env               # Variables de entorno\n\n# S\u00ed commitear\ndbl.*.yaml.example # Ejemplos\ndbl.production.yaml # Producci\u00f3n (sin secretos)\n</code></pre>"},{"location":"es/guide/configuration/#4-documentar-configuracion","title":"4. Documentar Configuraci\u00f3n","text":"<pre><code># dbl.yaml.example\ndatabase:\n  name: myapp\n  engine: postgres  # o 'mysql'\n  host: localhost\n  port: 5432\n  user: dbuser\n  password: ${DB_PASSWORD}  # Configurar en .env\n</code></pre>"},{"location":"es/guide/configuration/#ejemplo-completo","title":"Ejemplo Completo","text":"<pre><code># dbl.yaml - Configuraci\u00f3n completa\ndatabase:\n  # Conexi\u00f3n\n  name: ${DB_NAME:-myapp}\n  engine: postgres\n  host: ${DB_HOST:-localhost}\n  port: ${DB_PORT:-5432}\n  user: ${DB_USER:-dbuser}\n  password: ${DB_PASSWORD}\n\n  # Opciones\n  options:\n    sslmode: ${DB_SSLMODE:-prefer}\n    connect_timeout: 10\n    application_name: dbl\n    pool_size: 10\n\n# Configuraci\u00f3n DBL\ndbl:\n  # Directorios\n  base_dir: .dbl\n  layers_dir: .dbl/layers\n\n  # Ramas\n  default_branch: main\n\n  # Sandbox\n  sandbox_prefix: \"\"\n  sandbox_suffix: _sandbox\n\n  # Validaci\u00f3n\n  validation:\n    strict: false\n    check_syntax: true\n    table_naming: snake_case\n\n  # Ignorar\n  ignore_tables:\n    - _*\n    - temp_*\n\n# Logging\nlogging:\n  level: ${LOG_LEVEL:-info}\n  file: .dbl/dbl.log\n  format: \"[{timestamp}] {level}: {message}\"\n</code></pre>"},{"location":"es/guide/configuration/#ver-tambien","title":"Ver Tambi\u00e9n","text":"<ul> <li>Inicio R\u00e1pido</li> <li>Mejores Pr\u00e1cticas</li> <li>Motores de BD</li> <li>FAQ</li> </ul>"},{"location":"es/reference/faq/","title":"FAQ","text":"<p>Preguntas frecuentes sobre DBL.</p>"},{"location":"es/reference/faq/#general","title":"General","text":""},{"location":"es/reference/faq/#que-es-dbl","title":"\u00bfQu\u00e9 es DBL?","text":"<p>DBL (Database Layering) es una herramienta de control de versiones para bases de datos, similar a Git pero para esquemas de bases de datos.</p>"},{"location":"es/reference/faq/#necesito-git","title":"\u00bfNecesito Git?","text":"<p>No es obligatorio pero se recomienda. DBL puede trabajar solo, pero Git ayuda con colaboraci\u00f3n y auditor\u00eda.</p>"},{"location":"es/reference/faq/#funciona-con-mi-base-de-datos","title":"\u00bfFunciona con mi base de datos?","text":"<p>DBL soporta: - \u2705 PostgreSQL 11+ - \u2705 MySQL 5.7+ - \ud83d\udd04 MariaDB (pr\u00f3ximamente) - \ud83d\udd04 SQLite (en desarrollo)</p>"},{"location":"es/reference/faq/#es-gratuito","title":"\u00bfEs gratuito?","text":"<p>S\u00ed, DBL es open source bajo licencia Apache 2.0.</p>"},{"location":"es/reference/faq/#instalacion","title":"Instalaci\u00f3n","text":""},{"location":"es/reference/faq/#como-instalo-dbl","title":"\u00bfC\u00f3mo instalo DBL?","text":"<pre><code>pip install dbl\n</code></pre> <p>Requiere Python 3.7+.</p>"},{"location":"es/reference/faq/#tengo-que-instalar-dependencias-de-bd","title":"\u00bfTengo que instalar dependencias de BD?","text":"<p>No. DBL los instala autom\u00e1ticamente si faltan: - <code>psycopg2</code> para PostgreSQL - <code>mysql-connector-python</code> para MySQL</p>"},{"location":"es/reference/faq/#que-version-de-python","title":"\u00bfQu\u00e9 versi\u00f3n de Python?","text":"<p>Python 3.7 o mayor. Probado en 3.7, 3.8, 3.9, 3.10, 3.11.</p>"},{"location":"es/reference/faq/#configuracion","title":"Configuraci\u00f3n","text":""},{"location":"es/reference/faq/#donde-va-el-archivo-de-configuracion","title":"\u00bfD\u00f3nde va el archivo de configuraci\u00f3n?","text":"<p>El archivo <code>dbl.yaml</code> va en la ra\u00edz del proyecto:</p> <pre><code>mi-proyecto/\n\u251c\u2500\u2500 dbl.yaml      \u2190 Aqu\u00ed\n\u251c\u2500\u2500 .dbl/\n\u251c\u2500\u2500 README.md\n\u2514\u2500\u2500 ...\n</code></pre>"},{"location":"es/reference/faq/#puedo-tener-multiples-archivos-de-config","title":"\u00bfPuedo tener m\u00faltiples archivos de config?","text":"<p>S\u00ed:</p> <pre><code>dbl --config production.yaml init\ndbl --config staging.yaml reset\ndbl --config development.yaml sandbox start\n</code></pre>"},{"location":"es/reference/faq/#como-protejo-mis-credenciales","title":"\u00bfC\u00f3mo protejo mis credenciales?","text":"<p>Usa variables de ambiente:</p> <pre><code>engine: postgres\ndatabase:\n  host: ${DB_HOST}\n  user: ${DB_USER}\n  password: ${DB_PASSWORD}\n</code></pre> <pre><code>export DB_HOST=prod.example.com\nexport DB_USER=admin\nexport DB_PASSWORD=secret\ndbl init\n</code></pre>"},{"location":"es/reference/faq/#sandbox","title":"Sandbox","text":""},{"location":"es/reference/faq/#que-es-el-sandbox","title":"\u00bfQu\u00e9 es el sandbox?","text":"<p>Una copia temporal de tu base de datos donde experimentar cambios sin afectar la principal.</p>"},{"location":"es/reference/faq/#el-sandbox-copia-datos","title":"\u00bfEl sandbox copia datos?","text":"<p>Solo el esquema (estructura). No los datos de producci\u00f3n por defecto.</p> <p>Para incluir datos:</p> <pre><code>dbl sandbox start --copy-data\n</code></pre>"},{"location":"es/reference/faq/#donde-se-crea-el-sandbox","title":"\u00bfD\u00f3nde se crea el sandbox?","text":"<p>En el mismo servidor/motor, con nombre <code>{database}_sandbox</code>.</p> <p>Ejemplo: - Principal: <code>myapp</code> - Sandbox: <code>myapp_sandbox</code></p>"},{"location":"es/reference/faq/#cuanto-espacio-ocupa","title":"\u00bfCu\u00e1nto espacio ocupa?","text":"<p>Igual al esquema de la BD principal. Si copias datos, igual a la BD completa.</p>"},{"location":"es/reference/faq/#puedo-ejecutar-multiples-sandboxes","title":"\u00bfPuedo ejecutar m\u00faltiples sandboxes?","text":"<p>Por el momento, un sandbox activo por rama. Se pueden crear en diferentes ramas simult\u00e1neamente.</p>"},{"location":"es/reference/faq/#commits-y-capas","title":"Commits y Capas","text":""},{"location":"es/reference/faq/#cuando-debo-hacer-commit","title":"\u00bfCu\u00e1ndo debo hacer commit?","text":"<p>Despu\u00e9s de completar un cambio l\u00f3gico:</p> <pre><code>dbl commit -m \"Add user authentication\"\ndbl commit -m \"Optimize search indexes\"\ndbl commit -m \"Add payment processing\"\n</code></pre>"},{"location":"es/reference/faq/#puedo-deshacer-un-commit","title":"\u00bfPuedo deshacer un commit?","text":"<p>S\u00ed, de varias formas:</p> <pre><code># Rollback del sandbox (cambios sin guardar)\ndbl sandbox rollback\n\n# Resetear base a punto anterior\ndbl reset  # Reconstruir desde capas\n\n# Eliminar capa (avanzado)\nrm .dbl/layers/L015_*.sql\n</code></pre>"},{"location":"es/reference/faq/#que-tamano-deben-tener-las-capas","title":"\u00bfQu\u00e9 tama\u00f1o deben tener las capas?","text":"<p>Preferiblemente peque\u00f1as y l\u00f3gicas. Una tabla, un \u00edndice, una migraci\u00f3n de datos.</p> <p>No: <pre><code>L001 - Crear 50 tablas, 100 \u00edndices, cargar datos\n</code></pre></p> <p>Mejor: <pre><code>L001 - Crear tabla users\nL002 - Crear tabla posts\nL003 - Crear \u00edndices en users\n</code></pre></p>"},{"location":"es/reference/faq/#ramas","title":"Ramas","text":""},{"location":"es/reference/faq/#cuando-debo-crear-rama","title":"\u00bfCu\u00e1ndo debo crear rama?","text":"<p>Cuando trabajas en feature que toma tiempo o quer\u00e9s aislar del trabajo principal.</p> <pre><code>dbl branch create feature/payment\ndbl checkout feature/payment\n# ... desarrollo ...\ndbl checkout main\ndbl merge feature/payment\n</code></pre>"},{"location":"es/reference/faq/#puedo-eliminar-rama","title":"\u00bfPuedo eliminar rama?","text":"<p>S\u00ed, despu\u00e9s de fusionar:</p> <pre><code>dbl branch delete feature/payment\n</code></pre>"},{"location":"es/reference/faq/#que-pasa-si-tengo-cambios-sin-fusionar","title":"\u00bfQu\u00e9 pasa si tengo cambios sin fusionar?","text":"<p>DBL te avisa. Debes fusionar o descartar antes de continuar.</p>"},{"location":"es/reference/faq/#validacion","title":"Validaci\u00f3n","text":""},{"location":"es/reference/faq/#por-que-validar","title":"\u00bfPor qu\u00e9 validar?","text":"<p>Para asegurar que: - Todas las capas funcionan - Esquema est\u00e1 limpio - No hay problemas antes de deploy</p> <pre><code>dbl validate --check-layers\n</code></pre>"},{"location":"es/reference/faq/#que-hace-exactamente","title":"\u00bfQu\u00e9 hace exactamente?","text":"<p>Verifica: - \u2705 Sintaxis SQL correcta - \u2705 Capas pueden ejecutarse - \u2705 No hay conflictos - \u2705 Integridad referencial</p>"},{"location":"es/reference/faq/#cuando-debo-validar","title":"\u00bfCu\u00e1ndo debo validar?","text":"<p>Frecuentemente, especialmente: - Antes de Push a Git - Antes de deploy a Staging - Antes de deploy a Producci\u00f3n</p>"},{"location":"es/reference/faq/#performance","title":"Performance","text":""},{"location":"es/reference/faq/#cuanto-tarda-un-reset","title":"\u00bfCu\u00e1nto tarda un reset?","text":"<p>Depende de tama\u00f1o de BD: - Peque\u00f1a (100MB): &lt;1 segundo - Mediana (1GB): 5-10 segundos - Grande (10GB+): 1-5 minutos</p>"},{"location":"es/reference/faq/#como-optimizar-resets","title":"\u00bfC\u00f3mo optimizar resets?","text":"<ul> <li>Usar \u00edndices apropiados</li> <li>Evitar datos enormes en migrations</li> <li>Usar patr\u00f3n expand-contract para cambios grandes</li> </ul>"},{"location":"es/reference/faq/#pueden-afectar-commits-el-rendimiento","title":"\u00bfPueden afectar commits el rendimiento?","text":"<p>No. Los commits solo guardan SQL, no afectan performance.</p>"},{"location":"es/reference/faq/#produccion","title":"Producci\u00f3n","text":""},{"location":"es/reference/faq/#es-dbl-para-produccion","title":"\u00bfEs DBL para producci\u00f3n?","text":"<p>S\u00ed, pero con cuidado:</p> <pre><code># NUNCA en producci\u00f3n sin backup\npg_dump myapp &gt; backup.sql\ndbl sandbox apply\n</code></pre>"},{"location":"es/reference/faq/#como-es-el-flujo-a-produccion","title":"\u00bfC\u00f3mo es el flujo a producci\u00f3n?","text":"<pre><code>1. Desarrollo: dbl sandbox apply en dev\n2. Testing: dbl reset en ambiente test\n3. Staging: dbl sandbox apply en staging\n4. Producci\u00f3n: dbl sandbox apply en producci\u00f3n (con backup)\n</code></pre>"},{"location":"es/reference/faq/#puede-causar-downtime","title":"\u00bfPuede causar downtime?","text":"<p>Algunas operaciones pueden bloquear tablas brevemente. Planifica en horarios de bajo uso.</p>"},{"location":"es/reference/faq/#hay-rollback","title":"\u00bfHay rollback?","text":"<p>No autom\u00e1tico. Por eso: 1. Hacer backup antes 2. Testear en staging 3. Aplicar en ventana de mantenimiento</p>"},{"location":"es/reference/faq/#seguridad","title":"Seguridad","text":""},{"location":"es/reference/faq/#se-guardan-passwords","title":"\u00bfSe guardan passwords?","text":"<p>No en capas. Las capas contienen SQL, no credenciales.</p> <p>Malo: <pre><code>INSERT INTO admins VALUES ('admin', 'password123');\n</code></pre></p> <p>Bueno: <pre><code>-- Password viene de SQL script separado\n-- O variable de ambiente\n</code></pre></p>"},{"location":"es/reference/faq/#puedo-ocultar-cambios-sensibles","title":"\u00bfPuedo ocultar cambios sensibles?","text":"<p>Usar archivos separados:</p> <pre><code># En .gitignore\necho \"secrets.sql\" &gt;&gt; .gitignore\n\n# Aplicar por separado\ndbl sandbox start\npsql -d myapp_sandbox &lt; secrets.sql\ndbl commit -m \"Run secrets migration\"\n</code></pre>"},{"location":"es/reference/faq/#quien-puede-ver-el-historial-de-cambios","title":"\u00bfQui\u00e9n puede ver el historial de cambios?","text":"<p>Toda persona con acceso a <code>.dbl/layers/</code>. Es recomendable:</p> <pre><code>chmod 600 .dbl/config.yaml\nchmod 700 .dbl/layers/\n</code></pre>"},{"location":"es/reference/faq/#troubleshooting","title":"Troubleshooting","text":""},{"location":"es/reference/faq/#dbl-no-encuentra-la-bd","title":"\u00bfDbl no encuentra la BD?","text":"<p>Verifica configuraci\u00f3n:</p> <pre><code>dbl --verbose init\n# Muestra detalles de conexi\u00f3n\n</code></pre>"},{"location":"es/reference/faq/#sandbox-no-se-elimina","title":"\u00bfSandbox no se elimina?","text":"<p>Limpiar manualmente:</p> <pre><code>psql -c \"DROP DATABASE myapp_sandbox;\"\nrm .dbl/sandbox.json\n</code></pre>"},{"location":"es/reference/faq/#merge-tiene-conflictos","title":"\u00bfMerge tiene conflictos?","text":"<p>Ver archivo de conflicto y resolver:</p> <pre><code># DBL indica qu\u00e9 archivo tiene conflicto\n# Editar manualmente\nvim .dbl/layers/L020_*.sql\n\n# Marcar como resuelto\ndbl merge --continue\n</code></pre>"},{"location":"es/reference/faq/#integracion","title":"Integraci\u00f3n","text":""},{"location":"es/reference/faq/#funciona-con-docker","title":"\u00bfFunciona con Docker?","text":"<p>S\u00ed:</p> <pre><code>FROM python:3.9\nRUN pip install dbl\nRUN dbl init\nRUN dbl reset\n</code></pre>"},{"location":"es/reference/faq/#funciona-con-cicd","title":"\u00bfFunciona con CI/CD?","text":"<p>S\u00ed, perfecto para pipelines:</p> <pre><code>- name: Test migrations\n  run: dbl reset &amp;&amp; pytest tests/\n</code></pre>"},{"location":"es/reference/faq/#funciona-con-orms","title":"\u00bfFunciona con ORMs?","text":"<p>S\u00ed. DBL maneja esquema, ORM maneja datos:</p> <pre><code># DBL: cambios de esquema\ndbl sandbox start\n# ... cambios BD ...\ndbl commit -m \"Add users table\"\ndbl sandbox apply\n\n# ORM: migraci\u00f3n de datos\n# ... c\u00f3digo ORM ...\n</code></pre>"},{"location":"es/reference/faq/#comparaciones","title":"Comparaciones","text":""},{"location":"es/reference/faq/#dbl-vs-flyway","title":"DBL vs Flyway","text":"<pre><code>Flyway:\n- \u2705 Java-centric\n- \u274c SQL sin versionado\n- \u274c Sin sandbox\n\nDBL:\n- \u2705 Language-agnostic\n- \u2705 SQL con versionado Git\n- \u2705 Sandbox para seguridad\n</code></pre>"},{"location":"es/reference/faq/#dbl-vs-liquibase","title":"DBL vs Liquibase","text":"<pre><code>Liquibase:\n- \u2705 Muy flexible\n- \u274c Complejo de aprender\n- \u274c XML/YAML en lugar de SQL\n\nDBL:\n- \u2705 Simple: puro SQL\n- \u2705 F\u00e1cil de aprender\n- \u2705 Git-like familiar\n</code></pre>"},{"location":"es/reference/faq/#dbl-vs-orm-migrations","title":"DBL vs ORM Migrations","text":"<pre><code>ORM (Alembic, Django):\n- \u2705 Integrado\n- \u274c Acoplado a framework\n- \u274c Lenguaje espec\u00edfico\n\nDBL:\n- \u2705 Independiente\n- \u2705 Cualquier framework\n- \u2705 SQL puro\n</code></pre>"},{"location":"es/reference/faq/#proximos-pasos","title":"Pr\u00f3ximos Pasos","text":"<ul> <li>Gu\u00eda de inicio</li> <li>Troubleshooting</li> <li>Contact us</li> </ul>"},{"location":"es/reference/troubleshooting/","title":"Troubleshooting","text":"<p>Soluciones para problemas comunes con DBL.</p>"},{"location":"es/reference/troubleshooting/#instalacion","title":"Instalaci\u00f3n","text":""},{"location":"es/reference/troubleshooting/#pip-command-not-found","title":"<code>pip: command not found</code>","text":"<p>Problema: <pre><code>pip: command not found\n</code></pre></p> <p>Soluciones:</p> <ol> <li> <p>Instalar Python 3: <pre><code># macOS\nbrew install python3\n\n# Ubuntu/Debian\nsudo apt-get install python3-pip\n\n# Windows\n# Descargar desde https://python.org\n</code></pre></p> </li> <li> <p>Usar <code>pip3</code> en lugar de <code>pip</code>: <pre><code>pip3 install dbl\n</code></pre></p> </li> <li> <p>Usar <code>python -m pip</code>: <pre><code>python -m pip install dbl\n</code></pre></p> </li> </ol>"},{"location":"es/reference/troubleshooting/#python-version-too-old","title":"<code>Python version too old</code>","text":"<p>Problema: <pre><code>Error: DBL requires Python 3.7+\nCurrent version: 3.6.9\n</code></pre></p> <p>Soluci\u00f3n:</p> <p>Actualizar Python a 3.7 o mayor:</p> <pre><code># macOS\nbrew install python3\n\n# Ubuntu\nsudo apt-get install python3.9 python3.9-dev\n\n# Windows\n# Descargar desde https://python.org (marca \"Add to PATH\")\n</code></pre>"},{"location":"es/reference/troubleshooting/#psycopg2-installation-failed","title":"<code>psycopg2 installation failed</code>","text":"<p>Problema: <pre><code>error: could not create '/usr/lib/python3/dist-packages/psycopg2'\n</code></pre></p> <p>Soluciones:</p> <ol> <li> <p>Instalar dependencias de sistema: <pre><code># Ubuntu/Debian\nsudo apt-get install python3-dev libpq-dev\n\n# macOS\nbrew install postgresql\n</code></pre></p> </li> <li> <p>Usar versi\u00f3n precompilada: <pre><code>pip install psycopg2-binary\n</code></pre></p> </li> <li> <p>DBL lo instala autom\u00e1ticamente: <pre><code>dbl update\n</code></pre></p> </li> </ol>"},{"location":"es/reference/troubleshooting/#conexion-a-base-de-datos","title":"Conexi\u00f3n a Base de Datos","text":""},{"location":"es/reference/troubleshooting/#could-not-connect-to-server","title":"<code>could not connect to server</code>","text":"<p>Problema: <pre><code>Error: could not connect to server: Connection refused\nIs the server running on host \"localhost\" (127.0.0.1) and accepting\nTCP connections on port 5432?\n</code></pre></p> <p>Checklist:</p> <ol> <li> <p>\u00bfServidor est\u00e1 corriendo? <pre><code># PostgreSQL\npsql -U postgres -c \"SELECT version();\"\n\n# MySQL\nmysql -u root -p -e \"SELECT VERSION();\"\n</code></pre></p> </li> <li> <p>\u00bfPuerto correcto? <pre><code># Verificar puerto\ndbl --verbose init\n\n# En config\ncat dbl.yaml\n</code></pre></p> </li> <li> <p>\u00bfCredenciales correctas? <pre><code># Probar conexi\u00f3n manualmente\npsql -h localhost -U myuser -d mydb\n</code></pre></p> </li> <li> <p>\u00bfFirewall bloqueando? <pre><code># Verificar puerto abierto\nnetstat -an | grep 5432\n</code></pre></p> </li> </ol>"},{"location":"es/reference/troubleshooting/#authentication-failed-for-user","title":"<code>authentication failed for user</code>","text":"<p>Problema: <pre><code>Error: FATAL: password authentication failed for user \"postgres\"\n</code></pre></p> <p>Soluciones:</p> <ol> <li> <p>Verificar password: <pre><code># PostgreSQL, resetear password\nsudo -u postgres psql -c \"ALTER USER postgres WITH PASSWORD 'newpassword';\"\n</code></pre></p> </li> <li> <p>Archivo .pgpass (PostgreSQL): <pre><code># ~/.pgpass\nlocalhost:5432:mydb:myuser:mypassword\n\nchmod 600 ~/.pgpass\n</code></pre></p> </li> <li> <p>Usar variables de ambiente: <pre><code>export PGPASSWORD=\"mypassword\"\ndbl init\n\n# MySQL\nexport MYSQL_PWD=\"mypassword\"\n</code></pre></p> </li> </ol>"},{"location":"es/reference/troubleshooting/#database-does-not-exist","title":"<code>database does not exist</code>","text":"<p>Problema: <pre><code>Error: database \"myapp\" does not exist\n</code></pre></p> <p>Soluciones:</p> <ol> <li> <p>Crear base de datos primero: <pre><code># PostgreSQL\ncreatedb myapp\n\n# MySQL\nmysql -u root -p -e \"CREATE DATABASE myapp;\"\n</code></pre></p> </li> <li> <p>Verificar nombre en config: <pre><code>cat dbl.yaml | grep database\n</code></pre></p> </li> <li> <p>Crear con DBL: <pre><code>dbl init --auto-create\n</code></pre></p> </li> </ol>"},{"location":"es/reference/troubleshooting/#sandbox","title":"Sandbox","text":""},{"location":"es/reference/troubleshooting/#sandbox-database-already-exists","title":"<code>sandbox database already exists</code>","text":"<p>Problema: <pre><code>Error: Sandbox myapp_sandbox already exists\n</code></pre></p> <p>Soluciones:</p> <ol> <li> <p>Limpiar sandbox: <pre><code>dbl sandbox rollback\n</code></pre></p> </li> <li> <p>Limpiar manualmente: <pre><code># PostgreSQL\ndropdb myapp_sandbox\n\n# MySQL\nmysql -u root -p -e \"DROP DATABASE myapp_sandbox;\"\n</code></pre></p> </li> <li> <p>Editar estado: <pre><code>rm .dbl/sandbox.json\n</code></pre></p> </li> </ol>"},{"location":"es/reference/troubleshooting/#sandbox-already-created-pero-no-veo-cambios","title":"<code>sandbox already created</code> pero no veo cambios","text":"<p>Problema: <pre><code>$ dbl sandbox status\nActive Sandbox: myapp_sandbox\nStatus: Empty sandbox (no changes)\n\n# Pero hice cambios...\n</code></pre></p> <p>Soluciones:</p> <ol> <li> <p>Verificar que los cambios se guardaron: <pre><code># Ver cambios en BD\n$ dbl diff\n</code></pre></p> </li> <li> <p>Verificar conexi\u00f3n: <pre><code>psql -d myapp_sandbox -c \"\\dt\"\n</code></pre></p> </li> <li> <p>Si no hay cambios, no se guardaron (intenta de nuevo)</p> </li> </ol>"},{"location":"es/reference/troubleshooting/#cannot-drop-database-myapp_sandbox-because-it-is-being-accessed","title":"<code>cannot drop database myapp_sandbox because it is being accessed</code>","text":"<p>Problema: <pre><code>Error: database \"myapp_sandbox\" is being accessed by other users\n</code></pre></p> <p>Soluciones:</p> <ol> <li> <p>Cerrar otras conexiones: <pre><code># PostgreSQL\npsql -c \"SELECT pid FROM pg_stat_activity WHERE datname = 'myapp_sandbox';\" \n\n# Terminar sesiones\npsql -c \"SELECT pg_terminate_backend(pid) FROM pg_stat_activity \nWHERE datname = 'myapp_sandbox';\"\n</code></pre></p> </li> <li> <p>Esperar y reintentar: <pre><code>dbl sandbox rollback\n</code></pre></p> </li> </ol>"},{"location":"es/reference/troubleshooting/#commits-y-capas","title":"Commits y Capas","text":""},{"location":"es/reference/troubleshooting/#no-uncommitted-changes","title":"<code>no uncommitted changes</code>","text":"<p>Problema: <pre><code>Error: There are no uncommitted changes to commit\n</code></pre></p> <p>Soluciones:</p> <ol> <li> <p>Hacer cambios primero: <pre><code>dbl sandbox start\npsql -d myapp_sandbox -c \"CREATE TABLE users (...);\"\ndbl diff  # Verificar\n</code></pre></p> </li> <li> <p>Revisar estado: <pre><code>dbl sandbox status\n</code></pre></p> </li> </ol>"},{"location":"es/reference/troubleshooting/#layer-file-already-exists","title":"<code>layer file already exists</code>","text":"<p>Problema: <pre><code>Error: Layer file L015_add_users.sql already exists\n</code></pre></p> <p>Soluciones:</p> <ol> <li> <p>Usar nombre diferente (DBL lo hace autom\u00e1ticamente)</p> </li> <li> <p>Eliminar capa anterior: <pre><code>rm .dbl/layers/L015_*.sql\ndbl commit -m \"Add users table\"\n</code></pre></p> </li> </ol>"},{"location":"es/reference/troubleshooting/#conflict-layer-modified-in-multiple-branches","title":"<code>conflict: layer modified in multiple branches</code>","text":"<p>Problema: <pre><code>Error: Merge conflict in layer L020\nModificado en main: L020_add_feature_a.sql\nModificado en feature/b: L020_add_feature_b.sql\n</code></pre></p> <p>Soluciones:</p> <ol> <li> <p>Renombrar capas conflictivas: <pre><code>dbl checkout main\n# Capas L020-L030\n\ndbl checkout feature/b\n# Renombrar sus capas a L031+\n</code></pre></p> </li> <li> <p>Crear commit de merge: <pre><code>dbl merge feature/b\n# Resolver manual\ndbl merge --continue\n</code></pre></p> </li> </ol>"},{"location":"es/reference/troubleshooting/#validacion","title":"Validaci\u00f3n","text":""},{"location":"es/reference/troubleshooting/#layer-validation-failed","title":"<code>layer validation failed</code>","text":"<p>Problema: <pre><code>Error: Layer L015 failed validation\n  SQL Error: column \"user_id\" does not exist\n</code></pre></p> <p>Soluciones:</p> <ol> <li> <p>Revisar la capa: <pre><code>cat .dbl/layers/L015_*.sql\n</code></pre></p> </li> <li> <p>Verificar dependencias: <pre><code># \u00bfExiste la columna en capas previas?\ngrep -r \"user_id\" .dbl/layers/L014*\n</code></pre></p> </li> <li> <p>Arreglar: <pre><code># Editar L015\nvim .dbl/layers/L015_*.sql\n\n# Revalidar\ndbl validate\n</code></pre></p> </li> </ol>"},{"location":"es/reference/troubleshooting/#schema-inconsistency-detected","title":"<code>schema inconsistency detected</code>","text":"<p>Problema: <pre><code>Error: Schema doesn't match layers\nExpected tables: users, posts, comments\nFound tables: users, posts\nMissing: comments\n</code></pre></p> <p>Soluciones:</p> <ol> <li> <p>Resetear base de datos: <pre><code>dbl reset\n</code></pre></p> </li> <li> <p>Verificar capa faltante: <pre><code>dbl log | grep comments\n</code></pre></p> </li> <li> <p>Si falta capa, reconstruir: <pre><code>dbl sandbox start\n# Recrear cambios manualmente\ndbl commit -m \"Recreate comments table\"\ndbl sandbox apply\n</code></pre></p> </li> </ol>"},{"location":"es/reference/troubleshooting/#rendimiento","title":"Rendimiento","text":""},{"location":"es/reference/troubleshooting/#reset-takes-too-long","title":"<code>reset takes too long</code>","text":"<p>Problema: <pre><code>$ dbl reset\n... esperando mucho tiempo ...\n</code></pre></p> <p>Soluciones:</p> <ol> <li> <p>Verificar operaciones costosas: <pre><code># Ver capas grandes\nfor f in .dbl/layers/*.sql; do\n    lines=$(wc -l &lt; \"$f\")\n    echo \"$lines - $f\"\ndone | sort -rn | head\n</code></pre></p> </li> <li> <p>Optimizar capas: <pre><code># Fusionar peque\u00f1as capas\ncat .dbl/layers/L001_*.sql &gt;&gt; merged.sql\ncat .dbl/layers/L002_*.sql &gt;&gt; merged.sql\n</code></pre></p> </li> <li> <p>Usar \u00edndices: <pre><code>-- En lugar de escanear tabla completa\nCREATE INDEX idx_users_email ON users(email);\n</code></pre></p> </li> </ol>"},{"location":"es/reference/troubleshooting/#errores-sql","title":"Errores SQL","text":""},{"location":"es/reference/troubleshooting/#syntax-error","title":"<code>syntax error</code>","text":"<p>Problema: <pre><code>Error: syntax error at or near \";\"\n</code></pre></p> <p>Soluciones:</p> <ol> <li> <p>Revisar SQL: <pre><code># Ver l\u00ednea exacta del error\ncat .dbl/layers/L015_*.sql | head -20\n</code></pre></p> </li> <li> <p>Sintaxis espec\u00edfica por BD: <pre><code>-- PostgreSQL\nCREATE TABLE IF NOT EXISTS users (...);\n\n-- MySQL\nCREATE TABLE IF NOT EXISTS users (...);\n-- Igual en este caso\n\n-- Pero diferente:\n-- PostgreSQL: SERIAL\n-- MySQL: AUTO_INCREMENT\n</code></pre></p> </li> <li> <p>Verificar SQL con herramienta: <pre><code>psql -f .dbl/layers/L015_*.sql\n</code></pre></p> </li> </ol>"},{"location":"es/reference/troubleshooting/#permission-denied","title":"<code>permission denied</code>","text":"<p>Problema: <pre><code>Error: permission denied for schema public\n</code></pre></p> <p>Soluciones:</p> <ol> <li> <p>Otorgar permisos: <pre><code># PostgreSQL\npsql -U postgres -c \"\nGRANT ALL ON DATABASE myapp TO myuser;\nGRANT ALL ON SCHEMA public TO myuser;\nGRANT ALL ON ALL TABLES IN SCHEMA public TO myuser;\n\"\n</code></pre></p> </li> <li> <p>Usar usuario con permisos: <pre><code># dbl.yaml\ndatabase:\n  user: postgres  # Usuario admin\n</code></pre></p> </li> </ol>"},{"location":"es/reference/troubleshooting/#integer-out-of-range","title":"<code>integer out of range</code>","text":"<p>Problema: <pre><code>Error: integer out of range\n</code></pre></p> <p>Soluciones:</p> <ol> <li> <p>Usar tipo correcto: <pre><code>-- En lugar de INT (max 2^31-1)\nALTER TABLE users ADD COLUMN large_id BIGINT;\n</code></pre></p> </li> <li> <p>Verificar valores: <pre><code>SELECT MAX(id) FROM users;\n</code></pre></p> </li> </ol>"},{"location":"es/reference/troubleshooting/#ramas","title":"Ramas","text":""},{"location":"es/reference/troubleshooting/#branch-not-found","title":"<code>branch not found</code>","text":"<p>Problema: <pre><code>Error: Branch feature/auth not found\n</code></pre></p> <p>Soluciones:</p> <ol> <li> <p>Listar ramas: <pre><code>dbl branch --list\n</code></pre></p> </li> <li> <p>Crear rama: <pre><code>dbl branch create feature/auth\ndbl checkout feature/auth\n</code></pre></p> </li> <li> <p>Nombre correcto: <pre><code># Nombres son case-sensitive\ndbl checkout feature/auth  # Correcto\ndbl checkout Feature/Auth  # Error\n</code></pre></p> </li> </ol>"},{"location":"es/reference/troubleshooting/#cannot-merge-branches-diverged","title":"<code>cannot merge: branches diverged</code>","text":"<p>Problema: <pre><code>Error: Cannot merge - branches have diverged significantly\n</code></pre></p> <p>Soluciones:</p> <ol> <li> <p>Entender divergencia: <pre><code>dbl log --branch main | wc -l\ndbl log --branch feature/auth | wc -l\n</code></pre></p> </li> <li> <p>Resolver conflictos: <pre><code>dbl merge feature/auth\n# DBL marca conflictos\n\n# Editar archivos conflictivos\nvim .dbl/layers/...\n\n# Marcar resuelto\ndbl merge --continue\n</code></pre></p> </li> </ol>"},{"location":"es/reference/troubleshooting/#diferencias","title":"Diferencias","text":""},{"location":"es/reference/troubleshooting/#diff-shows-everything-as-changed","title":"<code>diff shows everything as changed</code>","text":"<p>Problema: <pre><code>$ dbl diff\nToda la BD parece cambiada...\n</code></pre></p> <p>Soluciones:</p> <ol> <li> <p>Problema de whitespace: <pre><code># Resetear para limpiar\ndbl reset\ndbl diff  # Ahora deber\u00eda estar limpio\n</code></pre></p> </li> <li> <p>Problema de encoding: <pre><code># PostgreSQL mostrar como hexadecimal\npsql -d myapp_sandbox -c \"\nSELECT encode(column, 'hex')\nFROM table;\n\"\n</code></pre></p> </li> </ol>"},{"location":"es/reference/troubleshooting/#cicd","title":"CI/CD","text":""},{"location":"es/reference/troubleshooting/#dbl-command-not-found-in-github-actions","title":"<code>dbl: command not found in GitHub Actions</code>","text":"<p>Problema: <pre><code>Error: dbl: command not found\n</code></pre></p> <p>Soluci\u00f3n:</p> <p>Instalar en workflow:</p> <pre><code>- name: Install DBL\n  run: pip install dbl\n\n- name: Validate\n  run: dbl validate\n</code></pre>"},{"location":"es/reference/troubleshooting/#database-locked-en-tests-paralelos","title":"<code>database locked</code> en tests paralelos","text":"<p>Problema: <pre><code>Error: database is locked\n</code></pre></p> <p>Soluci\u00f3n:</p> <p>Usar diferentes bases de datos:</p> <pre><code>strategy:\n  matrix:\n    python-version: [3.8, 3.9]\n\nenv:\n  DB_NAME: testdb_${{ matrix.python-version }}\n</code></pre>"},{"location":"es/reference/troubleshooting/#getting-help","title":"Getting Help","text":""},{"location":"es/reference/troubleshooting/#obtener-informacion-de-debug","title":"Obtener informaci\u00f3n de debug","text":"<pre><code># Verbose output\ndbl --verbose init\n\n# Ver versi\u00f3n\ndbl version\n\n# Ver configuraci\u00f3n\ncat dbl.yaml\n\n# Ver estado\ndbl sandbox status\n</code></pre>"},{"location":"es/reference/troubleshooting/#reportar-un-bug","title":"Reportar un bug","text":"<ol> <li> <p>Recopilar informaci\u00f3n: <pre><code>dbl version --verbose &gt; debug.txt\ndbl validate --verbose &gt;&gt; debug.txt\n</code></pre></p> </li> <li> <p>Abrir issue en GitHub con debug.txt</p> </li> </ol>"},{"location":"es/reference/troubleshooting/#contacto","title":"Contacto","text":"<ul> <li>GitHub: https://github.com/dbl-project</li> <li>Issues: https://github.com/dbl-project/issues</li> <li>Discussions: https://github.com/dbl-project/discussions</li> </ul>"},{"location":"es/reference/troubleshooting/#proximos-pasos","title":"Pr\u00f3ximos Pasos","text":"<ul> <li>FAQ - M\u00e1s preguntas</li> <li>Documentaci\u00f3n completa</li> <li>Mejores pr\u00e1cticas</li> </ul>"},{"location":"getting-started/first-migration/","title":"Your First Migration","text":"<p>Learn migration best practices by building a real-world example.</p>"},{"location":"getting-started/first-migration/#scenario","title":"Scenario","text":"<p>You're building a blog application and need to add: 1. A <code>posts</code> table 2. A <code>comments</code> table with foreign key 3. An index for performance</p> <p>We'll use DBL's migration phases to do this safely.</p>"},{"location":"getting-started/first-migration/#migration-phases","title":"Migration Phases","text":"<p>DBL supports three optional phases:</p> Phase Purpose Risk When to Use expand Add things \u2705 Low New tables, columns backfill Update data \u26a0\ufe0f Medium Populate new columns contract Remove things \u274c High Drop columns, constraints <p>Best Practice</p> <p>Always add before you remove. Use expand \u2192 backfill \u2192 contract pattern.</p>"},{"location":"getting-started/first-migration/#step-1-initialize","title":"Step 1: Initialize","text":"<pre><code># Create project\nmkdir blog-app\ncd blog-app\n\n# Initialize DBL\ndbl init\n\n# Configure database\nnano dbl.yaml  # Add your DB credentials\n</code></pre>"},{"location":"getting-started/first-migration/#step-2-start-sandbox","title":"Step 2: Start Sandbox","text":"<pre><code>dbl sandbox start\n</code></pre>"},{"location":"getting-started/first-migration/#step-3-create-posts-table-expand-phase","title":"Step 3: Create Posts Table (Expand Phase)","text":"<p>Connect to your sandbox database and run:</p> <pre><code>-- Create posts table\nCREATE TABLE posts (\n    id SERIAL PRIMARY KEY,\n    title VARCHAR(255) NOT NULL,\n    content TEXT,\n    author_id INTEGER NOT NULL,\n    status VARCHAR(20) DEFAULT 'draft',\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Add index for performance\nCREATE INDEX idx_posts_author ON posts(author_id);\nCREATE INDEX idx_posts_status ON posts(status);\n</code></pre> <p>Review changes: <pre><code>dbl diff\n</code></pre></p> <p>Commit: <pre><code>dbl commit -m \"Add posts table with indexes\"\n</code></pre></p>"},{"location":"getting-started/first-migration/#step-4-add-comments-table-expand-phase","title":"Step 4: Add Comments Table (Expand Phase)","text":"<pre><code>-- Create comments table\nCREATE TABLE comments (\n    id SERIAL PRIMARY KEY,\n    post_id INTEGER NOT NULL REFERENCES posts(id) ON DELETE CASCADE,\n    user_id INTEGER NOT NULL,\n    content TEXT NOT NULL,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    CONSTRAINT valid_content CHECK (length(content) &gt; 0)\n);\n\n-- Performance indexes\nCREATE INDEX idx_comments_post ON comments(post_id);\nCREATE INDEX idx_comments_user ON comments(user_id);\n</code></pre> <p>Commit: <pre><code>dbl commit -m \"Add comments table with foreign keys\"\n</code></pre></p>"},{"location":"getting-started/first-migration/#step-5-apply-to-main-database","title":"Step 5: Apply to Main Database","text":"<pre><code>dbl sandbox apply\n</code></pre>"},{"location":"getting-started/first-migration/#step-6-add-sample-data-optional","title":"Step 6: Add Sample Data (Optional)","text":"<p>For the backfill phase example:</p> <pre><code>dbl sandbox start\n</code></pre> <pre><code>-- Add sample posts\nINSERT INTO posts (title, content, author_id, status) VALUES\n    ('Hello World', 'My first blog post!', 1, 'published'),\n    ('DBL is Awesome', 'Learning database migrations...', 1, 'draft');\n\n-- Add sample comments\nINSERT INTO comments (post_id, user_id, content) VALUES\n    (1, 2, 'Great first post!'),\n    (1, 3, 'Welcome to blogging!');\n</code></pre> <p>Commit with data: <pre><code>dbl commit -m \"Add sample blog data\" --with-data\n</code></pre></p> <p>Data Commits</p> <p>Use <code>--with-data</code> flag to include INSERT/UPDATE statements. This is opt-in for safety.</p> <pre><code>dbl sandbox apply\n</code></pre>"},{"location":"getting-started/first-migration/#step-7-view-your-history","title":"Step 7: View Your History","text":"<pre><code>dbl log\n</code></pre> <p>Output: <pre><code>* L003 - Add sample blog data\n         2025-12-30 11:15:22\n         Branch: master\n\n* L002 - Add comments table with foreign keys\n         2025-12-30 11:10:15\n         Branch: master\n\n* L001 - Add posts table with indexes\n         2025-12-30 11:05:30\n         Branch: master\n</code></pre></p>"},{"location":"getting-started/first-migration/#advanced-add-a-new-column","title":"Advanced: Add a New Column","text":"<p>Let's add a <code>view_count</code> column to posts using the expand \u2192 backfill \u2192 contract pattern.</p>"},{"location":"getting-started/first-migration/#migration-1-expand-add-column","title":"Migration 1: Expand (Add Column)","text":"<pre><code>dbl sandbox start\n</code></pre> <pre><code>-- Add new column (nullable at first)\nALTER TABLE posts \n  ADD COLUMN view_count INTEGER;\n</code></pre> <pre><code>dbl commit -m \"expand: Add view_count column\"\ndbl sandbox apply\n</code></pre>"},{"location":"getting-started/first-migration/#migration-2-backfill-populate-data","title":"Migration 2: Backfill (Populate Data)","text":"<pre><code>dbl sandbox start\n</code></pre> <pre><code>-- Set default values for existing rows\nUPDATE posts \nSET view_count = 0 \nWHERE view_count IS NULL;\n</code></pre> <pre><code>dbl commit -m \"backfill: Initialize view_count to 0\" --with-data\ndbl sandbox apply\n</code></pre>"},{"location":"getting-started/first-migration/#migration-3-contract-add-constraint","title":"Migration 3: Contract (Add Constraint)","text":"<pre><code>dbl sandbox start\n</code></pre> <pre><code>-- Now make it NOT NULL and add default\nALTER TABLE posts \n  ALTER COLUMN view_count SET NOT NULL,\n  ALTER COLUMN view_count SET DEFAULT 0;\n</code></pre> <pre><code>dbl commit -m \"contract: Make view_count NOT NULL\"\ndbl sandbox apply\n</code></pre> <p>Zero-Downtime Pattern</p> <p>This expand \u2192 backfill \u2192 contract pattern allows zero-downtime deployments in production.</p>"},{"location":"getting-started/first-migration/#validate-your-migrations","title":"Validate Your Migrations","text":"<p>DBL can validate migration patterns:</p> <pre><code>dbl validate\n</code></pre> <p>Output: <pre><code>Validating layers on branch: master\n\n\u2713 L001: expand phase (safe)\n\u2713 L002: expand phase (safe)\n\u2713 L003: backfill phase (data changes)\n\u2713 L004: expand phase (safe)\n\u2713 L005: backfill phase (data changes)\n\u26a0 L006: contract phase (review required)\n\nValidation complete: 0 errors, 1 warning\n</code></pre></p>"},{"location":"getting-started/first-migration/#branching-example","title":"Branching Example","text":"<p>Work on a feature in isolation:</p> <pre><code># Create feature branch\ndbl branch add-tags\n\n# Switch to it\ndbl checkout add-tags\n\n# Work on feature\ndbl sandbox start\n</code></pre> <pre><code>-- Add tags support\nCREATE TABLE tags (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(50) UNIQUE NOT NULL\n);\n\nCREATE TABLE post_tags (\n    post_id INTEGER REFERENCES posts(id) ON DELETE CASCADE,\n    tag_id INTEGER REFERENCES tags(id) ON DELETE CASCADE,\n    PRIMARY KEY (post_id, tag_id)\n);\n</code></pre> <pre><code>dbl commit -m \"Add tags support\"\ndbl sandbox apply\n\n# Merge back to master\ndbl checkout master\ndbl merge add-tags\n</code></pre>"},{"location":"getting-started/first-migration/#reset-and-rebuild","title":"Reset and Rebuild","text":"<p>Rebuild your entire database from layers:</p> <pre><code># This drops and recreates your database\ndbl reset\n\n# All layers are replayed in order\n# Your database is now identical to layer history\n</code></pre> <p>Destructive Operation</p> <p><code>dbl reset</code> DROPS your database. Always have backups!</p>"},{"location":"getting-started/first-migration/#configuration-tips","title":"Configuration Tips","text":"<p>Add to your <code>dbl.yaml</code>:</p> <pre><code># Track specific tables\ntrack_tables:\n  - posts\n  - comments\n  - tags\n  - post_tags\n\n# Ignore system tables\nignore_tables:\n  - sessions\n  - cache\n\n# Validation rules\nvalidate:\n  strict: false               # Warnings don't fail\n  detect_type_changes: true   # Warn on type changes\n  require_comments: true      # Require comments for contract phase\n</code></pre>"},{"location":"getting-started/first-migration/#testing-your-migrations","title":"Testing Your Migrations","text":"<p>Create a test workflow:</p> <pre><code>#!/bin/bash\n# test-migrations.sh\n\n# Start fresh\ndbl reset\n\n# Verify schema\npsql -d your_database -c \"\\dt\"  # List tables\n\n# Run app tests\npytest tests/\n\n# If tests pass, migration is good!\n</code></pre>"},{"location":"getting-started/first-migration/#cicd-integration","title":"CI/CD Integration","text":"<p>Use DBL in your CI pipeline:</p> <pre><code># .github/workflows/test.yml\n- name: Check for DB changes\n  run: |\n    dbl diff\n    if [ $? -eq 1 ]; then\n      echo \"Schema changes detected but not committed!\"\n      exit 1\n    fi\n</code></pre>"},{"location":"getting-started/first-migration/#real-world-example-e-commerce","title":"Real-World Example: E-commerce","text":"<p>Complete example with orders, products, and inventory:</p> <pre><code># Branch for feature\ndbl branch order-system\ndbl checkout order-system\ndbl sandbox start\n</code></pre> <pre><code>-- Products table\nCREATE TABLE products (\n    id SERIAL PRIMARY KEY,\n    name VARCHAR(255) NOT NULL,\n    price DECIMAL(10,2) NOT NULL,\n    stock INTEGER DEFAULT 0,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Orders table\nCREATE TABLE orders (\n    id SERIAL PRIMARY KEY,\n    user_id INTEGER NOT NULL,\n    status VARCHAR(20) DEFAULT 'pending',\n    total DECIMAL(10,2),\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Order items\nCREATE TABLE order_items (\n    id SERIAL PRIMARY KEY,\n    order_id INTEGER REFERENCES orders(id),\n    product_id INTEGER REFERENCES products(id),\n    quantity INTEGER NOT NULL,\n    price DECIMAL(10,2) NOT NULL\n);\n\n-- Indexes\nCREATE INDEX idx_orders_user ON orders(user_id);\nCREATE INDEX idx_orders_status ON orders(status);\nCREATE INDEX idx_order_items_order ON order_items(order_id);\n</code></pre> <pre><code>dbl commit -m \"Add order management system\"\ndbl sandbox apply\n</code></pre>"},{"location":"getting-started/first-migration/#best-practices-summary","title":"Best Practices Summary","text":"<ol> <li>\u2705 Always use sandboxes - Never modify main DB directly</li> <li>\u2705 Review with diff - Always check what will be committed</li> <li>\u2705 Descriptive messages - Write clear commit messages</li> <li>\u2705 Use branches - Isolate feature work</li> <li>\u2705 Follow phases - expand \u2192 backfill \u2192 contract</li> <li>\u2705 Add indexes - Include performance considerations</li> <li>\u2705 Validate regularly - Run <code>dbl validate</code> often</li> <li>\u2705 Test migrations - Use <code>dbl reset</code> to test replaying</li> </ol>"},{"location":"getting-started/first-migration/#common-pitfalls","title":"Common Pitfalls","text":"<p>\u274c Don't: - Skip sandbox for \"quick changes\" - Commit without reviewing diff - Use contract phase without expand first - Forget indexes on foreign keys - Mix schema and data in one commit</p> <p>\u2705 Do: - Always work in sandbox - Review every diff carefully - Add things before removing - Index appropriately - Separate schema and data commits</p>"},{"location":"getting-started/first-migration/#next-steps","title":"Next Steps","text":"<ul> <li>\ud83d\udcd6 Best Practices Guide</li> <li>\ud83c\udfaf Migration Patterns</li> <li>\u2699\ufe0f Configuration Reference</li> <li>\ud83c\udf3f Branching Strategies</li> </ul>"},{"location":"getting-started/first-migration/#need-help","title":"Need Help?","text":"<ul> <li>Troubleshooting Guide</li> <li>FAQ</li> <li>GitHub Issues</li> </ul>"},{"location":"getting-started/installation/","title":"Installation Guide","text":"<p>Complete guide to installing DBL on different platforms.</p>"},{"location":"getting-started/installation/#quick-install","title":"Quick Install","text":"<pre><code># Recommended: Install via pip\npip install git+https://github.com/alann-estrada-KSH/dbl-sandbox.git\n\n# Verify installation\ndbl version\ndbl help\n</code></pre>"},{"location":"getting-started/installation/#prerequisites","title":"Prerequisites","text":""},{"location":"getting-started/installation/#1-python","title":"1. Python","text":"<p>Required: Python 3.7 or higher (3.10+ recommended)</p> <p>Check your Python version: <pre><code>python --version\n# or\npython3 --version\n</code></pre></p> <p>Install Python if needed:</p> Ubuntu/DebianmacOSWindows <pre><code>sudo apt update\nsudo apt install python3 python3-pip\n</code></pre> <pre><code># Using Homebrew\nbrew install python3\n</code></pre> <p>Download from python.org</p> <p>\u2705 Check \"Add Python to PATH\" during installation</p>"},{"location":"getting-started/installation/#2-database-cli-tools","title":"2. Database CLI Tools","text":"<p>Install based on your database engine:</p> PostgreSQLMySQL <p>Required tools: <code>psql</code>, <code>pg_dump</code></p> <pre><code># Ubuntu/Debian\nsudo apt install postgresql-client\n\n# macOS\nbrew install postgresql\n\n# Windows\n# Download from postgresql.org\n</code></pre> <p>Required tools: <code>mysql</code>, <code>mysqldump</code></p> <pre><code># Ubuntu/Debian\nsudo apt install mysql-client\n\n# macOS\nbrew install mysql-client\n\n# Windows\n# Download from mysql.com\n</code></pre>"},{"location":"getting-started/installation/#3-pip-python-package-manager","title":"3. pip (Python Package Manager)","text":"<p>Usually included with Python. Verify: <pre><code>pip --version\n</code></pre></p> <p>If missing: <pre><code>python -m ensurepip --upgrade\n</code></pre></p>"},{"location":"getting-started/installation/#installation-methods","title":"Installation Methods","text":""},{"location":"getting-started/installation/#method-1-pip-install-recommended","title":"Method 1: pip Install (Recommended)","text":"<p>Install directly from GitHub:</p> <pre><code>pip install git+https://github.com/alann-estrada-KSH/dbl-sandbox.git\n</code></pre> <p>\u2705 Benefits: - Installs all dependencies automatically - Creates global <code>dbl</code> command - Easy to update with <code>dbl update</code> - Works on all platforms</p> <p>Verify: <pre><code>dbl version\n# Output: DBL (Database Layering) v0.0.1-alpha\n</code></pre></p>"},{"location":"getting-started/installation/#method-2-development-install","title":"Method 2: Development Install","text":"<p>For development or contributing:</p> <pre><code># Clone repository\ngit clone https://github.com/alann-estrada-KSH/dbl-sandbox.git\ncd dbl-sandbox\n\n# Install dependencies\npip install -r requirements.txt\n\n# Install in editable mode\npip install -e .\n</code></pre>"},{"location":"getting-started/installation/#method-3-manual-install","title":"Method 3: Manual Install","text":"<p>For systems without pip or custom setups:</p>"},{"location":"getting-started/installation/#unixlinuxmacos","title":"Unix/Linux/macOS","text":"<pre><code># Clone repository\ngit clone https://github.com/alann-estrada-KSH/dbl-sandbox.git\ncd dbl-sandbox\n\n# Install dependencies\npip install PyYAML&gt;=6.0\n\n# Make executable\nchmod +x dbl.py\n\n# Create symlink\nsudo ln -sf $(pwd)/dbl.py /usr/local/bin/dbl\n\n# Test\ndbl version\n</code></pre>"},{"location":"getting-started/installation/#windows","title":"Windows","text":"<pre><code># Clone repository\ngit clone https://github.com/alann-estrada-KSH/dbl-sandbox.git\ncd dbl-sandbox\n\n# Install dependencies\npip install PyYAML&gt;=6.0\n\n# Create launcher\nmkdir $env:USERPROFILE\\bin\n@\"\n@echo off\npython \"$PWD\\dbl.py\" %*\n\"@ | Out-File -FilePath $env:USERPROFILE\\bin\\dbl.cmd -Encoding ASCII\n\n# Add to PATH (run as Administrator)\n[Environment]::SetEnvironmentVariable(\n    \"Path\",\n    [Environment]::GetEnvironmentVariable(\"Path\", \"User\") + \";$env:USERPROFILE\\bin\",\n    \"User\"\n)\n</code></pre>"},{"location":"getting-started/installation/#platform-specific-instructions","title":"Platform-Specific Instructions","text":""},{"location":"getting-started/installation/#docker-containers","title":"Docker Containers","text":"<p>If your database runs in Docker:</p> <ol> <li>Install DBL on host system</li> <li>Configure <code>container_name</code> in <code>dbl.yaml</code>:    <pre><code>container_name: my_postgres_container\n</code></pre></li> <li>DBL will automatically use <code>docker exec</code> for all database operations</li> </ol> <p>Example: <pre><code>dbl sandbox start\n# Runs: docker exec my_postgres_container createdb mydb_sandbox\n</code></pre></p>"},{"location":"getting-started/installation/#wsl-windows-subsystem-for-linux","title":"WSL (Windows Subsystem for Linux)","text":"<p>Recommended for Windows users:</p> <pre><code># Inside WSL\npip install git+https://github.com/alann-estrada-KSH/dbl-sandbox.git\n\n# Use from Windows\nwsl dbl help\n\n# Or add WSL to PATH\n</code></pre>"},{"location":"getting-started/installation/#virtual-environments","title":"Virtual Environments","text":"<p>For isolated Python environments:</p> <pre><code># Create virtualenv\npython -m venv dbl-env\n\n# Activate\nsource dbl-env/bin/activate  # Unix\n.\\dbl-env\\Scripts\\activate   # Windows\n\n# Install\npip install git+https://github.com/alann-estrada-KSH/dbl-sandbox.git\n\n# Use\ndbl help\n</code></pre>"},{"location":"getting-started/installation/#verification","title":"Verification","text":"<p>After installation, verify everything works:</p> <pre><code># Check version\ndbl version\n\n# Show help\ndbl help\n\n# Check dependencies\npython -c \"import yaml; print('\u2713 PyYAML installed')\"\n\n# Check database tools\npsql --version    # PostgreSQL\nmysql --version   # MySQL\n</code></pre>"},{"location":"getting-started/installation/#updating-dbl","title":"Updating DBL","text":""},{"location":"getting-started/installation/#automatic-update","title":"Automatic Update","text":"<pre><code>dbl update         # Interactive\ndbl update -y      # Auto-confirm\n</code></pre>"},{"location":"getting-started/installation/#manual-update","title":"Manual Update","text":"<pre><code>pip install --upgrade git+https://github.com/alann-estrada-KSH/dbl-sandbox.git\n</code></pre>"},{"location":"getting-started/installation/#uninstallation","title":"Uninstallation","text":""},{"location":"getting-started/installation/#pip-install","title":"pip Install","text":"<pre><code>pip uninstall dbl-sandbox\n</code></pre>"},{"location":"getting-started/installation/#manual-install","title":"Manual Install","text":"<pre><code># Remove symlink\nsudo rm /usr/local/bin/dbl  # Unix\nrm $env:USERPROFILE\\bin\\dbl.cmd  # Windows\n\n# Remove directory\nrm -rf dbl-sandbox/\n</code></pre>"},{"location":"getting-started/installation/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting-started/installation/#command-not-found","title":"Command Not Found","text":"<p>Problem: <code>dbl: command not found</code></p> <p>Solutions: 1. Reinstall with pip: <code>pip install git+https://github.com/...</code> 2. Check PATH: <code>echo $PATH</code> (Unix) or <code>echo $env:PATH</code> (Windows) 3. Run directly: <code>python -m dbl help</code></p>"},{"location":"getting-started/installation/#missing-dependencies","title":"Missing Dependencies","text":"<p>Problem: <code>ImportError: No module named 'yaml'</code></p> <p>Solution: <pre><code>pip install PyYAML&gt;=6.0\n# Or\ndbl update  # Auto-installs dependencies\n</code></pre></p>"},{"location":"getting-started/installation/#permission-errors","title":"Permission Errors","text":"<p>Problem: Permission denied during installation</p> <p>Solutions: 1. User install: <code>pip install --user git+https://github.com/...</code> 2. Virtual environment (recommended) 3. Fix permissions: <code>sudo</code> (Unix) or run as Administrator (Windows)</p>"},{"location":"getting-started/installation/#database-tools-not-found","title":"Database Tools Not Found","text":"<p>Problem: <code>psql: command not found</code></p> <p>Solution: Install database client tools (see Prerequisites)</p>"},{"location":"getting-started/installation/#next-steps","title":"Next Steps","text":"<p>After installation:</p> <ol> <li>\ud83d\udcd6 Quick Start Tutorial</li> <li>\ud83c\udfaf Your First Migration</li> <li>\u2699\ufe0f Configuration Guide</li> <li>\ud83d\udca1 Best Practices</li> </ol>"},{"location":"getting-started/installation/#additional-resources","title":"Additional Resources","text":"<ul> <li>GitHub Repository</li> <li>Issue Tracker</li> <li>Changelog</li> </ul>"},{"location":"getting-started/quick-start/","title":"Quick Start","text":"<p>Get started with DBL in under 10 minutes.</p>"},{"location":"getting-started/quick-start/#what-youll-learn","title":"What You'll Learn","text":"<ul> <li>\u2705 Initialize a DBL project</li> <li>\u2705 Create a safe sandbox</li> <li>\u2705 Make and commit your first migration</li> <li>\u2705 Apply changes to your database</li> </ul> <p>Time: ~10 minutes Prerequisites: DBL installed, database running</p>"},{"location":"getting-started/quick-start/#step-1-initialize-project","title":"Step 1: Initialize Project","text":"<p>Create a new DBL project:</p> <pre><code>cd your-project\ndbl init\n</code></pre> <p>Output: <pre><code>\u2713 Created dbl.yaml configuration file\n\u2713 Created .dbl directory structure\n\u2713 Initialized master branch\n</code></pre></p>"},{"location":"getting-started/quick-start/#step-2-configure-database","title":"Step 2: Configure Database","text":"<p>Edit <code>dbl.yaml</code> with your database credentials:</p> <pre><code>engine: postgres  # or mysql\n\n# Database connection\nhost: localhost\nport: 5432\nuser: your_user\npassword: your_password\ndatabase: your_database\n\n# Optional: Docker container\n# container_name: my_postgres_container\n</code></pre> <p>Test connection: <pre><code># PostgreSQL\npsql -h localhost -U your_user -d your_database -c \"SELECT version();\"\n\n# MySQL\nmysql -h localhost -u your_user -p your_database -e \"SELECT version();\"\n</code></pre></p>"},{"location":"getting-started/quick-start/#step-3-create-sandbox","title":"Step 3: Create Sandbox","text":"<p>Create a safe testing environment:</p> <pre><code>dbl sandbox start\n</code></pre> <p>Output: <pre><code>Creating sandbox database your_database_sandbox...\n\u2713 Sandbox created successfully\n\u2713 You are now working in the sandbox\n\nMake your changes, then:\n  dbl diff            - See what changed\n  dbl commit -m \"msg\" - Save changes\n  dbl sandbox apply   - Apply to main DB\n</code></pre></p> <p>What's a Sandbox?</p> <p>A sandbox is a complete copy of your database where you can safely experiment. Changes don't affect your main database until you explicitly apply them.</p>"},{"location":"getting-started/quick-start/#step-4-make-database-changes","title":"Step 4: Make Database Changes","text":"<p>Use your favorite database tool to make changes:</p> SQL Command LinepgAdmin / DBeaverMySQL Workbench <pre><code># PostgreSQL\npsql -h localhost -U your_user -d your_database_sandbox\n\n# In psql:\nCREATE TABLE user_preferences (\n    id SERIAL PRIMARY KEY,\n    user_id INTEGER NOT NULL,\n    theme VARCHAR(50) DEFAULT 'light',\n    language VARCHAR(10) DEFAULT 'en'\n);\n\nALTER TABLE users ADD COLUMN last_login TIMESTAMP;\n</code></pre> <ol> <li>Connect to <code>your_database_sandbox</code></li> <li>Use GUI to create tables/columns</li> <li>Execute SQL scripts</li> </ol> <ol> <li>Connect to <code>your_database_sandbox</code></li> <li>Use Schema Designer</li> <li>Execute SQL scripts</li> </ol>"},{"location":"getting-started/quick-start/#step-5-review-changes","title":"Step 5: Review Changes","text":"<p>See what you changed:</p> <pre><code>dbl diff\n</code></pre> <p>Output: <pre><code>-- Schema changes detected:\n\n+ CREATE TABLE user_preferences (\n+     id SERIAL PRIMARY KEY,\n+     user_id INTEGER NOT NULL,\n+     theme VARCHAR(50) DEFAULT 'light',\n+     language VARCHAR(10) DEFAULT 'en'\n+ );\n\n+ ALTER TABLE users \n+   ADD COLUMN last_login TIMESTAMP;\n\nChanges detected: 2 schema modifications\nExit code: 1 (changes detected)\n</code></pre></p> <p>Exit Codes</p> <ul> <li><code>0</code> = No changes detected</li> <li><code>1</code> = Changes detected (useful for CI/CD)</li> </ul>"},{"location":"getting-started/quick-start/#step-6-commit-changes","title":"Step 6: Commit Changes","text":"<p>Save your changes as a versioned layer:</p> <pre><code>dbl commit -m \"Add user preferences and last login tracking\"\n</code></pre> <p>Output: <pre><code>\u2713 Changes captured in layer L001\n\u2713 Layer metadata saved\n\u2713 Migration SQL generated: .dbl/layers/L001_add_user_preferences.sql\n\nLayer details:\n  ID: L001\n  Message: Add user preferences and last login tracking\n  Timestamp: 2025-12-30 10:30:45\n  Branch: master\n</code></pre></p> <p>Generated SQL file: <pre><code>-- Layer: L001\n-- Message: Add user preferences and last login tracking\n-- Author: DBL\n-- Date: 2025-12-30 10:30:45\n\n-- Phase: expand (safe additions)\nCREATE TABLE IF NOT EXISTS user_preferences (\n    id SERIAL PRIMARY KEY,\n    user_id INTEGER NOT NULL,\n    theme VARCHAR(50) DEFAULT 'light',\n    language VARCHAR(10) DEFAULT 'en'\n);\n\nALTER TABLE users \n  ADD COLUMN IF NOT EXISTS last_login TIMESTAMP;\n</code></pre></p>"},{"location":"getting-started/quick-start/#step-7-apply-to-main-database","title":"Step 7: Apply to Main Database","text":"<p>Apply sandbox changes to your main database:</p> <pre><code>dbl sandbox apply\n</code></pre> <p>Output: <pre><code>Applying sandbox changes to main database...\n\u2713 Executing layer L001\n\u2713 Changes applied successfully\n\u2713 Sandbox database dropped\n\u2713 Sandbox metadata cleared\n\nYour main database (your_database) now includes:\n  - user_preferences table\n  - users.last_login column\n</code></pre></p> <p>Done!</p> <p>Your changes are now in your main database. The sandbox has been cleaned up automatically.</p>"},{"location":"getting-started/quick-start/#what-you-just-did","title":"What You Just Did","text":"<ol> <li>Initialized DBL - Set up version control for your database</li> <li>Created Sandbox - Isolated testing environment</li> <li>Made Changes - Modified schema safely</li> <li>Reviewed with diff - Previewed all changes</li> <li>Committed Layer - Versioned your migration</li> <li>Applied Changes - Updated main database</li> </ol>"},{"location":"getting-started/quick-start/#view-your-history","title":"View Your History","text":"<p>Check your migration history:</p> <pre><code>dbl log\n</code></pre> <p>Output: <pre><code>* L001 - Add user preferences and last login tracking\n         2025-12-30 10:30:45\n         Branch: master\n</code></pre></p>"},{"location":"getting-started/quick-start/#next-steps","title":"Next Steps","text":""},{"location":"getting-started/quick-start/#try-branching","title":"Try Branching","text":"<p>Work on multiple features in parallel:</p> <pre><code># Create feature branch\ndbl branch add-comments\n\n# Switch to it\ndbl checkout add-comments\n\n# Make changes in sandbox\ndbl sandbox start\n# ... make changes ...\ndbl commit -m \"Add comments table\"\n\n# Merge back to master\ndbl checkout master\ndbl merge add-comments\n</code></pre>"},{"location":"getting-started/quick-start/#experiment-without-fear","title":"Experiment Without Fear","text":"<pre><code>dbl sandbox start\n# Try something risky...\ndbl diff\n# Don't like it?\ndbl sandbox rollback  # All changes discarded!\n</code></pre>"},{"location":"getting-started/quick-start/#rebuild-from-layers","title":"Rebuild From Layers","text":"<pre><code># Rebuild entire database from layers\ndbl reset\n\n# Your database is recreated from version history\n</code></pre>"},{"location":"getting-started/quick-start/#common-workflows","title":"Common Workflows","text":""},{"location":"getting-started/quick-start/#daily-development","title":"Daily Development","text":"<pre><code>dbl sandbox start\n# Work on feature...\ndbl diff\ndbl commit -m \"Feature X\"\ndbl sandbox apply\n</code></pre>"},{"location":"getting-started/quick-start/#experimenting","title":"Experimenting","text":"<pre><code>dbl sandbox start\n# Try something...\ndbl sandbox rollback  # Discard if not good\n</code></pre>"},{"location":"getting-started/quick-start/#team-collaboration","title":"Team Collaboration","text":"<pre><code>dbl log                    # See team's changes\ndbl branch feature-name    # Work on your feature\ndbl checkout master        # Review main branch\ndbl merge feature-name     # Integrate your work\n</code></pre>"},{"location":"getting-started/quick-start/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting-started/quick-start/#sandbox-already-exists","title":"Sandbox Already Exists","text":"<pre><code># Check status\ndbl sandbox status\n\n# Clean up if needed\ndbl sandbox rollback\n</code></pre>"},{"location":"getting-started/quick-start/#cant-connect-to-database","title":"Can't Connect to Database","text":"<pre><code># Test connection directly\npsql -h localhost -U user -d database\n\n# Check dbl.yaml settings\ncat dbl.yaml\n</code></pre>"},{"location":"getting-started/quick-start/#changes-not-detected","title":"Changes Not Detected","text":"<pre><code># Ensure you're in sandbox\ndbl sandbox status\n\n# Check state file\ncat .dbl/state.json\n</code></pre>"},{"location":"getting-started/quick-start/#learning-resources","title":"Learning Resources","text":"<ul> <li>\ud83d\udcd6 Complete Commands Guide</li> <li>\ud83c\udfaf Your First Migration Tutorial</li> <li>\ud83d\udca1 Best Practices</li> <li>\u2699\ufe0f Configuration Guide</li> </ul>"},{"location":"getting-started/quick-start/#need-help","title":"Need Help?","text":"<ul> <li>Run <code>dbl help</code> for command reference</li> <li>Check Troubleshooting Guide</li> <li>Open an issue</li> </ul> <p>Ready for more? \u2192 Your First Migration Tutorial</p>"},{"location":"guide/best-practices/","title":"Best Practices","text":"<p>Guidelines for effective database version control with DBL.</p>"},{"location":"guide/best-practices/#core-principles","title":"Core Principles","text":""},{"location":"guide/best-practices/#1-always-use-sandboxes","title":"1. Always Use Sandboxes","text":"<p>\u2705 DO: <pre><code>dbl sandbox start\n# Make changes...\ndbl commit -m \"Add feature\"\ndbl sandbox apply\n</code></pre></p> <p>\u274c DON'T: <pre><code># Directly modify main database\npsql -d production -c \"ALTER TABLE users ADD COLUMN email TEXT\"\n</code></pre></p> <p>Why: Sandboxes protect your main database and let you preview changes.</p>"},{"location":"guide/best-practices/#2-review-before-commit","title":"2. Review Before Commit","text":"<p>\u2705 DO: <pre><code>dbl diff                    # Review all changes\n# Read the output carefully\ndbl commit -m \"message\"\n</code></pre></p> <p>\u274c DON'T: <pre><code>dbl commit -m \"changes\"     # Blind commit\n</code></pre></p> <p>Why: Understand what you're committing to avoid mistakes.</p>"},{"location":"guide/best-practices/#3-descriptive-commit-messages","title":"3. Descriptive Commit Messages","text":"<p>\u2705 DO: <pre><code>dbl commit -m \"Add email verification column to users table\"\ndbl commit -m \"Create indexes for posts query performance\"\ndbl commit -m \"Add foreign key constraint between orders and products\"\n</code></pre></p> <p>\u274c DON'T: <pre><code>dbl commit -m \"update\"\ndbl commit -m \"fix\"\ndbl commit -m \"changes\"\n</code></pre></p> <p>Why: Clear messages help team understand history.</p>"},{"location":"guide/best-practices/#migration-patterns","title":"Migration Patterns","text":""},{"location":"guide/best-practices/#expand-backfill-contract-pattern","title":"Expand-Backfill-Contract Pattern","text":"<p>For safe, zero-downtime migrations:</p>"},{"location":"guide/best-practices/#phase-1-expand-add","title":"Phase 1: Expand (Add)","text":"<p><pre><code>dbl sandbox start\n</code></pre> <pre><code>-- Add new column (nullable)\nALTER TABLE users ADD COLUMN email VARCHAR(255);\n</code></pre> <pre><code>dbl commit -m \"expand: Add email column\"\ndbl sandbox apply\n</code></pre></p>"},{"location":"guide/best-practices/#phase-2-backfill-populate","title":"Phase 2: Backfill (Populate)","text":"<p><pre><code>dbl sandbox start\n</code></pre> <pre><code>-- Populate existing rows\nUPDATE users SET email = username || '@example.com' WHERE email IS NULL;\n</code></pre> <pre><code>dbl commit -m \"backfill: Populate email column\" --with-data\ndbl sandbox apply\n</code></pre></p>"},{"location":"guide/best-practices/#phase-3-contract-constrain","title":"Phase 3: Contract (Constrain)","text":"<p><pre><code>dbl sandbox start\n</code></pre> <pre><code>-- Add constraint\nALTER TABLE users ALTER COLUMN email SET NOT NULL;\nALTER TABLE users ADD CONSTRAINT unique_email UNIQUE (email);\n</code></pre> <pre><code>dbl commit -m \"contract: Make email required and unique\"\ndbl sandbox apply\n</code></pre></p> <p>Benefits: - \u2705 Zero downtime - \u2705 Rollback-safe - \u2705 App can run during migration</p>"},{"location":"guide/best-practices/#column-rename-pattern","title":"Column Rename Pattern","text":"<p>Don't rename directly - use expand-backfill-contract:</p> <p>\u274c Don't: <pre><code>ALTER TABLE users RENAME COLUMN name TO full_name;\n</code></pre></p> <p>\u2705 Do: <pre><code># Step 1: Add new column\nALTER TABLE users ADD COLUMN full_name VARCHAR(255);\n\n# Step 2: Copy data\nUPDATE users SET full_name = name;\n\n# Step 3: Update application code to use full_name\n\n# Step 4: Drop old column (after app deployed)\nALTER TABLE users DROP COLUMN name;\n</code></pre></p>"},{"location":"guide/best-practices/#table-rename-pattern","title":"Table Rename Pattern","text":"<p>Similar to column rename:</p> <pre><code># Step 1: Create new table\nCREATE TABLE customers AS SELECT * FROM users;\n\n# Step 2: Update app to use customers\n\n# Step 3: Drop old table\nDROP TABLE users;\n</code></pre>"},{"location":"guide/best-practices/#branching-strategies","title":"Branching Strategies","text":""},{"location":"guide/best-practices/#feature-branches","title":"Feature Branches","text":"<p>Work on features in isolation:</p> <pre><code># Create feature branch\ndbl branch feature-comments\ndbl checkout feature-comments\n\n# Work on feature\ndbl sandbox start\n# ... make changes ...\ndbl commit -m \"Add comments table\"\ndbl sandbox apply\n\n# Merge when ready\ndbl checkout master\ndbl merge feature-comments\n</code></pre>"},{"location":"guide/best-practices/#hotfix-pattern","title":"Hotfix Pattern","text":"<p>Quick fixes on production schema:</p> <pre><code># Create hotfix branch\ndbl branch hotfix-index\ndbl checkout hotfix-index\n\n# Apply fix\ndbl sandbox start\nCREATE INDEX idx_users_email ON users(email);\ndbl commit -m \"Add index for email lookups\"\ndbl sandbox apply\n\n# Merge to master\ndbl checkout master\ndbl merge hotfix-index\n</code></pre>"},{"location":"guide/best-practices/#development-vs-production","title":"Development vs Production","text":"<pre><code># Development: permissive\nvalidate:\n  strict: false\n  allow_orphaned: true\n\n# Production: strict\nvalidate:\n  strict: true\n  require_comments: true\n  detect_type_changes: true\n</code></pre>"},{"location":"guide/best-practices/#team-collaboration","title":"Team Collaboration","text":""},{"location":"guide/best-practices/#commit-conventions","title":"Commit Conventions","text":"<p>Agree on commit message format:</p> <pre><code># Format: [phase]: Description\ndbl commit -m \"expand: Add user preferences table\"\ndbl commit -m \"backfill: Populate default preferences\"\ndbl commit -m \"contract: Remove deprecated columns\"\n\n# Or: [type]: Description\ndbl commit -m \"feat: Add comments system\"\ndbl commit -m \"perf: Add indexes for search\"\ndbl commit -m \"fix: Correct foreign key constraint\"\n</code></pre>"},{"location":"guide/best-practices/#code-review-process","title":"Code Review Process","text":"<ol> <li>Create feature branch</li> <li>Make changes in sandbox</li> <li>Commit layers</li> <li>Share layer files (<code>.dbl/layers/L*.sql</code>)</li> <li>Team reviews SQL</li> <li>Merge to master</li> </ol>"},{"location":"guide/best-practices/#shared-development-database","title":"Shared Development Database","text":"<pre><code># team-dbl.yaml\nengine: postgres\ncontainer_name: team_shared_db\nuser: team_user\npassword: ${TEAM_DB_PASSWORD}\ndatabase: team_dev\n\npolicies:\n  require_sandbox: true  # Everyone uses sandboxes\n</code></pre>"},{"location":"guide/best-practices/#performance-considerations","title":"Performance Considerations","text":""},{"location":"guide/best-practices/#index-everything-important","title":"Index Everything Important","text":"<p>\u2705 DO: <pre><code>-- Foreign keys\nCREATE INDEX idx_posts_author ON posts(author_id);\n\n-- Frequently queried columns\nCREATE INDEX idx_users_email ON users(email);\nCREATE INDEX idx_posts_status ON posts(status);\n\n-- Composite indexes for complex queries\nCREATE INDEX idx_posts_author_status ON posts(author_id, status);\n</code></pre></p>"},{"location":"guide/best-practices/#use-partial-indexes","title":"Use Partial Indexes","text":"<p>For large tables:</p> <pre><code>-- Index only active records\nCREATE INDEX idx_active_users ON users(email) WHERE active = true;\n\n-- Index only recent data\nCREATE INDEX idx_recent_posts ON posts(created_at) \n  WHERE created_at &gt; NOW() - INTERVAL '1 year';\n</code></pre>"},{"location":"guide/best-practices/#avoid-select-in-data-commits","title":"Avoid SELECT * in Data Commits","text":"<p>\u274c Don't: <pre><code>INSERT INTO users SELECT * FROM temp_users;\n</code></pre></p> <p>\u2705 Do: <pre><code>INSERT INTO users (username, email, created_at)\nSELECT username, email, created_at FROM temp_users;\n</code></pre></p>"},{"location":"guide/best-practices/#safety-guidelines","title":"Safety Guidelines","text":""},{"location":"guide/best-practices/#1-never-drop-without-backup","title":"1. Never Drop Without Backup","text":"<pre><code># Before dropping anything important\npg_dump mydb &gt; backup_$(date +%Y%m%d).sql\n\n# Then proceed\ndbl sandbox start\nDROP TABLE old_table;\ndbl commit -m \"contract: Remove deprecated old_table\"\n</code></pre>"},{"location":"guide/best-practices/#2-test-migrations","title":"2. Test Migrations","text":"<pre><code># Test reset (rebuilds from layers)\ndbl reset\n\n# Verify app still works\n./run-tests.sh\n</code></pre>"},{"location":"guide/best-practices/#3-validate-before-apply","title":"3. Validate Before Apply","text":"<pre><code>dbl sandbox start\n# Make changes...\ndbl diff\ndbl validate        # Check for issues\ndbl commit -m \"msg\"\ndbl sandbox apply\n</code></pre>"},{"location":"guide/best-practices/#4-use-transactions","title":"4. Use Transactions","text":"<p>In manual SQL:</p> <pre><code>BEGIN;\n\n-- Your changes\nALTER TABLE users ADD COLUMN new_col TEXT;\nUPDATE users SET new_col = 'default';\n\n-- Verify\nSELECT COUNT(*) FROM users WHERE new_col IS NULL;\n\n-- If good:\nCOMMIT;\n-- If bad:\nROLLBACK;\n</code></pre>"},{"location":"guide/best-practices/#naming-conventions","title":"Naming Conventions","text":""},{"location":"guide/best-practices/#tables","title":"Tables","text":"<pre><code>-- Plural nouns\nCREATE TABLE users (...);\nCREATE TABLE posts (...);\nCREATE TABLE comments (...);\n\n-- Join tables: singular_singular\nCREATE TABLE post_tag (...);\nCREATE TABLE user_role (...);\n</code></pre>"},{"location":"guide/best-practices/#columns","title":"Columns","text":"<pre><code>-- Clear, descriptive names\nid              -- Primary key\nuser_id         -- Foreign key\ncreated_at      -- Timestamp\nis_active       -- Boolean\nemail_verified  -- Boolean\n</code></pre>"},{"location":"guide/best-practices/#indexes","title":"Indexes","text":"<pre><code>-- Format: idx_table_column(s)\nCREATE INDEX idx_users_email ON users(email);\nCREATE INDEX idx_posts_author_status ON posts(author_id, status);\n\n-- Unique indexes: uq_table_column(s)\nCREATE UNIQUE INDEX uq_users_username ON users(username);\n</code></pre>"},{"location":"guide/best-practices/#constraints","title":"Constraints","text":"<pre><code>-- Format: fk_table_column_ref\nALTER TABLE posts \n  ADD CONSTRAINT fk_posts_author_users \n  FOREIGN KEY (author_id) REFERENCES users(id);\n\n-- Format: chk_table_condition\nALTER TABLE users \n  ADD CONSTRAINT chk_users_valid_email \n  CHECK (email LIKE '%@%');\n</code></pre>"},{"location":"guide/best-practices/#configuration-management","title":"Configuration Management","text":""},{"location":"guide/best-practices/#development","title":"Development","text":"<pre><code># dbl.dev.yaml\nengine: postgres\nhost: localhost\ndatabase: myapp_dev\n\nignore_tables:\n  - sessions\n\nvalidate:\n  strict: false\n</code></pre>"},{"location":"guide/best-practices/#staging","title":"Staging","text":"<pre><code># dbl.staging.yaml\nengine: postgres\nhost: staging.db.internal\ndatabase: myapp_staging\n\nvalidate:\n  strict: true\n  detect_type_changes: true\n</code></pre>"},{"location":"guide/best-practices/#production","title":"Production","text":"<pre><code># dbl.prod.yaml\nengine: postgres\nhost: ${PROD_DB_HOST}\ndatabase: myapp_prod\n\npolicies:\n  require_sandbox: true\n  allow_data_loss: false\n\nvalidate:\n  strict: true\n  require_comments: true\n</code></pre>"},{"location":"guide/best-practices/#cicd-integration","title":"CI/CD Integration","text":""},{"location":"guide/best-practices/#pre-commit-hook","title":"Pre-commit Hook","text":"<pre><code># .git/hooks/pre-commit\n#!/bin/bash\n\n# Check for uncommitted DB changes\nif dbl sandbox status | grep -q \"active\"; then\n    echo \"\u274c Active sandbox found!\"\n    echo \"Run 'dbl sandbox apply' or 'dbl sandbox rollback'\"\n    exit 1\nfi\n</code></pre>"},{"location":"guide/best-practices/#ci-pipeline","title":"CI Pipeline","text":"<pre><code># .github/workflows/db-check.yml\nname: Database Check\n\non: [pull_request]\n\njobs:\n  check-schema:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v2\n\n      - name: Setup Database\n        run: docker run -d -p 5432:5432 postgres:15\n\n      - name: Check Migrations\n        run: |\n          dbl init\n          dbl reset\n          # Run app tests\n          pytest tests/\n</code></pre>"},{"location":"guide/best-practices/#common-anti-patterns","title":"Common Anti-Patterns","text":""},{"location":"guide/best-practices/#skipping-sandboxes","title":"\u274c Skipping Sandboxes","text":"<pre><code># BAD: Directly modifying production\npsql -d prod -c \"ALTER TABLE users ADD COLUMN email TEXT\"\n</code></pre>"},{"location":"guide/best-practices/#mixing-schema-and-data","title":"\u274c Mixing Schema and Data","text":"<pre><code># BAD: One commit with both\nCREATE TABLE posts (...);\nINSERT INTO posts VALUES (...);\n</code></pre>"},{"location":"guide/best-practices/#not-testing-reset","title":"\u274c Not Testing Reset","text":"<pre><code># BAD: Never testing if layers replay correctly\n</code></pre>"},{"location":"guide/best-practices/#vague-commit-messages","title":"\u274c Vague Commit Messages","text":"<pre><code># BAD\ndbl commit -m \"update\"\ndbl commit -m \"changes\"\n</code></pre>"},{"location":"guide/best-practices/#ignoring-validation-warnings","title":"\u274c Ignoring Validation Warnings","text":"<pre><code># BAD: Ignoring warnings\ndbl validate\n# \u26a0\ufe0f  Warnings found\ndbl sandbox apply anyway\n</code></pre>"},{"location":"guide/best-practices/#checklist","title":"Checklist","text":"<p>Before each commit:</p> <ul> <li> Working in active sandbox</li> <li> Ran <code>dbl diff</code> and reviewed output</li> <li> Checked <code>dbl validate</code> for warnings</li> <li> Descriptive commit message</li> <li> Tested changes work with app</li> <li> Foreign keys have indexes</li> <li> Using appropriate migration phase</li> </ul>"},{"location":"guide/best-practices/#learn-more","title":"Learn More","text":"<ul> <li>Migration Patterns</li> <li>Configuration Guide</li> <li>Troubleshooting</li> <li>Commands Reference</li> </ul>"},{"location":"guide/configuration/","title":"Configuration Guide","text":"<p>Complete reference for <code>dbl.yaml</code> configuration.</p>"},{"location":"guide/configuration/#configuration-file-location","title":"Configuration File Location","text":"<p>DBL expects <code>dbl.yaml</code> in your project root:</p> <pre><code>your-project/\n\u251c\u2500\u2500 dbl.yaml          \u2190 Configuration file\n\u251c\u2500\u2500 .dbl/             \u2190 DBL workspace\n\u2514\u2500\u2500 your-app-code/\n</code></pre>"},{"location":"guide/configuration/#basic-configuration","title":"Basic Configuration","text":"<p>Minimal configuration:</p> <pre><code>engine: postgres\n\nhost: localhost\nport: 5432\nuser: myuser\npassword: mypassword\ndatabase: mydb\n</code></pre>"},{"location":"guide/configuration/#complete-reference","title":"Complete Reference","text":""},{"location":"guide/configuration/#database-connection","title":"Database Connection","text":""},{"location":"guide/configuration/#postgresql","title":"PostgreSQL","text":"<pre><code>engine: postgres\n\n# Connection details\nhost: localhost\nport: 5432\nuser: postgres\npassword: secretpassword\ndatabase: myapp_db\n\n# Optional: SSL settings\nsslmode: require              # disable, allow, prefer, require, verify-ca, verify-full\nsslcert: /path/to/client.crt\nsslkey: /path/to/client.key\nsslrootcert: /path/to/ca.crt\n</code></pre>"},{"location":"guide/configuration/#mysql","title":"MySQL","text":"<pre><code>engine: mysql\n\n# Connection details\nhost: localhost\nport: 3306\nuser: root\npassword: secretpassword\ndatabase: myapp_db\n\n# Optional: SSL settings\nssl_ca: /path/to/ca.pem\nssl_cert: /path/to/client-cert.pem\nssl_key: /path/to/client-key.pem\n</code></pre>"},{"location":"guide/configuration/#docker-support","title":"Docker Support","text":"<p>Run database commands inside containers:</p> <pre><code># For Docker containers\ncontainer_name: my_postgres_container\n\n# DBL will use: docker exec my_postgres_container &lt;command&gt;\n</code></pre> <p>Example: <pre><code>engine: postgres\ncontainer_name: myapp_db\n\nhost: localhost  # Not used when container_name is set\nport: 5432       # Not used when container_name is set\nuser: postgres\npassword: password\ndatabase: myapp\n</code></pre></p>"},{"location":"guide/configuration/#table-filtering","title":"Table Filtering","text":"<p>Control which tables DBL tracks:</p> <pre><code># Option 1: Ignore specific tables\nignore_tables:\n  - sessions\n  - cache\n  - _prisma_migrations\n  - django_migrations\n  - knex_migrations\n\n# Option 2: Only track specific tables\ntrack_tables:\n  - users\n  - posts\n  - comments\n\n# Note: Use either ignore_tables OR track_tables, not both\n</code></pre> <p>When to use: - <code>ignore_tables</code>: Track everything except these - <code>track_tables</code>: Only track these specific tables</p>"},{"location":"guide/configuration/#safety-policies","title":"Safety Policies","text":"<p>Prevent accidental data loss:</p> <pre><code>policies:\n  # Require sandbox for all commits\n  require_sandbox: true          # Default: true\n\n  # Prevent DROP operations\n  allow_data_loss: false         # Default: false\n\n  # Require confirmation for destructive ops\n  confirm_destructive: true      # Default: true\n</code></pre> <p>Policy effects:</p> Policy Effect <code>require_sandbox: true</code> Cannot commit without active sandbox <code>allow_data_loss: false</code> Blocks DROP TABLE, DROP DATABASE <code>confirm_destructive: true</code> Prompts before DROP, TRUNCATE"},{"location":"guide/configuration/#validation-rules","title":"Validation Rules","text":"<p>Configure migration validation:</p> <pre><code>validate:\n  # Treat warnings as errors\n  strict: false                   # Default: false\n\n  # Allow backfill without expand\n  allow_orphaned: false           # Default: false\n\n  # Require comments for contract phase\n  require_comments: false         # Default: false\n\n  # Detect type changes\n  detect_type_changes: true       # Default: true\n\n  # Warn about missing indexes on foreign keys\n  check_foreign_key_indexes: true  # Default: true\n</code></pre> <p>Validation examples:</p> <pre><code># Strict mode: warnings fail validation\nvalidate:\n  strict: true\n\n# Development mode: permissive\nvalidate:\n  strict: false\n  allow_orphaned: true\n\n# Production mode: careful\nvalidate:\n  strict: true\n  require_comments: true\n  detect_type_changes: true\n</code></pre>"},{"location":"guide/configuration/#complete-example","title":"Complete Example","text":"<p>Production-ready configuration:</p> <pre><code># Database engine\nengine: postgres\n\n# Connection\nhost: localhost\nport: 5432\nuser: myapp_user\npassword: ${DB_PASSWORD}  # Use environment variable\ndatabase: myapp_production\n\n# Docker support (optional)\n# container_name: myapp_postgres\n\n# Table management\nignore_tables:\n  # System/framework tables\n  - pg_stat_statements\n  - _prisma_migrations\n  - knex_migrations\n  - django_migrations\n\n  # High-churn tables\n  - sessions\n  - cache\n  - audit_logs\n\n# Safety policies\npolicies:\n  require_sandbox: true\n  allow_data_loss: false\n  confirm_destructive: true\n\n# Validation rules\nvalidate:\n  strict: false\n  allow_orphaned: false\n  require_comments: true\n  detect_type_changes: true\n  check_foreign_key_indexes: true\n\n# Migration phases (optional metadata)\nphases:\n  expand:\n    - \"CREATE TABLE\"\n    - \"ADD COLUMN\"\n    - \"CREATE INDEX\"\n  backfill:\n    - \"INSERT\"\n    - \"UPDATE\"\n  contract:\n    - \"DROP TABLE\"\n    - \"DROP COLUMN\"\n    - \"ALTER.*NOT NULL\"\n</code></pre>"},{"location":"guide/configuration/#environment-variables","title":"Environment Variables","text":"<p>Use environment variables for secrets:</p> <pre><code># dbl.yaml\nuser: ${DB_USER}\npassword: ${DB_PASSWORD}\ndatabase: ${DB_NAME}\n</code></pre> <pre><code># .env file\nexport DB_USER=myapp\nexport DB_PASSWORD=secretpassword\nexport DB_NAME=myapp_db\n</code></pre>"},{"location":"guide/configuration/#multiple-environments","title":"Multiple Environments","text":""},{"location":"guide/configuration/#option-1-multiple-config-files","title":"Option 1: Multiple Config Files","text":"<pre><code># Development\ndbl.dev.yaml\n\n# Staging\ndbl.staging.yaml\n\n# Production\ndbl.prod.yaml\n</code></pre> <p>Use with custom flag (if supported): <pre><code>dbl --config dbl.prod.yaml init\n</code></pre></p>"},{"location":"guide/configuration/#option-2-environment-variables","title":"Option 2: Environment Variables","text":"<pre><code># dbl.yaml\nengine: postgres\nhost: ${DB_HOST:-localhost}\nport: ${DB_PORT:-5432}\nuser: ${DB_USER}\npassword: ${DB_PASSWORD}\ndatabase: ${DB_NAME}\n</code></pre> <pre><code># Development\nexport DB_HOST=localhost\nexport DB_USER=dev_user\nexport DB_PASSWORD=dev_pass\nexport DB_NAME=myapp_dev\n\n# Production\nexport DB_HOST=prod.example.com\nexport DB_USER=prod_user\nexport DB_PASSWORD=prod_pass\nexport DB_NAME=myapp_prod\n</code></pre>"},{"location":"guide/configuration/#docker-compose-integration","title":"Docker Compose Integration","text":"<pre><code># docker-compose.yml\nservices:\n  db:\n    image: postgres:15\n    container_name: myapp_db\n    environment:\n      POSTGRES_USER: myapp\n      POSTGRES_PASSWORD: password\n      POSTGRES_DB: myapp\n    ports:\n      - \"5432:5432\"\n</code></pre> <pre><code># dbl.yaml\nengine: postgres\ncontainer_name: myapp_db\nuser: myapp\npassword: password\ndatabase: myapp\n</code></pre> <p>Usage: <pre><code>docker-compose up -d\ndbl init\ndbl sandbox start  # Runs inside container\n</code></pre></p>"},{"location":"guide/configuration/#configuration-validation","title":"Configuration Validation","text":"<p>Check your configuration:</p> <pre><code># Test database connection\npsql -h localhost -U myuser -d mydb -c \"SELECT version();\"\n\n# MySQL\nmysql -h localhost -u myuser -p mydb -e \"SELECT version();\"\n\n# Test DBL config\ndbl init\ndbl sandbox start\n</code></pre>"},{"location":"guide/configuration/#security-best-practices","title":"Security Best Practices","text":""},{"location":"guide/configuration/#1-never-commit-secrets","title":"1. Never Commit Secrets","text":"<pre><code># .gitignore\ndbl.yaml\n.env\n*.local.yaml\n</code></pre>"},{"location":"guide/configuration/#2-use-environment-variables","title":"2. Use Environment Variables","text":"<pre><code>password: ${DB_PASSWORD}\n</code></pre>"},{"location":"guide/configuration/#3-use-separate-credentials","title":"3. Use Separate Credentials","text":"<pre><code># Development\nuser: dev_user\n\n# Production\nuser: prod_readonly  # Limited permissions\n</code></pre>"},{"location":"guide/configuration/#4-restrict-permissions","title":"4. Restrict Permissions","text":"<pre><code>-- Create limited user\nCREATE USER dbl_user WITH PASSWORD 'password';\n\n-- Grant only necessary permissions\nGRANT CONNECT ON DATABASE myapp TO dbl_user;\nGRANT SELECT, INSERT, UPDATE ON ALL TABLES IN SCHEMA public TO dbl_user;\nGRANT USAGE ON ALL SEQUENCES IN SCHEMA public TO dbl_user;\n\n-- For sandboxes, also grant CREATE DATABASE\nALTER USER dbl_user CREATEDB;\n</code></pre>"},{"location":"guide/configuration/#common-configurations","title":"Common Configurations","text":""},{"location":"guide/configuration/#local-development","title":"Local Development","text":"<pre><code>engine: postgres\nhost: localhost\nport: 5432\nuser: postgres\npassword: password\ndatabase: myapp_dev\n\nignore_tables:\n  - sessions\n\npolicies:\n  require_sandbox: true\n\nvalidate:\n  strict: false\n  allow_orphaned: true\n</code></pre>"},{"location":"guide/configuration/#cicd-environment","title":"CI/CD Environment","text":"<pre><code>engine: postgres\nhost: postgres\nport: 5432\nuser: ci_user\npassword: ${CI_DB_PASSWORD}\ndatabase: test_db\n\nignore_tables:\n  - sessions\n  - cache\n\npolicies:\n  require_sandbox: false  # CI can run without sandbox\n\nvalidate:\n  strict: true\n  detect_type_changes: true\n</code></pre>"},{"location":"guide/configuration/#team-development","title":"Team Development","text":"<pre><code>engine: postgres\ncontainer_name: team_db\nuser: team_user\npassword: ${DB_PASSWORD}\ndatabase: team_dev\n\ntrack_tables:\n  - users\n  - posts\n  - comments\n\npolicies:\n  require_sandbox: true\n  allow_data_loss: false\n\nvalidate:\n  strict: false\n  require_comments: true\n</code></pre>"},{"location":"guide/configuration/#troubleshooting","title":"Troubleshooting","text":""},{"location":"guide/configuration/#connection-issues","title":"Connection Issues","text":"<pre><code># Try with explicit settings\nengine: postgres\nhost: 127.0.0.1  # Instead of localhost\nport: 5432\nuser: postgres\npassword: password\ndatabase: postgres  # Connect to postgres first\n</code></pre>"},{"location":"guide/configuration/#docker-issues","title":"Docker Issues","text":"<pre><code># Verify container name\ndocker ps\n\n# Test connection\ndocker exec myapp_db psql -U postgres -c \"SELECT 1\"\n</code></pre>"},{"location":"guide/configuration/#permission-issues","title":"Permission Issues","text":"<pre><code>-- Check user permissions\n\\du  -- PostgreSQL\n\n-- Grant create database\nALTER USER myuser CREATEDB;\n</code></pre>"},{"location":"guide/configuration/#next-steps","title":"Next Steps","text":"<ul> <li>Quick Start Tutorial</li> <li>Best Practices</li> <li>Troubleshooting Guide</li> </ul>"},{"location":"reference/faq/","title":"Frequently Asked Questions","text":"<p>Common questions about DBL and database version control.</p>"},{"location":"reference/faq/#general-questions","title":"General Questions","text":""},{"location":"reference/faq/#what-is-dbl","title":"What is DBL?","text":"<p>DBL (Database Layering) is a Git-like version control system for database schemas. It lets you: - Track schema changes over time - Test changes in isolated sandboxes - Collaborate with teams without conflicts - Replay migrations reliably</p>"},{"location":"reference/faq/#how-is-dbl-different-from-traditional-migrations","title":"How is DBL different from traditional migrations?","text":"Traditional Migrations DBL Manual SQL scripts Automatic diff capture Up/down scripts Layer-based Sequential only Branch support No sandbox Built-in sandboxes Manual rollback Automated replay"},{"location":"reference/faq/#which-databases-does-dbl-support","title":"Which databases does DBL support?","text":"<p>Currently: - \u2705 PostgreSQL (9.6+) - \u2705 MySQL (5.7+)</p> <p>Planned: - \ud83d\udd04 SQLite - \ud83d\udd04 MariaDB - \ud83d\udd04 SQL Server</p>"},{"location":"reference/faq/#is-dbl-production-ready","title":"Is DBL production-ready?","text":"<p>DBL is currently in alpha. It's suitable for: - \u2705 Development environments - \u2705 Testing/staging - \u26a0\ufe0f Production (with caution and backups)</p>"},{"location":"reference/faq/#installation-setup","title":"Installation &amp; Setup","text":""},{"location":"reference/faq/#how-do-i-install-dbl","title":"How do I install DBL?","text":"<pre><code>pip install git+https://github.com/alann-estrada-KSH/dbl-sandbox.git\n</code></pre> <p>See Installation Guide for details.</p>"},{"location":"reference/faq/#do-i-need-to-install-anything-else","title":"Do I need to install anything else?","text":"<p>Yes, you need: 1. Python 3.7+ 2. Database (PostgreSQL or MySQL) 3. PyYAML (auto-installed by <code>dbl update</code>)</p>"},{"location":"reference/faq/#how-do-i-upgrade-dbl","title":"How do I upgrade DBL?","text":"<pre><code>dbl update\n</code></pre> <p>Or manually: <pre><code>pip install --upgrade git+https://github.com/alann-estrada-KSH/dbl-sandbox.git\n</code></pre></p>"},{"location":"reference/faq/#can-i-use-dbl-with-docker","title":"Can I use DBL with Docker?","text":"<p>Yes! Example:</p> <pre><code># docker-compose.yml\nservices:\n  db:\n    image: postgres:14\n    environment:\n      POSTGRES_DB: myapp\n      POSTGRES_USER: dbuser\n      POSTGRES_PASSWORD: dbpass\n\n  app:\n    build: .\n    depends_on:\n      - db\n    command: dbl sandbox start\n</code></pre>"},{"location":"reference/faq/#working-with-dbl","title":"Working with DBL","text":""},{"location":"reference/faq/#how-do-i-start-using-dbl-on-an-existing-database","title":"How do I start using DBL on an existing database?","text":"<pre><code># Initialize DBL\ndbl init\n\n# Capture current schema as first layer\ndbl sandbox start\n# DBL will diff against empty \u2192 captures all\ndbl commit -m \"Initial schema import\"\ndbl sandbox apply\n</code></pre>"},{"location":"reference/faq/#can-i-use-dbl-with-an-existing-migration-tool","title":"Can I use DBL with an existing migration tool?","text":"<p>Yes, but you should choose one: - Option 1: Migrate to DBL completely - Option 2: Use DBL for new changes only - Option 3: Use both (not recommended - can cause conflicts)</p>"},{"location":"reference/faq/#how-do-i-share-changes-with-my-team","title":"How do I share changes with my team?","text":"<pre><code># Commit changes\ndbl commit -m \"Add user preferences\"\n\n# Push layers to Git\ngit add .dbl/\ngit commit -m \"Database: Add user preferences\"\ngit push\n\n# Team pulls and applies\ngit pull\ndbl sandbox start\ndbl reset  # Rebuild with new layers\n</code></pre>"},{"location":"reference/faq/#can-multiple-developers-work-simultaneously","title":"Can multiple developers work simultaneously?","text":"<p>Yes! Use branches:</p> <pre><code># Developer 1\ndbl branch feature-auth\ndbl checkout feature-auth\n\n# Developer 2\ndbl branch feature-payments\ndbl checkout feature-payments\n\n# Both work independently\n</code></pre>"},{"location":"reference/faq/#sandboxes","title":"Sandboxes","text":""},{"location":"reference/faq/#what-is-a-sandbox","title":"What is a sandbox?","text":"<p>A sandbox is a temporary copy of your database where you can experiment safely. Changes don't affect the main database until you apply them.</p>"},{"location":"reference/faq/#can-i-have-multiple-sandboxes","title":"Can I have multiple sandboxes?","text":"<p>Not yet. Currently, one sandbox per database at a time. Planned for future releases.</p>"},{"location":"reference/faq/#what-happens-if-i-delete-a-sandbox-manually","title":"What happens if I delete a sandbox manually?","text":"<pre><code># If you manually dropped the database\ndropdb myapp_sandbox\n\n# Clean up DBL metadata\ndbl sandbox rollback\n</code></pre>"},{"location":"reference/faq/#can-i-access-the-sandbox-from-other-tools","title":"Can I access the sandbox from other tools?","text":"<p>Yes! The sandbox is a regular database:</p> <pre><code># Connect with psql\npsql -d myapp_sandbox\n\n# Or any database tool\n# Host: localhost\n# Database: myapp_sandbox\n</code></pre>"},{"location":"reference/faq/#layers","title":"Layers","text":""},{"location":"reference/faq/#what-are-layers","title":"What are layers?","text":"<p>Layers are committed database changes (like Git commits). Each layer is a SQL file containing the changes made.</p>"},{"location":"reference/faq/#can-i-edit-layers-after-committing","title":"Can I edit layers after committing?","text":"<p>Yes, but be careful:</p> <pre><code># Edit layer file\nnano .dbl/layers/L005_add_users.sql\n\n# Verify it's valid\ndbl validate --layers\n\n# Reset to apply changes\ndbl reset\n</code></pre> <p>Warning</p> <p>Editing historical layers can break team members' databases.</p>"},{"location":"reference/faq/#how-do-i-undo-a-layer","title":"How do I undo a layer?","text":"<pre><code># Option 1: Reset to before that layer\ndbl reset --to L004  # If you want to undo L005\n\n# Option 2: Create a new layer that reverts changes\ndbl sandbox start\npsql -d myapp_sandbox -c \"DROP TABLE users;\"\ndbl commit -m \"Revert: Remove users table\"\ndbl sandbox apply\n</code></pre>"},{"location":"reference/faq/#can-layers-be-mergedsquashed","title":"Can layers be merged/squashed?","text":"<p>Not automatically yet. Manual process:</p> <pre><code># Combine L003, L004, L005 into one\ncat .dbl/layers/L003_*.sql \\\n    .dbl/layers/L004_*.sql \\\n    .dbl/layers/L005_*.sql \\\n    &gt; combined.sql\n\n# Delete originals\nrm .dbl/layers/L003_*.sql \\\n   .dbl/layers/L004_*.sql \\\n   .dbl/layers/L005_*.sql\n\n# Create new combined layer\nmv combined.sql .dbl/layers/L003_combined.sql\n\n# Renumber remaining\ndbl validate --fix\n</code></pre>"},{"location":"reference/faq/#branching","title":"Branching","text":""},{"location":"reference/faq/#how-do-branches-work","title":"How do branches work?","text":"<p>Like Git branches:</p> <pre><code># Create branch\ndbl branch feature-xyz\n\n# Switch branches\ndbl checkout feature-xyz\n\n# Work independently from main\n</code></pre>"},{"location":"reference/faq/#can-i-merge-branches","title":"Can I merge branches?","text":"<p>Manual merge currently:</p> <pre><code># Copy layers from feature branch\ncp .dbl/layers/L008_* ../temp/\n\n# Switch to main\ndbl checkout main\n\n# Move layers\nmv ../temp/L008_* .dbl/layers/L009_*.sql\n\n# Apply\ndbl reset\n</code></pre> <p>Auto-merge is planned for future releases.</p>"},{"location":"reference/faq/#what-happens-when-i-switch-branches","title":"What happens when I switch branches?","text":"<ul> <li>Layer history changes to that branch</li> <li>Database remains unchanged (until you reset)</li> <li>Active sandboxes are preserved</li> </ul>"},{"location":"reference/faq/#errors-troubleshooting","title":"Errors &amp; Troubleshooting","text":""},{"location":"reference/faq/#could-not-connect-to-database","title":"\"Could not connect to database\"","text":"<p>Check: 1. Database is running (<code>pg_isready</code>) 2. Credentials in <code>dbl.yaml</code> are correct 3. Database exists (<code>psql -l</code>) 4. User has permissions</p>"},{"location":"reference/faq/#layer-syntax-error","title":"\"Layer syntax error\"","text":"<pre><code># Find problematic layer\ndbl validate --layers\n\n# Fix SQL\nnano .dbl/layers/L005_*.sql\n\n# Test manually\npsql -d myapp -f .dbl/layers/L005_*.sql\n</code></pre>"},{"location":"reference/faq/#sandbox-already-exists","title":"\"Sandbox already exists\"","text":"<pre><code># Apply existing sandbox\ndbl sandbox apply\n\n# Or discard it\ndbl sandbox rollback\n</code></pre>"},{"location":"reference/faq/#uncommitted-changes-detected","title":"\"Uncommitted changes detected\"","text":"<pre><code># View changes\ndbl diff\n\n# Commit them\ndbl commit -m \"Your changes\"\n\n# Or discard\ndbl sandbox rollback\n</code></pre>"},{"location":"reference/faq/#dbl-commands-are-slow","title":"DBL commands are slow","text":"<p>Possible causes: 1. Large database: Use indexes, optimize queries 2. Remote database: Use local database for development 3. Many layers: Consider squashing old layers 4. Network issues: Check connection</p>"},{"location":"reference/faq/#advanced-usage","title":"Advanced Usage","text":""},{"location":"reference/faq/#can-i-use-dbl-in-cicd","title":"Can I use DBL in CI/CD?","text":"<p>Yes!</p> <pre><code># .github/workflows/test.yml\n- name: Test migrations\n  run: |\n    dbl init\n    dbl reset\n    ./run-tests.sh\n</code></pre>"},{"location":"reference/faq/#can-i-customize-layer-file-naming","title":"Can I customize layer file naming?","text":"<p>Not currently. DBL uses: <pre><code>L{number}_{message_slug}.sql\n</code></pre></p> <p>This ensures consistent ordering.</p>"},{"location":"reference/faq/#can-i-run-custom-sql-beforeafter-layers","title":"Can I run custom SQL before/after layers?","text":"<p>Yes, through hooks (future feature). Currently:</p> <pre><code># Run manually\npsql -d myapp -f pre-layer.sql\ndbl reset\npsql -d myapp -f post-layer.sql\n</code></pre>"},{"location":"reference/faq/#how-do-i-backup-my-database","title":"How do I backup my database?","text":"<p>DBL doesn't handle backups. Use standard tools:</p> <pre><code># PostgreSQL\npg_dump myapp &gt; backup.sql\n\n# MySQL\nmysqldump myapp &gt; backup.sql\n</code></pre>"},{"location":"reference/faq/#can-i-use-dbl-with-microservices","title":"Can I use DBL with microservices?","text":"<p>Yes! Each service can have its own <code>dbl.yaml</code>:</p> <pre><code>services/\n\u251c\u2500\u2500 auth/\n\u2502   \u251c\u2500\u2500 dbl.yaml  (auth database)\n\u2502   \u2514\u2500\u2500 .dbl/\n\u251c\u2500\u2500 payments/\n\u2502   \u251c\u2500\u2500 dbl.yaml  (payments database)\n\u2502   \u2514\u2500\u2500 .dbl/\n\u2514\u2500\u2500 users/\n    \u251c\u2500\u2500 dbl.yaml  (users database)\n    \u2514\u2500\u2500 .dbl/\n</code></pre>"},{"location":"reference/faq/#performance","title":"Performance","text":""},{"location":"reference/faq/#how-many-layers-is-too-many","title":"How many layers is too many?","text":"<p>Guidelines: - &lt; 100 layers: Excellent - 100-500 layers: Good - 500-1000 layers: Consider squashing - &gt; 1000 layers: Definitely squash</p>"},{"location":"reference/faq/#does-dbl-slow-down-my-database","title":"Does DBL slow down my database?","text":"<p>No. DBL only: - Reads schema metadata (fast) - Doesn't add triggers or overhead - Doesn't affect runtime performance</p>"},{"location":"reference/faq/#how-big-can-layer-files-be","title":"How big can layer files be?","text":"<p>Recommendations: - Ideal: &lt; 100 KB per layer - Acceptable: &lt; 1 MB per layer - Large: &gt; 1 MB (consider splitting)</p>"},{"location":"reference/faq/#data-migrations","title":"Data Migrations","text":""},{"location":"reference/faq/#can-dbl-handle-data-migrations","title":"Can DBL handle data migrations?","text":"<p>Yes, but with caution:</p> <pre><code>-- Layer: L005_migrate_user_emails.sql\nBEGIN;\n\n-- Add new column\nALTER TABLE users ADD COLUMN email_verified BOOLEAN DEFAULT false;\n\n-- Migrate data\nUPDATE users SET email_verified = true \nWHERE email IS NOT NULL;\n\nCOMMIT;\n</code></pre> <p>Commit with flag: <pre><code>dbl commit -m \"Migrate email verification\" --with-data\n</code></pre></p>"},{"location":"reference/faq/#should-i-version-control-data","title":"Should I version control data?","text":"<p>Generally no: - \u2705 Reference data (countries, categories) - \u2705 Configuration data - \u274c User data - \u274c Large datasets - \u274c Sensitive data</p>"},{"location":"reference/faq/#how-do-i-handle-large-data-migrations","title":"How do I handle large data migrations?","text":"<pre><code>-- Break into chunks\nUPDATE users SET migrated = true \nWHERE id &gt;= 1 AND id &lt; 10000;\n\nUPDATE users SET migrated = true \nWHERE id &gt;= 10000 AND id &lt; 20000;\n-- etc.\n</code></pre> <p>Or use external scripts: <pre><code># Run before applying layer\npython migrate_data.py\ndbl sandbox apply\n</code></pre></p>"},{"location":"reference/faq/#security","title":"Security","text":""},{"location":"reference/faq/#is-it-safe-to-commit-database-credentials","title":"Is it safe to commit database credentials?","text":"<p>NO! Use environment variables:</p> <pre><code># dbl.yaml\ndatabase:\n  name: myapp\n  user: ${DB_USER}\n  password: ${DB_PASSWORD}\n</code></pre> <pre><code>export DB_USER=myuser\nexport DB_PASSWORD=secret\ndbl sandbox start\n</code></pre>"},{"location":"reference/faq/#what-about-sensitive-data-in-layers","title":"What about sensitive data in layers?","text":"<p>Don't commit sensitive data!</p> <pre><code>-- BAD\nINSERT INTO users (email, password) \nVALUES ('admin@example.com', 'plaintext123');\n\n-- GOOD (reference only)\n-- INSERT admin user with strong password\n-- Password must be set separately via admin panel\n</code></pre>"},{"location":"reference/faq/#can-i-encrypt-layer-files","title":"Can I encrypt layer files?","text":"<p>DBL doesn't provide encryption. Use Git encryption tools: - git-crypt - Blackbox - git-secret</p>"},{"location":"reference/faq/#compatibility","title":"Compatibility","text":""},{"location":"reference/faq/#can-i-use-dbl-with-orm-migrations","title":"Can I use DBL with ORM migrations?","text":"<p>Yes, but: - Use one as source of truth - DBL captures ORM migration results - Or use ORM to generate DBL layers</p>"},{"location":"reference/faq/#does-dbl-work-with-djangorailsetc","title":"Does DBL work with Django/Rails/etc?","text":"<p>Yes! DBL is database-agnostic. Works alongside: - Django migrations - Rails Active Record - Alembic (SQLAlchemy) - Flyway - Liquibase</p>"},{"location":"reference/faq/#can-i-migrate-from-other-tools-to-dbl","title":"Can I migrate from other tools to DBL?","text":"<p>Yes:</p> <pre><code># 1. Apply all existing migrations\npython manage.py migrate  # Django\n# or\nrake db:migrate  # Rails\n\n# 2. Capture current state in DBL\ndbl init\ndbl sandbox start\ndbl commit -m \"Import from Django/Rails\"\ndbl sandbox apply\n\n# 3. Use DBL for future changes\n</code></pre>"},{"location":"reference/faq/#contributing","title":"Contributing","text":""},{"location":"reference/faq/#how-can-i-contribute","title":"How can I contribute?","text":"<ol> <li>Report bugs</li> <li>Suggest features</li> <li>Improve documentation</li> <li>Submit pull requests</li> </ol> <p>See GitHub: https://github.com/alann-estrada-KSH/dbl-sandbox</p>"},{"location":"reference/faq/#where-can-i-get-help","title":"Where can I get help?","text":"<ol> <li>Read the docs: DBL Documentation</li> <li>Check Troubleshooting</li> <li>Open an issue on GitHub</li> <li>Ask in discussions</li> </ol>"},{"location":"reference/faq/#is-dbl-open-source","title":"Is DBL open source?","text":"<p>Yes! Licensed under Apache 2.0.</p>"},{"location":"reference/faq/#roadmap","title":"Roadmap","text":""},{"location":"reference/faq/#what-features-are-coming","title":"What features are coming?","text":"<p>Planned: - \u23f3 Auto-merge branches - \u23f3 Multiple simultaneous sandboxes - \u23f3 Layer squashing - \u23f3 Rollback scripts - \u23f3 Web UI - \u23f3 Cloud hosting</p>"},{"location":"reference/faq/#can-i-request-features","title":"Can I request features?","text":"<p>Yes! Open an issue on GitHub with: - Description of feature - Use case - Example workflow</p>"},{"location":"reference/faq/#see-also","title":"See Also","text":"<ul> <li>Getting Started</li> <li>Troubleshooting</li> <li>Best Practices</li> <li>All Commands</li> </ul>"},{"location":"reference/troubleshooting/","title":"Troubleshooting Guide","text":"<p>Common DBL issues and solutions.</p>"},{"location":"reference/troubleshooting/#connection-issues","title":"Connection Issues","text":""},{"location":"reference/troubleshooting/#cannot-connect-to-database","title":"Cannot Connect to Database","text":"<p>Symptoms: <pre><code>Error: Could not connect to database 'myapp'\nConnection refused\n</code></pre></p> <p>Solutions:</p> <ol> <li> <p>Check database is running: <pre><code># PostgreSQL\npg_isready\nsudo systemctl status postgresql\n\n# MySQL\nmysqladmin ping\nsudo systemctl status mysql\n</code></pre></p> </li> <li> <p>Verify connection details: <pre><code># dbl.yaml\ndatabase:\n  name: myapp\n  host: localhost    # Correct host?\n  port: 5432        # Correct port?\n  user: dbuser      # User exists?\n</code></pre></p> </li> <li> <p>Test connection manually: <pre><code># PostgreSQL\npsql -h localhost -U dbuser -d myapp\n\n# MySQL\nmysql -h localhost -u dbuser -p myapp\n</code></pre></p> </li> <li> <p>Check firewall: <pre><code># PostgreSQL\nsudo ufw allow 5432/tcp\n\n# MySQL\nsudo ufw allow 3306/tcp\n</code></pre></p> </li> </ol>"},{"location":"reference/troubleshooting/#permission-denied","title":"Permission Denied","text":"<p>Symptoms: <pre><code>Error: Permission denied for database 'myapp'\nFATAL: role \"dbuser\" does not exist\n</code></pre></p> <p>Solutions:</p> <ol> <li> <p>Create user: <pre><code>-- PostgreSQL\nCREATE USER dbuser WITH PASSWORD 'password';\nGRANT ALL PRIVILEGES ON DATABASE myapp TO dbuser;\n\n-- MySQL\nCREATE USER 'dbuser'@'localhost' IDENTIFIED BY 'password';\nGRANT ALL PRIVILEGES ON myapp.* TO 'dbuser'@'localhost';\n</code></pre></p> </li> <li> <p>Grant superuser (if needed): <pre><code>-- PostgreSQL\nALTER USER dbuser WITH SUPERUSER;\n</code></pre></p> </li> <li> <p>Check authentication: <pre><code># PostgreSQL: Edit pg_hba.conf\nsudo nano /etc/postgresql/*/main/pg_hba.conf\n# Add:\nlocal   all   dbuser   md5\n\n# Reload\nsudo systemctl reload postgresql\n</code></pre></p> </li> </ol>"},{"location":"reference/troubleshooting/#layer-issues","title":"Layer Issues","text":""},{"location":"reference/troubleshooting/#layer-syntax-error","title":"Layer Syntax Error","text":"<p>Symptoms: <pre><code>Error: SQL syntax error in layer L005\nERROR: syntax error at or near \"TALBE\"\nLINE 1: CREATE TALBE users (\n               ^\n</code></pre></p> <p>Solutions:</p> <ol> <li> <p>Check layer file: <pre><code>cat .dbl/layers/L005_add_users.sql\n</code></pre></p> </li> <li> <p>Test SQL manually: <pre><code>psql -d myapp -f .dbl/layers/L005_add_users.sql\n</code></pre></p> </li> <li> <p>Fix syntax: <pre><code>nano .dbl/layers/L005_add_users.sql\n# Fix: TALBE \u2192 TABLE\n</code></pre></p> </li> <li> <p>Validate: <pre><code>dbl validate --layers\n</code></pre></p> </li> </ol>"},{"location":"reference/troubleshooting/#missing-layer","title":"Missing Layer","text":"<p>Symptoms: <pre><code>Error: Layer L003 not found\nExpected sequence: L001, L002, L003, L004\nFound: L001, L002, L004\n</code></pre></p> <p>Solutions:</p> <ol> <li> <p>Renumber layers: <pre><code>cd .dbl/layers/\nmv L004_add_posts.sql L003_add_posts.sql\nmv L005_add_comments.sql L004_add_comments.sql\n# ... continue renumbering\n</code></pre></p> </li> <li> <p>Or use validate fix: <pre><code>dbl validate --fix\n</code></pre></p> </li> </ol>"},{"location":"reference/troubleshooting/#duplicate-layer-id","title":"Duplicate Layer ID","text":"<p>Symptoms: <pre><code>Error: Duplicate layer ID L008\nFiles: L008_add_auth.sql, L008_add_profiles.sql\n</code></pre></p> <p>Solutions:</p> <pre><code># Renumber one file\nmv .dbl/layers/L008_add_profiles.sql \\\n   .dbl/layers/L009_add_profiles.sql\n</code></pre>"},{"location":"reference/troubleshooting/#sandbox-issues","title":"Sandbox Issues","text":""},{"location":"reference/troubleshooting/#sandbox-already-exists","title":"Sandbox Already Exists","text":"<p>Symptoms: <pre><code>Error: Sandbox 'myapp_sandbox' already exists\n</code></pre></p> <p>Solutions:</p> <ol> <li> <p>Apply existing sandbox: <pre><code>dbl sandbox apply\n</code></pre></p> </li> <li> <p>Or rollback: <pre><code>dbl sandbox rollback\n</code></pre></p> </li> <li> <p>Or force cleanup: <pre><code>dropdb myapp_sandbox\nrm .dbl/sandbox.json\ndbl sandbox start\n</code></pre></p> </li> </ol>"},{"location":"reference/troubleshooting/#sandbox-database-not-found","title":"Sandbox Database Not Found","text":"<p>Symptoms: <pre><code>Error: Sandbox database 'myapp_sandbox' not found\nMetadata indicates sandbox should exist\n</code></pre></p> <p>Solutions:</p> <pre><code># Clean up metadata\nrm .dbl/sandbox.json\nrm .dbl/sandbox/\n\n# Start fresh\ndbl sandbox start\n</code></pre>"},{"location":"reference/troubleshooting/#cannot-apply-sandbox","title":"Cannot Apply Sandbox","text":"<p>Symptoms: <pre><code>Error: Cannot apply sandbox\nUncommitted changes detected\n</code></pre></p> <p>Solutions:</p> <ol> <li> <p>Commit changes first: <pre><code>dbl diff\ndbl commit -m \"Your changes\"\ndbl sandbox apply\n</code></pre></p> </li> <li> <p>Or discard uncommitted: <pre><code>dbl sandbox rollback\ndbl sandbox start\n# Re-apply only what you want\n</code></pre></p> </li> </ol>"},{"location":"reference/troubleshooting/#state-issues","title":"State Issues","text":""},{"location":"reference/troubleshooting/#corrupted-state-file","title":"Corrupted State File","text":"<p>Symptoms: <pre><code>Error: Invalid state file\nJSON parse error in .dbl/state.json\n</code></pre></p> <p>Solutions:</p> <ol> <li> <p>Backup first: <pre><code>cp .dbl/state.json .dbl/state.json.backup\n</code></pre></p> </li> <li> <p>Validate JSON: <pre><code>python -m json.tool .dbl/state.json\n</code></pre></p> </li> <li> <p>Regenerate state: <pre><code>rm .dbl/state.json\ndbl validate --fix\n</code></pre></p> </li> <li> <p>Manual recovery: <pre><code>// .dbl/state.json\n{\n  \"database\": \"myapp\",\n  \"engine\": \"postgres\",\n  \"branch\": \"main\",\n  \"last_layer\": \"L015\",\n  \"active_sandbox\": null\n}\n</code></pre></p> </li> </ol>"},{"location":"reference/troubleshooting/#state-out-of-sync","title":"State Out of Sync","text":"<p>Symptoms: <pre><code>Warning: State file indicates L015 applied\nBut database shows L012\n</code></pre></p> <p>Solutions:</p> <pre><code># Option 1: Trust database, rebuild state\ndbl validate --fix\n\n# Option 2: Trust state, reset database\ndbl reset\n</code></pre>"},{"location":"reference/troubleshooting/#reset-issues","title":"Reset Issues","text":""},{"location":"reference/troubleshooting/#reset-fails-partway","title":"Reset Fails Partway","text":"<p>Symptoms: <pre><code>Replaying layers:\n  \u2192 L001 \u2713\n  \u2192 L002 \u2717 ERROR\n\nDatabase may be in incomplete state\n</code></pre></p> <p>Solutions:</p> <ol> <li> <p>Check error: <pre><code># View layer that failed\ncat .dbl/layers/L002_*.sql\n</code></pre></p> </li> <li> <p>Manual cleanup: <pre><code>dropdb myapp\ncreatedb myapp\n</code></pre></p> </li> <li> <p>Fix layer: <pre><code># Edit problematic layer\nnano .dbl/layers/L002_*.sql\n</code></pre></p> </li> <li> <p>Retry reset: <pre><code>dbl reset\n</code></pre></p> </li> </ol>"},{"location":"reference/troubleshooting/#reset-takes-too-long","title":"Reset Takes Too Long","text":"<p>Symptoms: <pre><code>Reset running for &gt; 10 minutes\n</code></pre></p> <p>Solutions:</p> <ol> <li> <p>Check progress: <pre><code>-- In another terminal\nSELECT * FROM pg_stat_activity \nWHERE datname = 'myapp';\n</code></pre></p> </li> <li> <p>Optimize layers: <pre><code># Combine small layers\n# Add indexes after data loads\n# Use transactions efficiently\n</code></pre></p> </li> <li> <p>Use --hard (careful): <pre><code>dbl reset --hard\n</code></pre></p> </li> </ol>"},{"location":"reference/troubleshooting/#installation-issues","title":"Installation Issues","text":""},{"location":"reference/troubleshooting/#dbl-command-not-found","title":"DBL Command Not Found","text":"<p>Symptoms: <pre><code>bash: dbl: command not found\n</code></pre></p> <p>Solutions:</p> <ol> <li> <p>Check installation: <pre><code>pip list | grep dbl\n</code></pre></p> </li> <li> <p>Reinstall: <pre><code>pip install --user git+https://github.com/alann-estrada-KSH/dbl-sandbox.git\n</code></pre></p> </li> <li> <p>Add to PATH: <pre><code># Add to ~/.bashrc or ~/.zshrc\nexport PATH=\"$HOME/.local/bin:$PATH\"\n\n# Reload\nsource ~/.bashrc\n</code></pre></p> </li> <li> <p>Use python -m: <pre><code>python -m dbl version\n</code></pre></p> </li> </ol>"},{"location":"reference/troubleshooting/#missing-dependencies","title":"Missing Dependencies","text":"<p>Symptoms: <pre><code>Error: No module named 'yaml'\n</code></pre></p> <p>Solutions:</p> <pre><code># Install dependencies\npip install PyYAML\n\n# Or use dbl update\ndbl update\n</code></pre>"},{"location":"reference/troubleshooting/#performance-issues","title":"Performance Issues","text":""},{"location":"reference/troubleshooting/#slow-diff-command","title":"Slow Diff Command","text":"<p>Symptoms: <pre><code>dbl diff takes &gt; 30 seconds\n</code></pre></p> <p>Solutions:</p> <ol> <li> <p>Large database: <pre><code># Diff specific tables\ndbl diff --tables users,posts\n</code></pre></p> </li> <li> <p>Network latency: <pre><code># Use local database for development\ndatabase:\n  host: localhost  # Not remote\n</code></pre></p> </li> <li> <p>Index main database: <pre><code>-- Add indexes to speed up queries\nCREATE INDEX idx_pg_class_relname ON pg_class(relname);\n</code></pre></p> </li> </ol>"},{"location":"reference/troubleshooting/#slow-reset","title":"Slow Reset","text":"<p>Symptoms: <pre><code>dbl reset takes &gt; 5 minutes\n</code></pre></p> <p>Solutions:</p> <ol> <li> <p>Combine layers: <pre><code># Instead of 100 small layers, use 10 larger ones\n</code></pre></p> </li> <li> <p>Optimize SQL: <pre><code>-- Use transactions\nBEGIN;\n-- Multiple operations\nCOMMIT;\n\n-- Defer constraints\nSET CONSTRAINTS ALL DEFERRED;\n</code></pre></p> </li> <li> <p>Parallel execution (future): <pre><code>dbl reset --parallel\n</code></pre></p> </li> </ol>"},{"location":"reference/troubleshooting/#configuration-issues","title":"Configuration Issues","text":""},{"location":"reference/troubleshooting/#invalid-yaml","title":"Invalid YAML","text":"<p>Symptoms: <pre><code>Error: Invalid YAML in dbl.yaml\nmapping values are not allowed here\n</code></pre></p> <p>Solutions:</p> <ol> <li> <p>Validate YAML: <pre><code>python -c \"import yaml; yaml.safe_load(open('dbl.yaml'))\"\n</code></pre></p> </li> <li> <p>Check indentation: <pre><code># Bad\ndatabase:\nname: myapp\n\n# Good\ndatabase:\n  name: myapp\n</code></pre></p> </li> <li> <p>Quote special characters: <pre><code># Bad\npassword: p@ssw0rd!\n\n# Good\npassword: \"p@ssw0rd!\"\n</code></pre></p> </li> </ol>"},{"location":"reference/troubleshooting/#environment-variables-not-working","title":"Environment Variables Not Working","text":"<p>Symptoms: <pre><code>Database connection failed\nUsing literal '${DB_PASSWORD}' instead of value\n</code></pre></p> <p>Solutions:</p> <pre><code># Export variables before running DBL\nexport DB_PASSWORD=\"mypassword\"\ndbl sandbox start\n\n# Or use .env file (if supported)\necho \"DB_PASSWORD=mypassword\" &gt; .env\ndbl sandbox start\n</code></pre>"},{"location":"reference/troubleshooting/#common-error-messages","title":"Common Error Messages","text":""},{"location":"reference/troubleshooting/#no-active-sandbox","title":"\"No active sandbox\"","text":"<pre><code># You need to start a sandbox first\ndbl sandbox start\n</code></pre>"},{"location":"reference/troubleshooting/#uncommitted-changes-detected","title":"\"Uncommitted changes detected\"","text":"<pre><code># Commit or discard changes\ndbl commit -m \"Changes\"\n# Or\ndbl sandbox rollback\n</code></pre>"},{"location":"reference/troubleshooting/#layer-sequence-broken","title":"\"Layer sequence broken\"","text":"<pre><code># Renumber layers\ndbl validate --fix\n</code></pre>"},{"location":"reference/troubleshooting/#database-already-exists","title":"\"Database already exists\"","text":"<pre><code># Drop existing database\ndropdb myapp\n\n# Or use different name\n# Edit dbl.yaml\ndatabase:\n  name: myapp_v2\n</code></pre>"},{"location":"reference/troubleshooting/#getting-help","title":"Getting Help","text":""},{"location":"reference/troubleshooting/#check-version","title":"Check Version","text":"<pre><code>dbl version\n</code></pre>"},{"location":"reference/troubleshooting/#validate-setup","title":"Validate Setup","text":"<pre><code>dbl validate --verbose\n</code></pre>"},{"location":"reference/troubleshooting/#view-logs","title":"View Logs","text":"<pre><code># Enable debug mode\nexport DBL_DEBUG=1\ndbl sandbox start\n\n# Check system logs\njournalctl -u postgresql\n</code></pre>"},{"location":"reference/troubleshooting/#report-bug","title":"Report Bug","text":"<p>Include: 1. DBL version (<code>dbl version</code>) 2. Database engine and version 3. Full error message 4. Steps to reproduce 5. Relevant configuration</p> <pre><code># Generate bug report\ndbl version &gt; bug-report.txt\ndbl validate --verbose &gt;&gt; bug-report.txt\ncat dbl.yaml &gt;&gt; bug-report.txt\n</code></pre>"},{"location":"reference/troubleshooting/#see-also","title":"See Also","text":"<ul> <li>Configuration Guide</li> <li>Best Practices</li> <li>FAQ</li> <li>Commands Reference</li> </ul>"}]}